<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>racingminigameview.lua</title>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
</head>
<body>
    <h1>racingminigameview.lua</h1>
    <a href="index.html">返回主页</a>
    <pre><code class="language-lua">slot0 = class(&quot;RacingMiniGameView&quot;, import(&quot;view.miniGame.MiniGameTemplateView&quot;))
slot0.canSelectStage = false

slot0.getUIName = function(slot0)
	return &quot;RacingMiniGameUI&quot;
end

slot0.getGameController = function(slot0)
	return RacingMiniGameController
end

slot0.getShowSide = function(slot0)
	return false
end

slot0.initPageUI = function(slot0)
	slot1 = slot0._tf
	slot0.rtTitlePage = slot1:Find(&quot;TitlePage&quot;)
	slot1 = slot0.rtTitlePage
	slot1 = slot1:Find(&quot;countdown&quot;)
	slot2 = slot1:Find(&quot;bg&quot;)
	slot2 = slot2:GetComponent(typeof(DftAniEvent))

	slot2:SetEndEvent(function ()
		uv0:openUI()
		uv0.gameController:StartGame()
		pg.BgmMgr.GetInstance():ContinuePlay()
	end)

	slot2 = slot0.rtTitlePage
	slot2 = slot2:Find(&quot;pause&quot;)

	onButton(slot0, slot2:Find(&quot;window/btn_confirm&quot;), function ()
		uv0:openUI()
		uv0.gameController:ResumeGame()
	end, SFX_CONFIRM)

	slot3 = slot0.rtTitlePage
	slot3 = slot3:Find(&quot;exit&quot;)

	onButton(slot0, slot3:Find(&quot;window/btn_cancel&quot;), function ()
		uv0:openUI()
		uv0.gameController:ResumeGame()
	end, SFX_CANCEL)
	onButton(slot0, slot3:Find(&quot;window/btn_confirm&quot;), function ()
		uv0:openUI()
		uv0.gameController:EndGame()
	end, SFX_CONFIRM)

	slot4 = slot0.rtTitlePage
	slot4 = slot4:Find(&quot;result&quot;)

	onButton(slot0, slot4:Find(&quot;window/btn_finish&quot;), function ()
		uv0:closeView()
	end, SFX_CONFIRM)
end

slot0.didEnter = function(slot0)
	slot0:initPageUI()
	slot0:initControllerUI()

	slot0.gameController = slot0:getGameController().New(slot0, slot0._tf)

	slot0.gameController:ResetGame()
	slot0.gameController:ReadyGame(getProxy(MiniGameProxy):GetRank(slot0:GetMGData().id))
	pg.BgmMgr.GetInstance():StopPlay()
	slot0:openUI(&quot;countdown&quot;)
end

slot0.initOpenUISwich = function(slot0)
	uv0.super.initOpenUISwich(slot0)

	slot0.openSwitchDic.main = nil

	slot0.openSwitchDic.result = function()
		pg.CriMgr.GetInstance():PlaySoundEffect_V3(&quot;ui-streamers&quot;)
		setActive(uv0.rtTitlePage:Find(&quot;result&quot;):Find(&quot;window/now/new&quot;), getProxy(MiniGameProxy):GetHighScore(uv0:GetMGData().id) / 100 &lt; uv0.gameController.point)

		if slot2 &lt;= slot1 then
			slot2 = slot1

			getProxy(MiniGameProxy):UpdataHighScore(slot0, math.floor(slot1 * 100))
		end

		setText(slot3:Find(&quot;window/high/Text&quot;), string.format(&quot;%.2fm&quot;, slot2))
		setText(slot3:Find(&quot;window/now/Text&quot;), string.format(&quot;%.2fm&quot;, slot1))
		uv0:emit(BaseMiniGameMediator.GAME_FINISH_TRACKING, {
			game_id = slot0,
			hub_id = uv0:GetMGHubData().id,
			isComplete = uv0.gameController.result
		})

		if (not uv0:getShowSide() or uv0.stageIndex == slot4.usedtime + 1) and slot4.count &gt; 0 then
			uv0:SendSuccess(0)
		end
	end

	slot0.openSwitchDic.countdown = function()
		pg.CriMgr.GetInstance():PlaySoundEffect_V3(SFX_STEP_PILE_COUNTDOWN)
	end
end

slot0.willExit = function(slot0)
	slot0.gameController:willExit()
end

return slot0
</code></pre>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-lua.min.js"></script>
</body>
</html>