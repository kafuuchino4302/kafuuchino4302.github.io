<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>enemyconductor.lua</title>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
</head>
<body>
    <h1>enemyconductor.lua</h1>
    <a href="index.html">返回主页</a>
    <pre><code class="language-lua">slot0 = class(&quot;EnemyConductor&quot;, import(&quot;view.miniGame.gameView.RyzaMiniGame.character.MoveEnemy&quot;))
slot0.ConfigShildList = {
	2,
	0,
	0,
	0
}
slot0.BlockRange = 1
slot1 = {
	&quot;S&quot;,
	&quot;E&quot;,
	&quot;N&quot;,
	&quot;W&quot;
}

slot0.InitUI = function(slot0, slot1)
	slot0.shieldCount = underscore.rest(slot0.ConfigShildList, 1)
	slot5 = &quot;front/Shield_W&quot;
	slot0.rtShieldDic = {
		S = slot0.rtScale:Find(&quot;front/Shield_S&quot;),
		E = slot0.rtScale:Find(&quot;front/Shield_E&quot;),
		N = slot0.rtScale:Find(&quot;back/Shield_N&quot;),
		W = slot0.rtScale:Find(slot5)
	}

	for slot5, slot6 in ipairs({
		&quot;front&quot;,
		&quot;back&quot;
	}) do
		slot8 = slot0.rtScale

		eachChild(slot8:Find(slot6), function (slot0)
			slot1 = slot0:Find(&quot;Image&quot;)
			slot1 = slot1:GetComponent(typeof(DftAniEvent))

			slot1:SetEndEvent(function ()
				setActive(uv0:Find(&quot;Image&quot;), false)
				setActive(uv0, false)
				setImageAlpha(uv0, 1)
			end)

			slot1 = slot0:Find(&quot;Protect&quot;)
			slot1 = slot1:GetComponent(typeof(DftAniEvent))

			slot1:SetEndEvent(function ()
				setActive(uv0:Find(&quot;Protect&quot;), false)

				if uv2.shieldCount[(table.indexof(uv1, string.split(uv0.name, &quot;_&quot;)[2]) - table.indexof(uv1, uv2.statusMark) + 4) % 4 + 1] &lt;= 0 then
					setImageAlpha(uv0, 0)
					setActive(uv0:Find(&quot;Image&quot;), true)
				end
			end)
		end)
	end

	uv1.super.InitUI(slot0, slot1)

	slot0.hp = slot1.hp or 2
	slot0.hpMax = slot0.hp
	slot0.speed = slot1.speed or 3
end

slot0.InitRegister = function(slot0, slot1)
	uv0.super.InitRegister(slot0, slot1)
	slot0:Register(&quot;block&quot;, function (slot0)
		uv0.shieldCount[slot0] = uv0.shieldCount[slot0] - 1

		setActive(uv0.rtShieldDic[uv1[(table.indexof(uv1, uv0.statusMark) + slot0 + 2) % 4 + 1]]:Find(&quot;Protect&quot;), true)
	end, {})
end

slot0.CheckBlock = function(slot0, slot1, slot2, slot3)
	if slot0.pos.x == slot1.x and slot0.pos.y == slot1.y then
		return
	elseif slot0.pos.x == slot1.x and math.clamp(slot0.pos.y - slot1.y, -slot2[3], slot2[1]) == slot0.pos.y - slot1.y or slot0.pos.y == slot1.y and math.clamp(slot0.pos.x - slot1.x, -slot2[4], slot2[2]) == slot0.pos.x - slot1.x then
		slot4 = nil

		if slot1.x &lt; slot0.pos.x then
			slot4 = &quot;W&quot;
		elseif slot0.pos.x &lt; slot1.x then
			slot4 = &quot;E&quot;
		elseif slot1.y &lt; slot0.pos.y then
			slot4 = &quot;N&quot;
		elseif slot0.pos.y &lt; slot1.y then
			slot4 = &quot;S&quot;
		else
			assert(false)
		end

		if slot0.shieldCount[(table.indexof(uv0, slot4) - table.indexof(uv0, slot0.statusMark) + 4) % 4 + 1] &gt; 0 then
			slot6 = (table.indexof(uv0, slot4) + 1) % 4 + 1
			slot2[slot6] = math.max(math.max(math.abs(slot0.pos.x - slot1.x), math.abs(slot0.pos.y - slot1.y)) - slot0.BlockRange, 0)
			slot3[slot6] = {
				slot0,
				slot5
			}
		end
	end
end

slot0.PlayAnim = function(slot0, slot1)
	uv0.super.PlayAnim(slot0, slot1)

	if slot0.statusMark ~= string.split(slot0.status, &quot;_&quot;)[2] then
		slot0.statusMark = string.split(slot0.status, &quot;_&quot;)[2]

		slot0:UpdateShieldDisplay()
	end
end

slot0.UpdateShieldDisplay = function(slot0)
	slot1 = table.indexof(uv0, slot0.statusMark)

	for slot5 = 0, 3 do
		slot6 = slot0.rtShieldDic[uv0[(slot1 - 1 + slot5) % 4 + 1]]

		eachChild(slot6, function (slot0)
			setActive(slot0, false)
		end)
		setImageAlpha(slot6, 1)
		setActive(slot6, slot0.shieldCount[slot5 + 1] &gt; 0)
	end
end

return slot0
</code></pre>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-lua.min.js"></script>
</body>
</html>