<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>dreamlandfullpreviewscene.lua</title>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
</head>
<body>
    <h1>dreamlandfullpreviewscene.lua</h1>
    <a href="index.html">返回主页</a>
    <pre><code class="language-lua">slot0 = class(&quot;DreamlandFullPreviewScene&quot;, import(&quot;.FullPreviewSceneTemplate&quot;))
slot0.MINIGAME_ID = 66

slot0.getUIName = function(slot0)
	return &quot;DreamlandFullPreviewUI&quot;
end

slot0.init = function(slot0)
	slot1 = slot0:findTF(&quot;btns&quot;)
	slot0.dreamlandBtn = slot0:findTF(&quot;dreamland&quot;, slot1)
	slot0.skinBtn = slot0:findTF(&quot;skin&quot;, slot1)
	slot0.buildBtn = slot0:findTF(&quot;build&quot;, slot1)
	slot0.battleBtn = slot0:findTF(&quot;battle&quot;, slot1)
	slot0.minigameBtn = slot0:findTF(&quot;minigame&quot;, slot1)

	setText(slot0:findTF(&quot;top/info/Text&quot;), i18n(&quot;dreamland_main_desc&quot;))

	slot0.preActId = getProxy(ActivityProxy):getActivityByType(ActivityConst.ACTIVITY_TYPE_DREAMLAND):getConfig(&quot;config_client&quot;).preActID
	slot3 = underscore.flatten(pg.activity_template[slot0.preActId].config_data)
	slot0.taskId = slot3[#slot3]
end

slot0.didEnter = function(slot0)
	onButton(slot0, slot0:findTF(&quot;top/back&quot;), function ()
		uv0:emit(uv1.ON_BACK)
	end, SFX_CANCEL)
	onButton(slot0, slot0:findTF(&quot;top/home&quot;), function ()
		uv0:emit(uv1.ON_HOME)
	end, SFX_CANCEL)
	onButton(slot0, slot0:findTF(&quot;top/help&quot;), function ()
		pg.MsgboxMgr.GetInstance():ShowMsgBox({
			type = MSGBOX_TYPE_HELP,
			helps = pg.gametip.dreamland_main_tip.tip
		})
	end, SFX_PANEL)
	onButton(slot0, slot0.dreamlandBtn, function ()
		if uv0.isFinishPre then
			uv0:emit(FullPreviewMediatorTemplate.GO_SCENE, SCENE.DREAMLAND)
		else
			uv0:emit(FullPreviewMediatorTemplate.GO_SCENE, SCENE.ACTIVITY, {
				id = uv0.preActId
			})
		end
	end, SFX_PANEL)
	slot0:BindSkinShop(slot0.skinBtn)
	slot0:BindBuildShip(slot0.buildBtn)
	slot0:BindBattle(slot0.battleBtn)
	slot0:BindMiniGame(slot0.minigameBtn, uv0.MINIGAME_ID)
	slot0:UpdateView()
end

slot0.IsFinishPreAct = function(slot0)
	slot2 = getProxy(TaskProxy):getTaskById(slot0.taskId) or slot1:getFinishTaskById(slot0.taskId)

	return slot2 and slot2:getTaskStatus() == 2
end

slot0.UpdateView = function(slot0)
	setActive(slot0:findTF(&quot;tip&quot;, slot0.minigameBtn), uv0.MiniGameTip())
	setActive(slot0:findTF(&quot;dreamland/tip&quot;, slot0.dreamlandBtn), uv0.DreamlandTip())

	slot0.isFinishPre = slot0:IsFinishPreAct()

	setActive(slot0:findTF(&quot;dreamland&quot;, slot0.dreamlandBtn), slot0.isFinishPre)
	setActive(slot0:findTF(&quot;pre_act&quot;, slot0.dreamlandBtn), not slot0.isFinishPre)
	setActive(slot0:findTF(&quot;pre_act/tip&quot;, slot0.dreamlandBtn), uv0.ActivityTip(getProxy(ActivityProxy):getActivityById(slot0.preActId)))
end

slot0.MiniGameTip = function()
	return uv0.IsMiniGameTip(uv0.MINIGAME_ID)
end

slot0.DreamlandTip = function()
	return DreamlandData.New(getProxy(ActivityProxy):getActivityByType(ActivityConst.ACTIVITY_TYPE_DREAMLAND), getProxy(ActivityProxy):getActivityByType(ActivityConst.ACTIVITY_TYPE_HOTSPRING_2)):ExistAnyMapOrExploreAward()
end

slot0.ActivityTip = function(slot0)
	if not slot0 or slot0:isEnd() then
		return false
	end

	slot7 = math.min(slot0:getDayIndex(), #slot2) - slot3

	if (getProxy(TaskProxy):getTaskById(underscore.flatten(slot0:getConfig(&quot;config_data&quot;))[slot0.data3]) or slot1:getFinishTaskById(slot4)):getTaskStatus() == 1 then
		slot7 = slot7 + 1
	end

	return slot7 &gt; 0
end

slot0.IsShowMainTip = function(slot0)
	return uv0.MiniGameTip() or uv0.DreamlandTip()
end

return slot0
</code></pre>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-lua.min.js"></script>
</body>
</html>