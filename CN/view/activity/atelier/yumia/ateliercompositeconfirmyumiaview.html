<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ateliercompositeconfirmyumiaview.lua</title>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
</head>
<body>
    <h1>ateliercompositeconfirmyumiaview.lua</h1>
    <a href="index.html">返回主页</a>
    <pre><code class="language-lua">slot0 = class(&quot;AtelierCompositeConfirmYumiaView&quot;, import(&quot;view.activity.Atelier.base.AtelierCompositeConfirmView&quot;))

slot0.InitCustom = function(slot0)
	setText(slot0:findTF(&quot;Window/titleBg/Name&quot;), i18n(&quot;yumia_atelier_tip14&quot;))
end

slot0.didEnter = function(slot0)
	uv0.super.didEnter(slot0)
	onButton(slot0, slot0:findTF(&quot;Window/titleBg/closeBtn&quot;), function ()
		uv0:HideCompositeConfirmWindow()
	end, SFX_CANCEL)
end

slot0.HideCompositeConfirmWindow = function(slot0)
	if not isActive(slot0._go) then
		return
	end

	GetComponent(slot0._tf, typeof(Animation)):Play(&quot;Anim_AtelierCompositeYumiaUI_ConfirmWindow_Out&quot;)
	pg.UIMgr.GetInstance():LoadingOn(false)

	slot0.closeTimer = FrameTimer.New(function ()
		if not uv0:IsPlaying(&quot;Anim_AtelierCompositeYumiaUI_ConfirmWindow_Out&quot;) then
			uv1:StopCloseTimer()
			pg.UIMgr.GetInstance():LoadingOff()
			uv2.super.HideCompositeConfirmWindow(uv1)
		end
	end, 1, -1)

	slot0.closeTimer:Start()

	return true
end

slot0.StopCloseTimer = function(slot0)
	if slot0.closeTimer then
		slot0.closeTimer:Stop()

		slot0.closeTimer = nil
	end
end

slot0.ShowCompositeConfirmWindow = function(slot0, slot1)
	GetComponent(slot0._tf, typeof(Animation)):Play(&quot;Anim_AtelierCompositeYumiaUI_ConfirmWindow_In&quot;)
	setActive(slot0._go, true)
	pg.UIMgr.GetInstance():BlurPanel(slot0._tf)

	slot3 = 1
	slot4 = {}
	slot5 = {}

	_.each(slot1, function (slot0)
		slot1 = slot0.Instance:GetConfigID()

		table.insert(uv0, {
			key = slot0.Data:GetConfigID(),
			value = slot1
		})

		uv1[slot1] = (uv1[slot1] or 0) + 1
	end)
	onButton(slot0, slot0:findTF(&quot;Window/Confirm&quot;), function ()
		uv0._parentClass:emit(GAME.COMPOSITE_ATELIER_RECIPE, uv1, uv2)
		uv0._parentClass:PlaySoundEffect(uv0._parentClass.soundStr.compositeConfirm)
	end, SFX_PANEL)

	slot7 = slot0.activity:GetFormulas()[slot0.contextData.formulaId]:GetMaxLimit() ~= 1
	slot8 = slot6:GetMaxLimit() &gt; 0 and slot6:GetMaxLimit() - slot6:GetUsedCount() or 10000
	slot9 = slot0.activity:GetItems()

	for slot13, slot14 in pairs(slot5) do
		slot8 = math.min(slot8, math.floor((slot9[slot13] and slot9[slot13].count or 0) / slot14))
	end

	slot11 = {
		1,
		slot7 and slot8 or 1
	}
	slot13 = slot0:findTF(&quot;Window/Icon&quot;)
	slot14 = slot0:findTF(&quot;Window/AtelierCommonYumiaItem&quot;)

	if Drop.New({
		type = slot6:GetProduction()[1],
		id = slot6:GetProduction()[2]
	}).type ~= DROP_TYPE_RYZA_DROP then
		slot0._parentClass:UpdateRyzaDrop(slot13, slot12)
		setActive(slot13, true)
		setActive(slot14, false)
	else
		slot16 = AtelierMaterial.New({
			configId = slot6:GetProduction()[2]
		})
		slot16.count = 1

		slot0._parentClass:UpdateRyzaItem(slot14, slot16)
		setActive(slot13, false)
		setActive(slot14, true)
	end

	slot16 = slot12:getConfig(&quot;name&quot;)

	setActive(slot0:findTF(&quot;Window/Counters&quot;), slot7)

	if slot7 then
		(function ()
			setText(uv0:findTF(&quot;Number&quot;, uv1), uv2)
			setText(uv0:findTF(&quot;Window/Text&quot;), i18n(&quot;yumia_atelier_tip20&quot;, uv3, uv2))
			setText(uv0:findTF(&quot;cntText&quot;, uv4), uv2)
		end)()
		onButton(slot0, slot0:findTF(&quot;Plus&quot;, slot15), function ()
			uv0 = uv0 + 1
			uv0 = math.clamp(uv0, uv1[1], uv1[2])

			if uv0 == uv0 then
				pg.TipsMgr.GetInstance():ShowTips(i18n(&quot;yumia_atelier_tip21&quot;))

				return
			end

			uv2()
		end)
		onButton(slot0, slot0:findTF(&quot;Minus&quot;, slot15), function ()
			uv0 = uv0 - 1
			uv0 = math.clamp(uv0, uv1[1], uv1[2])

			uv2()
		end)
		onButton(slot0, slot0:findTF(&quot;Plus10&quot;, slot15), function ()
			uv0 = uv0 + 10
			uv0 = math.clamp(uv0, uv1[1], uv1[2])

			if uv0 == uv0 then
				pg.TipsMgr.GetInstance():ShowTips(i18n(&quot;yumia_atelier_tip21&quot;))

				return
			end

			uv2()
		end)
		onButton(slot0, slot0:findTF(&quot;Minus10&quot;, slot15), function ()
			uv0 = uv0 - 10
			uv0 = math.clamp(uv0, uv1[1], uv1[2])

			uv2()
		end)

		return
	end

	setText(slot0:findTF(&quot;Window/Text&quot;), i18n(&quot;yumia_atelier_tip19&quot;, slot16, slot3))
end

return slot0
</code></pre>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-lua.min.js"></script>
</body>
</html>