<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>shiptasklotterypage.lua</title>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
</head>
<body>
    <h1>shiptasklotterypage.lua</h1>
    <a href="index.html">返回主页</a>
    <pre><code class="language-lua">slot0 = class(&quot;ShipTaskLotteryPage&quot;, import(&quot;...base.BaseActivityPage&quot;))

slot0.OnInit = function(slot0)
	slot0.stepText = findTF(slot0._tf, &quot;ad/step&quot;)
	slot0.progressSlider = findTF(slot0._tf, &quot;ad/progressSlider&quot;)
	slot0.iconTf = findTF(slot0._tf, &quot;ad/IconTpl&quot;)
	slot0.btnGet = findTF(slot0._tf, &quot;ad/btnGet&quot;)
	slot0.btnGot = findTF(slot0._tf, &quot;ad/btnGot&quot;)
	slot0.btnGo = findTF(slot0._tf, &quot;ad/btnGo&quot;)
	slot0.taskDesc = findTF(slot0._tf, &quot;ad/taskDesc&quot;)
	slot0.titleDesc = findTF(slot0._tf, &quot;ad/titleDesc&quot;)
	slot0.progressDesc = findTF(slot0._tf, &quot;ad/progressDesc&quot;)

	onButton(slot0, slot0.btnGet, function ()
		if uv0.currentTask then
			uv0:emit(ActivityMediator.ON_TASK_SUBMIT, uv0.currentTask)
		end
	end, SFX_CONFIRM)
	onButton(slot0, slot0.btnGo, function ()
		if uv0.currentTask then
			uv0:emit(ActivityMediator.ON_TASK_GO, uv0.currentTask)
		end
	end, SFX_CONFIRM)
	onButton(slot0, slot0.iconTf, function ()
		uv0:emit(BaseUI.ON_DROP, uv0.drop)
	end, SFX_PANEL)
	setText(slot0.titleDesc, i18n(&quot;ship_task_lottery_title&quot;))
end

slot0.OnFirstFlush = function(slot0)
	slot0.taskIds = slot0.activity:getConfig(&quot;config_data&quot;)

	slot0:updateUI()
end

slot0.OnUpdateFlush = function(slot0)
	slot0:updateUI()
end

slot0.updateUI = function(slot0)
	slot1 = nil

	for slot5 = 1, #slot0.taskIds do
		if not slot1 and getProxy(TaskProxy):getTaskById(slot0.taskIds[slot5]) then
			break
		end
	end

	if not slot1 then
		for slot5 = #slot0.taskIds, 1, -1 do
			if getProxy(TaskProxy):getFinishTaskById(slot0.taskIds[slot5]) then
				break
			end
		end
	end

	if slot1 then
		slot0.currentTask = slot1

		slot0:showTaskUI()
	end
end

slot0.showTaskUI = function(slot0)
	slot1 = slot0.currentTask:getConfig(&quot;award_display&quot;)
	slot0.drop = {
		type = slot1[1][1],
		id = slot1[1][2],
		count = slot1[1][3]
	}

	updateDrop(slot0.iconTf, slot0.drop)
	setText(slot0.taskDesc, slot0.currentTask:getConfig(&quot;desc&quot;))
	setText(slot0.progressDesc, slot0.currentTask:getProgress() .. &quot;/&quot; .. slot0.currentTask:getConfig(&quot;target_num&quot;))
	setSlider(slot0.progressSlider, 0, slot0.currentTask:getConfig(&quot;target_num&quot;), slot0.currentTask:getProgress())
	setActive(slot0.btnGet, slot0.currentTask:getTaskStatus() == 1)
	setActive(slot0.btnGo, slot0.currentTask:getTaskStatus() == 0)
	setActive(slot0.btnGot, slot0.currentTask:getTaskStatus() == 2)
end

slot0.OnDestroy = function(slot0)
end

return slot0
</code></pre>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-lua.min.js"></script>
</body>
</html>