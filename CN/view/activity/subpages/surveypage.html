<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>surveypage.lua</title>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
</head>
<body>
    <h1>surveypage.lua</h1>
    <a href="index.html">返回主页</a>
    <pre><code class="language-lua">slot0 = class(&quot;SurveyPage&quot;, import(&quot;...base.BaseActivityPage&quot;))

slot0.SetEnterTag = function(slot0)
	PlayerPrefs.SetInt(&quot;survey_enter_&quot; .. tostring(slot0), 1)
end

slot0.IsEverEnter = function(slot0)
	return PlayerPrefs.HasKey(&quot;survey_enter_&quot; .. tostring(slot0))
end

slot0.ClearEnterTag = function(slot0)
	PlayerPrefs.DeleteKey(&quot;survey_enter_&quot; .. tostring(slot0))
end

slot0.OnInit = function(slot0)
	slot0.bg = slot0:findTF(&quot;BG&quot;)
	slot0.bguo = slot0:findTF(&quot;BGUO&quot;)
	slot0.goBtn = slot0:findTF(&quot;GO&quot;)
	slot0.awardTF = slot0:findTF(&quot;Award&quot;)
	slot0.itemTF = slot0:findTF(&quot;Award/IconTpl&quot;)
	slot0.maskTF = slot0:findTF(&quot;Award/Mask&quot;)
	slot0.actProxy = getProxy(ActivityProxy)
	slot0.isOpen, slot0.surveyID = slot0.actProxy:isSurveyOpen()

	if slot0.isOpen then
		slot0.isDone = slot0.actProxy:isSurveyDone()
	end

	setActive(slot0.bg, true)
	setActive(slot0.bguo, false)
	setActive(slot0.goBtn, true)
end

slot0.OnFirstFlush = function(slot0)
	setActive(slot0.maskTF, slot0.isDone == true)
	setActive(slot0.goBtn, not slot0.isDone)

	slot1 = pg.survey_data_template[slot0.surveyID].bonus[1]

	updateDrop(slot0.itemTF, {
		type = slot1[1],
		id = slot1[2],
		count = slot1[3]
	})
	onButton(slot0, slot0.itemTF, function ()
		uv0:emit(BaseUI.ON_DROP, uv1)
	end, SFX_PANEL)
	onButton(slot0, slot0.goBtn, function ()
		pg.m02:sendNotification(GAME.SURVEY_REQUEST, {
			surveyID = uv0.surveyID,
			surveyUrlStr = getSurveyUrl(uv0.surveyID)
		})

		if IsUnityEditor then
			uv1.ClearEnterTag(uv0.surveyID)
		end
	end, SFX_PANEL)
	uv0.SetEnterTag(slot0.surveyID)
	slot0:emit(ActivityMainScene.FLUSH_TABS)
end

return slot0
</code></pre>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-lua.min.js"></script>
</body>
</html>