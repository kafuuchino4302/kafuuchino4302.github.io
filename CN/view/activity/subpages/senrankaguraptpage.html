<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>senrankaguraptpage.lua</title>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
</head>
<body>
    <h1>senrankaguraptpage.lua</h1>
    <a href="index.html">返回主页</a>
    <pre><code class="language-lua">slot0 = class(&quot;SenrankaguraPtPage&quot;, import(&quot;.TemplatePage.PtTemplatePage&quot;))
slot1 = {
	1,
	9,
	19
}
slot2 = {
	&quot;normal1&quot;,
	&quot;normal2&quot;,
	&quot;normal3&quot;
}
slot3 = {
	&quot;action1&quot;,
	&quot;action2&quot;
}
slot4 = {
	&quot;hudongye_leijiPT_yin&quot;,
	&quot;hudongye_leijiPT_jin&quot;
}
slot5 = &quot;ui/activityuipage/senrankaguraptpage_atlas&quot;
slot6 = &quot;ui-faguang2&quot;
slot7 = 0.2

slot0.OnInit = function(slot0)
	uv0.super.OnInit(slot0)

	slot0.maskNode = slot0:findTF(&quot;mask&quot;, slot0.bg)
	slot0.bgImgTf = slot0:findTF(&quot;bg_img&quot;, slot0.bg)
	slot0.titleImgTf = slot0:findTF(&quot;title_img&quot;, slot0.bg)
	slot0.role = slot0:findTF(&quot;role&quot;, slot0.maskNode)
	slot0.title = slot0:findTF(&quot;title&quot;, slot0.maskNode)
	slot0.spineAnim = GetComponent(slot0.role, &quot;SpineAnimUI&quot;)
end

slot0.OnFirstFlush = function(slot0)
	uv0.super.OnFirstFlush(slot0)

	slot1 = slot0.ptData
	slot2 = slot0:GetBeiBeiStage(slot1:GetLevelProgress())

	slot0:SetBgImage(slot2)

	slot4 = slot0.spineAnim

	slot4:SetAction(uv1[slot2], 0)
	onButton(slot0, slot0.getBtn, function ()
		slot0 = {}
		slot1 = uv0.ptData:GetAward()
		slot3 = getProxy(PlayerProxy):getRawData()
		slot6, slot7 = Task.StaticJudgeOverflow(slot3.gold, slot3.oil, LOCK_UR_SHIP and 0 or getProxy(BagProxy):GetLimitCntById(pg.gameset.urpt_chapter_max.description[1]), true, true, {
			{
				slot1.type,
				slot1.id,
				slot1.count
			}
		})

		if slot6 then
			table.insert(slot0, function (slot0)
				pg.MsgboxMgr.GetInstance():ShowMsgBox({
					type = MSGBOX_TYPE_ITEM_BOX,
					content = i18n(&quot;award_max_warning&quot;),
					items = uv0,
					onYes = slot0
				})
			end)
		end

		table.insert(slot0, function (slot0)
			uv0:PlayAnim(slot0)
		end)
		seriesAsync(slot0, function ()
			slot0, slot1 = uv0.ptData:GetResProgress()

			uv0:emit(ActivityMediator.EVENT_PT_OPERATION, {
				cmd = 1,
				activity_id = uv0.ptData:GetId(),
				arg1 = slot1
			})
		end)
	end, SFX_PANEL)
end

slot0.OnUpdateFlush = function(slot0)
	uv0.super.OnUpdateFlush(slot0)
end

slot0.OnDestroy = function(slot0)
	if slot0.spineAnim then
		slot0.spineAnim:SetActionCallBack(nil)

		slot0.spineAnim = nil
	end
end

slot0.GetBeiBeiStage = function(slot0, slot1)
	slot2 = 0

	for slot6, slot7 in ipairs(uv0) do
		if slot7 &lt;= slot1 then
			slot2 = slot2 + 1
		end
	end

	return slot2
end

slot0.PlayAnim = function(slot0, slot1)
	if slot0.spineAnim then
		slot4 = uv0[slot0:GetBeiBeiStage(slot0.ptData:GetLevelProgress())]

		if slot0.playing then
			return
		end

		if table.indexof(uv1, slot2) and slot5 &gt; 1 then
			slot6 = slot0.spineAnim

			slot6:SetAction(uv2[slot5 - 1], 0)

			slot6 = pg.CriMgr.GetInstance()

			slot6:PlaySoundEffect_V3(uv3)

			slot6 = slot0.spineAnim

			slot6:SetActionCallBack(function (slot0)
				if slot0 == &quot;action&quot; then
					uv0.playing = true
				end

				if slot0 == &quot;finish&quot; then
					uv0.spineAnim:SetActionCallBack(nil)
					uv0.spineAnim:SetAction(uv1, 0)

					uv0.playing = false

					uv0:SetBgImage(uv2, uv3, uv4)
				end
			end)
		else
			slot1()
		end
	end
end

slot0.SetBgImage = function(slot0, slot1, slot2, slot3)
	slot2 = slot2 or 0

	for slot7 = 1, 3 do
		slot10 = slot7 == slot1 and 1 or 0

		LeanTween.alpha(findTF(slot0.bgImgTf, &quot;img&quot; .. slot7), slot10, slot2):setEase(LeanTweenType.easeOutQuad)
		LeanTween.alpha(findTF(slot0.titleImgTf, &quot;img&quot; .. slot7), slot10, slot2):setEase(LeanTweenType.easeOutQuad)

		if slot2 &gt; 0 and slot1 &gt; 1 then
			setActive(slot0:findTF(uv0[slot1 - 1], slot0.bg), true)

			if slot3 then
				LeanTween.delayedCall(1, System.Action(slot3))
			end
		end
	end
end

return slot0
</code></pre>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-lua.min.js"></script>
</body>
</html>