<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>teatimepuzzlepage.lua</title>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
</head>
<body>
    <h1>teatimepuzzlepage.lua</h1>
    <a href="index.html">返回主页</a>
    <pre><code class="language-lua">slot0 = class(&quot;TeaTimePuzzlePage&quot;, import(&quot;...base.BaseActivityPage&quot;))

slot0.OnInit = function(slot0)
	slot0.bg = slot0:findTF(&quot;AD&quot;)
	slot0.total = 15
	slot0.Text = slot0:findTF(&quot;AD/Text&quot;):GetComponent(typeof(Text))
	slot0.container = slot0:findTF(&quot;AD/container&quot;)
	slot0.GOBtn = slot0:findTF(&quot;AD/go&quot;)
	slot0.got = slot0:findTF(&quot;AD/got&quot;)
end

slot0.OnFirstFlush = function(slot0)
	slot2 = {}
	slot3 = ipairs
	slot4 = slot0.activity:getData1List() or {}

	for slot6, slot7 in slot3(slot4) do
		assert(slot7 - 59800 &gt; 0, &quot;puzzlaIndex should more than zero&quot; .. slot7)
		table.insert(slot2, slot8)
	end

	slot3 = {}

	if slot0.activity:left4Day() then
		for slot7 = 1, slot0.total do
			table.insert(slot3, pg.gametip[&quot;activity_puzzle_get&quot; .. slot7].tip)
		end
	end

	onButton(slot0, slot0.GOBtn, function ()
		slot0 = uv0:getTasks()

		if not uv1:getActivityById(ActivityConst.TEATIME_TW) or slot1:isEnd() then
			return
		end

		slot2 = slot1:getConfig(&quot;config_data&quot;)
		slot3 = false

		for slot7, slot8 in pairs(slot0) do
			if _.any(_.flatten(slot2), function (slot0)
				return slot0 == uv0.id
			end) then
				slot3 = true

				break
			end
		end

		if slot3 then
			uv2:emit(ActivityMediator.EVENT_GO_SCENE, SCENE.TASK, {
				page = &quot;activity&quot;
			})
		else
			uv2:emit(ActivityMediator.EVENT_GO_SCENE, SCENE.NAVALACADEMYSCENE)
		end
	end, SFX_PANEL)

	slot6 = getProxy(TaskProxy):getTasks()
	slot8 = getProxy(ActivityProxy):getActivityById(ActivityConst.TEATIME_TW):isEnd()

	setActive(slot0.GOBtn, not slot8)
	setActive(slot0.got, slot8)

	slot0.Text.text = &quot;&lt;color=#A9F548FF&gt;&quot; .. #slot2 .. &quot;&lt;/color&gt;/&quot; .. slot0.total
	slot0.puzzlaView = PuzzlaView.New({
		bg = &quot;bg_1&quot;,
		go = slot0.container,
		list = slot2,
		descs = slot3,
		fetch = slot0.activity.data1 == 1
	}, nil)

	slot0.puzzlaView.onFinish = function()
		if uv0.activity.data1 ~= 1 then
			uv0:emit(ActivityMediator.EVENT_OPERATION, {
				cmd = 1,
				activity_id = uv0.activity.id
			})
		end
	end
end

slot0.OnDestroy = function(slot0)
	clearImageSprite(slot0.bg)

	if slot0.puzzlaView then
		slot0.puzzlaView:dispose()
	end
end

return slot0
</code></pre>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-lua.min.js"></script>
</body>
</html>