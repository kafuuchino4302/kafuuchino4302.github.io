<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>worldcruisechargepage.lua</title>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
</head>
<body>
    <h1>worldcruisechargepage.lua</h1>
    <a href="index.html">返回主页</a>
    <pre><code class="language-lua">slot0 = class(&quot;WorldCruiseChargePage&quot;, import(&quot;view.base.BaseSubView&quot;))

slot0.getUIName = function(slot0)
	return &quot;WorldCruiseChargePage&quot;
end

slot0.OnLoaded = function(slot0)
end

slot0.OnInit = function(slot0)
	slot1 = slot0._tf
	slot0.buyWindow = slot1:Find(&quot;buy_window&quot;)
	slot1 = slot0.buyWindow
	slot0.cancelBtn = slot1:Find(&quot;button_container/button_cancel&quot;)
	slot2 = slot0.cancelBtn

	setText(slot2:Find(&quot;Image&quot;), i18n(&quot;text_cancel&quot;))

	slot1 = slot0.buyWindow
	slot0.confirmBtn = slot1:Find(&quot;button_container/button_ok&quot;)
	slot1 = slot0.confirmBtn
	slot0.priceTF = slot1:Find(&quot;Image&quot;)
	slot2 = slot0.buyWindow

	setText(slot2:Find(&quot;left/got/desc&quot;), i18n(&quot;battlepass_pay_acquire&quot;))

	slot1 = slot0.buyWindow
	slot1 = slot1:Find(&quot;right/items/scrollview/list&quot;)
	slot0.uiItemList = UIItemList.New(slot1, slot1:Find(&quot;tpl&quot;))
	slot2 = slot0.uiItemList

	slot2:make(function (slot0, slot1, slot2)
		slot1 = slot1 + 1

		if slot0 == UIItemList.EventUpdate then
			slot3 = uv0.itemList[slot1]

			updateDrop(slot2, slot3)
			setText(slot2:Find(&quot;name&quot;), shortenString(slot3:getConfig(&quot;name&quot;), 4))
			onButton(uv0, slot2, function ()
				uv0:emit(BaseUI.ON_NEW_STYLE_DROP, {
					drop = uv1
				})
			end, SFX_CONFIRM)
		end
	end)

	slot2 = slot0._tf
	slot0.unlcokWindow = slot2:Find(&quot;unlock_window&quot;)
	slot3 = slot0.unlcokWindow

	setText(slot3:Find(&quot;tip&quot;), i18n(&quot;word_click_to_close&quot;))

	slot2 = slot0.unlcokWindow
	slot0.unlockItem = slot2:Find(&quot;IconTpl&quot;)
	slot4 = slot0._tf

	onButton(slot0, slot4:Find(&quot;bg&quot;), function ()
		uv0:Hide()
	end, SFX_PANEL)
	onButton(slot0, slot0.cancelBtn, function ()
		uv0:Hide()
	end, SFX_PANEL)
	onButton(slot0, slot0.confirmBtn, function ()
		if ChargeConst.isNeedSetBirth() then
			uv0:emit(WorldCruiseMediator.EVENT_OPEN_BIRTHDAY)
		else
			pg.m02:sendNotification(GAME.CHARGE_OPERATION, {
				shopId = uv0.passId
			})
		end
	end, SFX_PANEL)
end

slot0.ShowBuyWindow = function(slot0)
	setActive(slot0.buyWindow, true)
	setActive(slot0.unlcokWindow, false)
	slot0:Show()

	slot1 = uv0.GetPassID()

	if slot0.passId and slot0.passId == slot1 then
		return
	end

	slot0.passId = uv0.GetPassID()
	slot2 = Goods.Create({
		shop_id = slot0.passId
	}, Goods.TYPE_CHARGE)
	slot3 = Drop.Create(slot2:getConfig(&quot;display&quot;)[1])

	LoadImageSpriteAtlasAsync(slot3:getIcon(), &quot;&quot;, slot0.buyWindow:Find(&quot;left/got/award/icon&quot;))
	setText(slot0.buyWindow:Find(&quot;left/got/award/count&quot;), &quot;x&quot; .. slot3.count)
	setText(slot0.buyWindow:Find(&quot;right/tip&quot;), slot2:getConfig(&quot;descrip_extra&quot;))

	slot4 = slot2:getConfig(&quot;money&quot;)

	if PLATFORM_CODE ~= PLATFORM_CHT or not slot2:IsLocalPrice() then
		slot4 = GetMoneySymbol() .. slot4
	end

	setText(slot0.priceTF, slot4)

	slot0.itemList = slot2:GetExtraServiceItem()

	slot0.uiItemList:align(#slot0.itemList)
end

slot0.GetPassID = function()
	if getProxy(ActivityProxy):getAliveActivityByType(ActivityConst.ACTIVITY_TYPE_PT_CRUSING) and not slot1:isEnd() then
		for slot5, slot6 in ipairs(pg.pay_data_display.all) do
			if pg.pay_data_display[slot6].sub_display and type(slot7.sub_display) == &quot;table&quot; and slot7.sub_display[1] == slot1.id then
				return slot6
			end
		end
	end
end

slot0.ShowUnlockWindow = function(slot0, slot1)
	setActive(slot0.buyWindow, false)
	setActive(slot0.unlcokWindow, true)
	slot0:Show()
	updateDrop(slot0.unlockItem, Drop.Create(slot1:getConfig(&quot;display&quot;)[1]))
	onButton(slot0, slot0.unlockItem, function ()
		uv0:emit(BaseUI.ON_NEW_STYLE_DROP, {
			drop = uv1
		})
	end, SFX_CONFIRM)
end

slot0.Show = function(slot0)
	pg.UIMgr.GetInstance():BlurPanel(slot0._tf)
	uv0.super.Show(slot0)
end

slot0.Hide = function(slot0)
	pg.UIMgr.GetInstance():UnblurPanel(slot0._tf)
	uv0.super.Hide(slot0)
end

slot0.OnDestroy = function(slot0)
end

return slot0
</code></pre>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-lua.min.js"></script>
</body>
</html>