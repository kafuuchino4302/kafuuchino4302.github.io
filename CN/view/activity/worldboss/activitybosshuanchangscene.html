<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>activitybosshuanchangscene.lua</title>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
</head>
<body>
    <h1>activitybosshuanchangscene.lua</h1>
    <a href="index.html">返回主页</a>
    <pre><code class="language-lua">slot0 = class(&quot;ActivityBossHuanChangScene&quot;, import(&quot;.ActivityBossSceneTemplate&quot;))

slot0.getUIName = function(slot0)
	return &quot;ActivityBossHuanChangUI&quot;
end

slot0.init = function(slot0)
	slot0.mainTF = slot0:findTF(&quot;adapt&quot;)
	slot0.bg = slot0:findTF(&quot;bg&quot;)
	slot0.bottom = slot0:findTF(&quot;bottom&quot;, slot0.mainTF)
	slot4 = slot0.bottom
	slot0.hpBar = slot0:findTF(&quot;progress&quot;, slot4)
	slot0.barList = {}

	for slot4 = 1, 4 do
		slot0.barList[slot4] = slot0:findTF(slot4, slot0.hpBar)
	end

	slot0.progressDigit = slot0:findTF(&quot;digit&quot;, slot0.bottom)
	slot0.digitbig = slot0.progressDigit:Find(&quot;big&quot;)
	slot0.digitsmall = slot0.progressDigit:Find(&quot;small&quot;)
	slot0.left = slot0:findTF(&quot;left&quot;, slot0.mainTF)
	slot0.right = slot0:findTF(&quot;right&quot;, slot0.mainTF)
	slot0.rankTF = slot0:findTF(&quot;rank&quot;, slot0.right)
	slot4 = &quot;layout&quot;
	slot0.rankList = CustomIndexLayer.Clone2Full(slot0.rankTF:Find(slot4), 3)

	for slot4, slot5 in ipairs(slot0.rankList) do
		setActive(slot5, false)
	end

	slot0.stageList = {}

	for slot4 = 1, 4 do
		slot0.stageList[slot4] = slot0:findTF(slot4, slot0.right)
	end

	slot0.stageSP = slot0:findTF(&quot;6&quot;, slot0.right)

	if not IsNil(slot0.stageSP) then
		setActive(slot0.stageSP, false)
	end

	slot0.awardFlash = slot0:findTF(&quot;ptaward/flash&quot;, slot0.right)
	slot0.awardBtn = slot0:findTF(&quot;ptaward/button&quot;, slot0.right)
	slot0.ptScoreTxt = slot0:findTF(&quot;ptaward/Text&quot;, slot0.right)
	slot0.top = slot0:findTF(&quot;top&quot;, slot0.mainTF)
	slot0.ticketNum = slot0:findTF(&quot;ticket/Text&quot;, slot0.top)
	slot0.helpBtn = slot0:findTF(&quot;help&quot;, slot0.top)

	onButton(slot0, slot0.top:Find(&quot;back_btn&quot;), function ()
		uv0:emit(uv1.ON_BACK)
	end, SOUND_BACK)
	setActive(slot0.top, false)
	setAnchoredPosition(slot0.top, {
		y = 1080
	})
	setActive(slot0.left, false)
	setAnchoredPosition(slot0.left, {
		x = -1920
	})
	setActive(slot0.right, false)
	setAnchoredPosition(slot0.right, {
		x = 1920
	})
	setActive(slot0.bottom, false)
	setAnchoredPosition(slot0.bottom, {
		y = -1080
	})
	slot0:buildCommanderPanel()
end

slot0.UpdateDropItems = function(slot0)
	slot1 = ipairs
	slot2 = slot0.contextData.DisplayItems or {}

	for slot4, slot5 in slot1(slot2) do
		slot6 = slot0:findTF(&quot;milestone/item&quot;, slot0.barList[slot4])

		updateDrop(slot6:GetChild(0), {
			type = slot0.contextData.DisplayItems[5 - slot4][1],
			id = slot0.contextData.DisplayItems[5 - slot4][2],
			count = slot0.contextData.DisplayItems[5 - slot4][3]
		})
		onButton(slot0, slot6, function ()
			uv0:emit(uv1.ON_DROP, uv2)
		end, SFX_PANEL)
	end
end

slot0.UpdatePage = function(slot0)
	slot1 = slot0.contextData.bossHP

	setText(slot0.digitbig, math.floor(slot1 / 100))

	slot6 = slot1 % 100

	setText(slot0.digitsmall, string.format(&quot;%02d&quot;, slot6) .. &quot;%&quot;)

	slot2 = pg.TimeMgr.GetInstance()

	for slot6 = 1, 4 do
		slot7 = slot0.barList[slot6]

		setSlider(slot0:findTF(&quot;Slider&quot;, slot7), 0, 2500, math.min(math.max(slot1 - (slot6 - 1) * 2500, 0), 2500))

		slot8 = slot0.contextData.mileStones[5 - slot6]

		setActive(slot0:findTF(&quot;milestone/item&quot;, slot7), not slot8)
		setActive(slot0:findTF(&quot;milestone/time&quot;, slot7), slot8)

		if slot8 then
			setText(slot0:findTF(&quot;milestone/time/Text&quot;, slot7), slot2:STimeDescC(slot0.contextData.mileStones[5 - slot6], &quot;%m/%d/%H:%M&quot;))
		end
	end

	for slot6 = 1, #slot0.stageList - 1 do
		slot7 = slot0.contextData.normalStageIDs[slot6]
		slot8 = slot0.stageList[slot6]

		for slot12, slot13 in ipairs(slot0.contextData.ticketInitPools) do
			for slot17, slot18 in ipairs(slot13[1]) do
				if slot18 == slot7 then
					slot20 = slot0.contextData.stageTickets[slot7] or 0

					setActive(slot8:Find(&quot;count&quot;), slot20 &gt; 0)
					setText(slot21:Find(&quot;res&quot;), slot20)
					setText(slot21:Find(&quot;max&quot;), slot13[2])
				end
			end
		end
	end

	setText(slot0.ptScoreTxt, slot0.contextData.ptData.count)
	setActive(slot0.awardFlash, slot0.contextData.ptData:CanGetAward())

	if slot0.bonusWindow and slot0.bonusWindow:IsShowing() then
		slot0.bonusWindow.buffer:UpdateView(slot0.contextData.ptData)
	end

	setText(slot0.ticketNum, slot0:GetEXTicket())
end

slot0.UpdateRank = function(slot0, slot1)
	slot1 = slot1 or {}

	for slot5 = 1, #slot0.rankList do
		setActive(slot0.rankList[slot5], slot5 &lt;= #slot1)

		if slot5 &lt;= #slot1 then
			slot7 = slot6:Find(&quot;Text&quot;)

			if #tostring(slot1[slot5].name) &gt;= 11 then
				slot7:GetComponent(typeof(Text)).fontSize = 23
			else
				slot7:GetComponent(typeof(Text)).fontSize = 28
			end

			setText(slot7, slot8)
		end
	end
end

return slot0
</code></pre>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-lua.min.js"></script>
</body>
</html>