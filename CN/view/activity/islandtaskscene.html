<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>islandtaskscene.lua</title>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
</head>
<body>
    <h1>islandtaskscene.lua</h1>
    <a href="index.html">返回主页</a>
    <pre><code class="language-lua">slot0 = class(&quot;IslandTaskScene&quot;, import(&quot;..base.BaseUI&quot;))
slot0.OPEN_SUBMIT = &quot;open submit&quot;
slot0.ryza_task_tag_explore = &quot;ryza_task_tag_explore&quot;
slot0.ryza_task_tag_battle = &quot;ryza_task_tag_battle&quot;
slot0.ryza_task_tag_dalegate = &quot;ryza_task_tag_dalegate&quot;
slot0.ryza_task_tag_develop = &quot;ryza_task_tag_develop&quot;
slot0.ryza_task_tag_adventure = &quot;ryza_task_tag_adventure&quot;
slot0.ryza_task_tag_build = &quot;ryza_task_tag_build&quot;
slot0.ryza_task_tag_create = &quot;ryza_task_tag_create&quot;
slot0.ryza_task_tag_daily = &quot;ryza_task_tag_daily&quot;
slot0.add_tages = {
	slot0.ryza_task_tag_explore,
	slot0.ryza_task_tag_battle,
	slot0.ryza_task_tag_dalegate,
	slot0.ryza_task_tag_develop,
	slot0.ryza_task_tag_adventure,
	slot0.ryza_task_tag_build,
	slot0.ryza_task_tag_create,
	slot0.ryza_task_tag_daily
}
slot0.ryza_task_detail_content = &quot;ryza_task_detail_content&quot;
slot0.ryza_task_detail_award = &quot;ryza_task_detail_award&quot;
slot0.ryza_task_confirm = &quot;ryza_task_confirm&quot;
slot0.ryza_task_cancel = &quot;ryza_task_cancel&quot;
slot0.sub_item_warning = &quot;sub_item_warning&quot;
slot0.island_build_desc = &quot;island_build_desc&quot;
slot0.island_history_desc = &quot;island_history_desc&quot;
slot0.island_build_level = &quot;island_build_level&quot;
slot0.icon_atlas = &quot;ui/islandtaskicon_atlas&quot;
slot0.ui_atlas = &quot;ui/islandtaskui_atlas&quot;
slot0.task_level_num = 5
slot0.task_add_num = 4
slot1 = 1
slot2 = 2
slot3 = 3

slot0.getUIName = function(slot0)
	return &quot;IslandTaskUI&quot;
end

slot0.init = function(slot0)
	slot0.activityId = ActivityConst.ISLAND_TASK_ID
	slot1 = findTF(slot0._tf, &quot;ad&quot;)
	slot0.btnBack = findTF(slot1, &quot;btnBack&quot;)
	slot0.btnBuild = findTF(slot1, &quot;leftBtns/btnBuild&quot;)
	slot0.btnTask = findTF(slot1, &quot;leftBtns/btnTask&quot;)
	slot0.btnHistory = findTF(slot1, &quot;leftBtns/btnHistory&quot;)
	slot0.taskPage = IslandTaskPage.New(findTF(slot1, &quot;pages/taskPage&quot;), slot0.contextData, findTF(slot1, &quot;tpl&quot;), slot0)
	slot0.buildPage = IslandBuildPage.New(findTF(slot1, &quot;pages/buildPage&quot;), slot0)
	slot0.historyPage = IslandHistoryPage.New(findTF(slot1, &quot;pages/historyPage&quot;), slot0)

	slot0.taskPage:setActive(false)
	slot0.buildPage:setActive(false)
	slot0.historyPage:setActive(false)

	slot0.submitPanel = findTF(findTF(slot0._tf, &quot;pop&quot;), &quot;submitPanel&quot;)

	setActive(slot0.submitPanel, false)

	slot0.submitDisplayContent = findTF(slot0.submitPanel, &quot;itemDisplay/viewport/content&quot;)
	slot0.submitConfirm = findTF(slot0.submitPanel, &quot;btnComfirm&quot;)
	slot0.submitCancel = findTF(slot0.submitPanel, &quot;btnCancel&quot;)
	slot0.subimtItem = findTF(slot0.submitPanel, &quot;itemDisplay/viewport/content/item&quot;)
	slot0.submitItemDesc = findTF(slot0.submitPanel, &quot;itemDesc&quot;)
	slot0.btnCancel = findTF(slot0.submitPanel, &quot;btnCancel&quot;)

	setText(findTF(slot0.submitPanel, &quot;btnComfirm/text&quot;), i18n(uv0.ryza_task_confirm))
	setText(findTF(slot0.submitPanel, &quot;btnCancel/text&quot;), i18n(uv0.ryza_task_cancel))
	setText(findTF(slot0.submitPanel, &quot;bg/text&quot;), i18n(uv0.sub_item_warning))
	pg.UIMgr.GetInstance():BlurPanel(slot0._tf)
end

slot0.didEnter = function(slot0)
	onButton(slot0, slot0.btnBack, function ()
		uv0:closeView()
	end, SOUND_BACK)
	onToggle(slot0, slot0.btnBuild, function (slot0)
		uv0:clearTagBtn()
		setActive(findTF(uv0.btnBuild, &quot;bg&quot;), not slot0)
		setActive(findTF(uv0.btnBuild, &quot;bg_selected&quot;), slot0)

		if slot0 then
			uv0:showPage(uv1)
		end
	end, SFX_CONFIRM)
	onToggle(slot0, slot0.btnTask, function (slot0)
		uv0:clearTagBtn()
		setActive(findTF(uv0.btnTask, &quot;bg&quot;), not slot0)
		setActive(findTF(uv0.btnTask, &quot;bg_selected&quot;), slot0)

		if slot0 then
			uv0:showPage(uv1)
		end
	end, SFX_CONFIRM)
	onToggle(slot0, slot0.btnHistory, function (slot0)
		uv0:clearTagBtn()
		setActive(findTF(uv0.btnHistory, &quot;bg&quot;), not slot0)
		setActive(findTF(uv0.btnHistory, &quot;bg_selected&quot;), slot0)

		if slot0 then
			uv0:showPage(uv1)
		end
	end, SFX_CONFIRM)
	onButton(slot0, slot0.submitConfirm, function ()
		uv0:emit(IslandTaskMediator.SUBMIT_TASK, {
			activityId = uv0.activityId,
			id = uv0.selectTask.id
		})
		setActive(uv0.submitPanel, false)
	end, SOUND_BACK)
	onButton(slot0, slot0.submitCancel, function ()
		setActive(uv0.submitPanel, false)
	end, SOUND_BACK)
	slot0:bind(IslandTaskScene.OPEN_SUBMIT, function (slot0, slot1, slot2)
		uv0:openSubmitPanel(slot1)
	end)
	triggerToggle(slot0.btnTask, true)
end

slot0.clearTagBtn = function(slot0)
	setActive(findTF(slot0.btnBuild, &quot;bg&quot;), true)
	setActive(findTF(slot0.btnBuild, &quot;bg_selected&quot;), false)
	setActive(findTF(slot0.btnTask, &quot;bg&quot;), true)
	setActive(findTF(slot0.btnTask, &quot;bg_selected&quot;), false)
	setActive(findTF(slot0.btnHistory, &quot;bg&quot;), true)
	setActive(findTF(slot0.btnHistory, &quot;bg_selected&quot;), false)
end

slot0.showPage = function(slot0, slot1)
	slot0.taskPage:setActive(slot1 == uv0)
	slot0.buildPage:setActive(slot1 == uv1)
	slot0.historyPage:setActive(slot1 == uv2)
end

slot0.openSubmitPanel = function(slot0, slot1)
	setActive(slot0.submitPanel, true)

	slot2 = tonumber(slot1:getConfig(&quot;target_id_2&quot;))

	updateDrop(slot0.subimtItem, {
		type = DROP_TYPE_RYZA_DROP,
		id = tonumber(slot2),
		count = slot1:getConfig(&quot;target_num&quot;)
	})
	setText(slot0.submitItemDesc, pg.activity_ryza_item[slot2].name)
end

slot0.updateTask = function(slot0, slot1)
	slot0.taskPage:updateTask(slot1)
end

slot0.willExit = function(slot0)
	slot0.taskPage:dispose()
	slot0.historyPage:dispose()
	slot0.buildPage:dispose()
	pg.UIMgr.GetInstance():UnblurPanel(slot0._tf)
end

return slot0
</code></pre>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-lua.min.js"></script>
</body>
</html>