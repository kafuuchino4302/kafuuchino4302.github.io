<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>educateextraattrlayer.lua</title>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
</head>
<body>
    <h1>educateextraattrlayer.lua</h1>
    <a href="index.html">返回主页</a>
    <pre><code class="language-lua">slot0 = class(&quot;EducateExtraAttrLayer&quot;, import(&quot;.base.EducateBaseUI&quot;))

slot0.getUIName = function(slot0)
	return &quot;EducateExtraAttrUI&quot;
end

slot0.init = function(slot0)
	slot0:initData()
	slot0:findUI()
	slot0:addListener()
end

slot0.initData = function(slot0)
	slot0.char = getProxy(EducateProxy):GetCharData()
	slot0.attrList = slot0.char:GetAttrIdsByType(EducateChar.ATTR_TYPE_PERSONALITY)
	slot0.selectedIndex = 0
end

slot0.findUI = function(slot0)
	slot0.windowTF = slot0:findTF(&quot;window&quot;)
	slot0.attrUIList = UIItemList.New(slot0:findTF(&quot;content&quot;, slot0.windowTF), slot0:findTF(&quot;content/tpl&quot;, slot0.windowTF))
	slot0.avatarTF = slot0:findTF(&quot;avatar&quot;, slot0.windowTF)
	slot0.curPersonalText = slot0:findTF(&quot;Text&quot;, slot0.avatarTF)
	slot0.sureBtn = slot0:findTF(&quot;sure_btn&quot;, slot0.windowTF)
end

slot0.addListener = function(slot0)
	onButton(slot0, slot0.sureBtn, function ()
		if uv0.selectedIndex == 0 then
			return
		end

		uv0:emit(uv1.EDUCATE_ON_MSG_TIP, {
			content = i18n(&quot;child_extraAttr_sure_tip&quot;),
			onYes = function ()
				uv0:emit(EducateExtraAttrMediator.ON_ATTR_ADD, {
					id = uv0.attrList[uv0.selectedIndex]
				})
				uv0:emit(uv1.ON_CLOSE)
			end
		})
	end, SFX_PANEL)
end

slot0.didEnter = function(slot0)
	pg.UIMgr.GetInstance():OverlayPanel(slot0._tf, {
		groupName = slot0:getGroupNameFromData(),
		weight = slot0:getWeightFromData() + 1
	})
	slot0.attrUIList:make(function (slot0, slot1, slot2)
		if slot0 == UIItemList.EventInit then
			slot3 = pg.child_attr[uv0.attrList[slot1 + 1]]

			LoadImageSpriteAsync(&quot;educateprops/&quot; .. slot3.icon, uv0:findTF(&quot;icon&quot;, slot2), true)
			setText(uv0:findTF(&quot;name&quot;, slot2), slot3.name)
			onButton(uv0, slot2, function ()
				if uv0.selectedIndex == uv1 + 1 then
					return
				end

				uv0.selectedIndex = uv1 + 1

				uv0:updateView()
			end, SFX_PANEL)
		elseif slot0 == UIItemList.EventUpdate then
			setActive(uv0:findTF(&quot;selected&quot;, slot2), uv0.selectedIndex == slot1 + 1)
		end
	end)
	slot0:updateView()
end

slot0.updateView = function(slot0)
	slot0.attrUIList:align(#slot0.attrList)

	slot1 = slot0.char:GetPaintingName()

	setText(slot0.curPersonalText, &quot;当前主导个性：&quot; .. pg.child_attr[slot0.char:GetPersonalityId()].name)
end

slot0.willExit = function(slot0)
	pg.UIMgr.GetInstance():UnOverlayPanel(slot0._tf)
end

return slot0
</code></pre>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-lua.min.js"></script>
</body>
</html>