<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>settingsotherpanel.lua</title>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
</head>
<body>
    <h1>settingsotherpanel.lua</h1>
    <a href="index.html">返回主页</a>
    <pre><code class="language-lua">slot0 = class(&quot;SettingsOtherPanel&quot;, import(&quot;.SettingsBasePanel&quot;))
slot0.GRAPHI_API_SWITCH_OPTION_TYPE = 3

slot0.GetUIName = function(slot0)
	return &quot;SettingsOther&quot;
end

slot0.GetTitle = function(slot0)
	return i18n(&quot;Settings_title_Other&quot;)
end

slot0.GetTitleEn = function(slot0)
	return &quot;  / OTHER SETTINGS&quot;
end

slot0.OnInit = function(slot0, ...)
	slot0.uilist = UIItemList.New(slot0._tf:Find(&quot;options&quot;), slot0._tf:Find(&quot;options/notify_tpl&quot;))

	slot0.uilist:make(function (slot0, slot1, slot2)
		if slot0 == UIItemList.EventUpdate then
			uv0:UpdateItem(slot1 + 1, slot2)
		end
	end)

	slot2 = pg.BrightnessMgr.GetInstance():IsPermissionGranted()

	if PlayerPrefs.GetInt(&quot;AUTOFIGHT_BATTERY_SAVEMODE&quot;, 0) &gt; 0 and not slot2 then
		PlayerPrefs.SetInt(&quot;AUTOFIGHT_BATTERY_SAVEMODE&quot;, 0)
		PlayerPrefs.Save()
	end
end

slot0.OnUpdate = function(slot0)
	slot0.list = slot0:GetList()

	slot0.uilist:align(#slot0.list)
end

slot0.UpdateItem = function(slot0, slot1, slot2)
	slot3 = slot0.list[slot1]

	slot2:Find(&quot;mask/Text&quot;):GetComponent(&quot;ScrollText&quot;):SetText(slot3.title)
	onButton(slot0, slot2:Find(&quot;mask/Text&quot;), function ()
		pg.m02:sendNotification(NewSettingsMediator.SHOW_DESC, uv0)
	end, SFX_PANEL)
	removeOnToggle(slot2:Find(&quot;on&quot;))

	if slot0:GetDefaultValue(slot3) then
		triggerToggle(slot2:Find(&quot;on&quot;), true)
	else
		triggerToggle(slot2:Find(&quot;off&quot;), true)
	end

	onToggle(slot0, slot2:Find(&quot;on&quot;), function (slot0)
		uv0:OnItemSwitch(uv1, slot0)
	end, SFX_UI_TAG, SFX_UI_CANCEL)
	slot0:OnUpdateItem(slot3)
	slot0:OnUpdateItemWithTr(slot3, slot2)
end

slot0.OnItemSwitch = function(slot0, slot1, slot2)
	if slot1.id == 1 then
		pg.PushNotificationMgr.GetInstance():setSwitchShipName(slot2)
	elseif slot1.id == 5 then
		slot0:OnClickEffectItemSwitch(slot1, slot2)
	elseif slot1.id == 9 then
		slot0:OnAutoFightBatterySaveModeItemSwitch(slot1, slot2)
	elseif slot1.id == 10 then
		slot0:OnAutoFightDownFrameItemSwitch(slot1, slot2)
	elseif slot1.type == 0 then
		slot0:OnCommonLocalItemSwitch(slot1, slot2)
	elseif slot1.type == 1 then
		slot0:OnCommonServerItemSwitch(slot1, slot2)
	elseif slot1.type == uv0.GRAPHI_API_SWITCH_OPTION_TYPE then
		slot0:OnGraphApiItemSwitch(slot1, slot2)
	end

	if slot1.id == 19 then
		pg.GameTrackerMgr.GetInstance():Record(GameTrackerBuilder.BuildNewMainUI({
			isLogin = 0,
			isNewMainUI = slot2 and 1 or 0
		}))
	end
end

slot0.OnClickEffectItemSwitch = function(slot0, slot1, slot2)
	if pg.UIMgr.GetInstance().OverlayEffect then
		setActive(slot3, slot2)
	end

	slot0:OnCommonLocalItemSwitch(slot1, slot2)
end

slot0.OnCommonServerItemSwitch = function(slot0, slot1, slot2)
	slot4 = getProxy(PlayerProxy):getRawData():GetCommonFlag(_G[slot1.name])
	slot5 = not slot2

	if slot1.default == 1 then
		slot5 = slot2
	end

	if slot5 then
		pg.m02:sendNotification(GAME.CANCEL_COMMON_FLAG, {
			flagID = slot3
		})
	else
		pg.m02:sendNotification(GAME.COMMON_FLAG, {
			flagID = slot3
		})
	end
end

slot0.OnAutoFightBatterySaveModeItemSwitch = function(slot0, slot1, slot2)
	slot3 = function()
		triggerToggle(uv0.uilist.container:GetChild(uv1.id - 1):Find(&quot;off&quot;), true)
	end

	slot4 = pg.BrightnessMgr.GetInstance()

	seriesAsync({
		function (slot0)
			if not uv0 or uv1:IsPermissionGranted() then
				return slot0()
			end

			pg.MsgboxMgr.GetInstance():ShowMsgBox({
				content = i18n(&quot;words_autoFight_right&quot;),
				onYes = function ()
					uv0:RequestPremission(function (slot0)
						if slot0 then
							uv0()
						else
							uv1()
						end
					end)
				end,
				onNo = uv2
			})
		end,
		function (slot0)
			PlayerPrefs.SetInt(_G[uv0.name], uv1 and 1 or 0)
			PlayerPrefs.Save()

			slot2 = uv2.uilist.container:GetChild(uv0.id)

			triggerToggle(slot2:Find(uv1 and &quot;on&quot; or &quot;off&quot;), true)
			uv3.SetGrayOption(slot2, uv1)
		end
	})
end

slot0.OnAutoFightDownFrameItemSwitch = function(slot0, slot1, slot2)
	if not slot0:GetDefaultValue(slot0.list[9]) and slot2 then
		pg.TipsMgr.GetInstance():ShowTips(i18n(&quot;words_autoFight_tips&quot;))
		triggerToggle(slot0.uilist.container:GetChild(slot1.id - 1):Find(&quot;off&quot;), true)

		return
	end

	PlayerPrefs.SetInt(_G[slot1.name], slot2 and 1 or 0)
	PlayerPrefs.Save()
end

slot0.SetGrayOption = function(slot0, slot1)
	setGray(slot0:Find(&quot;on&quot;), not slot1)
	setGray(slot0:Find(&quot;off&quot;), not slot1)
end

slot0.OnCommonLocalItemSwitch = function(slot0, slot1, slot2)
	PlayerPrefs.SetInt(_G[slot1.name], slot2 and 1 or 0)
	PlayerPrefs.Save()
end

slot0.OnGraphApiItemSwitch = function(slot0, slot1, slot2)
	slot3 = function()
		triggerToggle(uv0.uilist.container:GetChild(#uv0.list - 1):Find(&quot;off&quot;), true)
		GraphApiHelper.SetForceGraphApi(GraphApiHelper.Api.Force_OpenGLES)
	end

	slot4 = function()
		triggerToggle(uv0.uilist.container:GetChild(#uv0.list - 1):Find(&quot;on&quot;), true)
		GraphApiHelper.SetForceGraphApi(GraphApiHelper.Api.Force_Vulkan)
	end

	if slot2 == false and not GraphApiHelper.IsUsingVulkan() or slot2 == true and GraphApiHelper.IsUsingVulkan() then
		return
	end

	if slot2 then
		pg.MsgboxMgr.GetInstance():ShowMsgBox({
			content = i18n(&quot;graphi_api_switch_vulkan&quot;),
			onYes = function ()
				uv0()
				Application.Quit()
			end,
			onNo = slot3
		})
	else
		pg.MsgboxMgr.GetInstance():ShowMsgBox({
			content = i18n(&quot;graphi_api_switch_opengl&quot;),
			onYes = function ()
				uv0()
				Application.Quit()
			end,
			onNo = slot4
		})
	end
end

slot0.OnUpdateItem = function(slot0, slot1)
	if slot1.id == 10 then
		uv0.SetGrayOption(slot0.uilist.container:GetChild(slot1.id - 1), slot0:GetDefaultValue(slot0.list[9]))
	end
end

slot0.OnUpdateItemWithTr = function(slot0, slot1, slot2)
	setActive(findTF(slot2, &quot;mask/tip&quot;), false)

	if slot1.id == 18 then
		onButton(slot0, slot3, function ()
			pg.m02:sendNotification(NewSettingsMediator.SHOW_DESC, uv0)
		end, SFX_PANEL)
		setActive(slot3, true)
	end
end

slot0.GetDefaultValue = function(slot0, slot1)
	if slot1.id == 1 then
		return pg.PushNotificationMgr.GetInstance():isEnableShipName()
	elseif slot1.id == 17 then
		return getProxy(SettingsProxy):IsDisplayResultPainting()
	elseif slot1.type == 0 then
		return PlayerPrefs.GetInt(_G[slot1.name], slot1.default or 0) &gt; 0
	elseif slot1.type == 1 then
		slot2 = getProxy(PlayerProxy):getRawData():GetCommonFlag(_G[slot1.name])

		if slot1.default == 1 then
			return not slot2
		else
			return slot2
		end
	elseif slot1.type == uv0.GRAPHI_API_SWITCH_OPTION_TYPE then
		return GraphApiHelper.IsUsingVulkan()
	end
end

slot0.GetList = function(slot0)
	slot1 = {}
	slot2 = nil

	for slot6, slot7 in ipairs(pg.settings_other_template.all) do
		if LOCK_BATTERY_SAVEMODE then
			if slot7 ~= 9 then
				if slot7 == 10 then
					-- Nothing
				end
			end
		elseif LOCK_L2D_GYRO and slot7 == 15 then
			-- Nothing
		elseif pg.settings_other_template[slot7].type == uv0.GRAPHI_API_SWITCH_OPTION_TYPE then
			if PermissionHelper.IsAndroid() then
				slot2 = pg.settings_other_template[slot7]
			end
		else
			table.insert(slot1, pg.settings_other_template[slot7])
		end
	end

	if slot2 then
		table.insert(slot1, slot2)
	end

	return slot1
end

return slot0
</code></pre>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-lua.min.js"></script>
</body>
</html>