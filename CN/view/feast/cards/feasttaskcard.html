<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>feasttaskcard.lua</title>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
</head>
<body>
    <h1>feasttaskcard.lua</h1>
    <a href="index.html">返回主页</a>
    <pre><code class="language-lua">slot0 = class(&quot;FeastTaskCard&quot;)

slot0.Ctor = function(slot0, slot1, slot2)
	slot0.binder = slot2
	slot0._go = slot1
	slot0._tf = slot1.transform
	slot0.nameTxt = slot0._tf:Find(&quot;name/Text&quot;):GetComponent(typeof(Text))
	slot0.descTxt = slot0._tf:Find(&quot;desc&quot;):GetComponent(typeof(Text))
	slot0.progressTxt = slot0._tf:Find(&quot;Text&quot;):GetComponent(typeof(Text))
	slot0.progress = slot0._tf:Find(&quot;progress/bar&quot;)
	slot0.uilist = UIItemList.New(slot0._tf:Find(&quot;awards&quot;), slot0._tf:Find(&quot;awards/award&quot;))
	slot0.getBtn = slot0._tf:Find(&quot;btns/get&quot;)
	slot0.gotBtn = slot0._tf:Find(&quot;btns/got&quot;)
	slot3 = slot0._tf
	slot0.goBtn = slot3:Find(&quot;btns/go&quot;)
	slot0.sprites = {
		GetSpriteFromAtlas(&quot;ui/feasttask_atlas&quot;, &quot;t_frame_1&quot;),
		GetSpriteFromAtlas(&quot;ui/feasttask_atlas&quot;, &quot;t_frame_2&quot;)
	}
	slot0.barSprites = {
		GetSpriteFromAtlas(&quot;ui/feasttask_atlas&quot;, &quot;t_progress_1&quot;),
		GetSpriteFromAtlas(&quot;ui/feasttask_atlas&quot;, &quot;t_progress_2&quot;)
	}
	slot0.tags = {
		i18n(&quot;feast_task_tag_daily&quot;),
		i18n(&quot;feast_task_tag_activity&quot;)
	}
	slot0.barImg = slot0._tf:Find(&quot;progress/bar&quot;):GetComponent(typeof(Image))
	slot0.bgImg = slot0._tf:GetComponent(typeof(Image))
end

slot0.Flush = function(slot0, slot1)
	slot3 = getProxy(TaskProxy):getTaskById(slot1) or slot2:getFinishTaskById(slot1)
	slot4 = slot3:IsActRoutineType() and 1 or 2
	slot0.nameTxt.text = slot0.tags[slot4] .. slot3:getConfig(&quot;name&quot;)
	slot0.descTxt.text = slot3:getConfig(&quot;desc&quot;)
	slot0.bgImg.sprite = slot0.sprites[slot4]
	slot0.barImg.sprite = slot0.barSprites[slot4]
	slot5 = slot3:getProgress()
	slot6 = slot3:getConfig(&quot;target_num&quot;)
	slot0.progressTxt.text = slot5 .. &quot;/&quot; .. slot6

	setFillAmount(slot0.progress, slot5 / slot6)
	slot0.uilist:make(function (slot0, slot1, slot2)
		if slot0 == UIItemList.EventUpdate then
			slot3 = uv0[slot1 + 1]

			updateDrop(slot2, {
				type = slot3[1],
				id = slot3[2],
				count = slot3[3]
			})
			onButton(uv1.binder, slot2, function ()
				uv0.binder:emit(BaseUI.ON_DROP, uv1)
			end, SFX_PANEL)
		end
	end)
	slot0.uilist:align(#slot3:getConfig(&quot;award_display&quot;))

	slot9 = slot3:isReceive()

	setActive(slot0.getBtn, slot3:isFinish() and not slot9)
	setActive(slot0.gotBtn, slot8 and slot9)
	setActive(slot0.goBtn, not slot8)
	onButton(slot0.binder, slot0.getBtn, function ()
		uv0.binder:emit(FeastMediator.ON_SUBMIT, uv1)
	end, SFX_PANEL)
	onButton(slot0.binder, slot0.goBtn, function ()
		uv0.binder:emit(FeastMediator.ON_GO, uv1)
	end, SFX_PANEL)
end

slot0.Dispose = function(slot0)
	slot0.sprites = nil
	slot0.barSprites = nil
end

return slot0
</code></pre>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-lua.min.js"></script>
</body>
</html>