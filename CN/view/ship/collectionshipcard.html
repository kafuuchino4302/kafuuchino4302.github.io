<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>collectionshipcard.lua</title>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
</head>
<body>
    <h1>collectionshipcard.lua</h1>
    <a href="index.html">返回主页</a>
    <pre><code class="language-lua">slot0 = class(&quot;CollectionShipCard&quot;)
slot0.TypeCard = 1
slot0.TypeTrans = 2
slot1 = pg.ship_data_group

slot0.Ctor = function(slot0, slot1)
	slot0.go = slot1
	slot0.tr = slot1.transform
	slot0.btn = GetOrAddComponent(slot1, &quot;Button&quot;)
	slot0.content = findTF(slot0.tr, &quot;content&quot;).gameObject

	setActive(findTF(slot0.content, &quot;dockyard&quot;), false)
	setActive(findTF(slot0.content, &quot;collection&quot;), true)
	setActive(findTF(slot0.content, &quot;expbuff&quot;), false)

	slot0.shipFrameImg = findTF(slot0.content, &quot;front/frame&quot;)
	slot0.iconShip = findTF(slot0.content, &quot;ship_icon&quot;):GetComponent(typeof(Image))
	slot0.imageBg = findTF(slot0.content, &quot;bg&quot;):GetComponent(typeof(Image))
	slot0.labelName = findTF(slot0.content, &quot;info/name_mask/name&quot;)
	slot0.mask2D = GetOrAddComponent(findTF(slot0.content, &quot;info/name_mask&quot;), typeof(RectMask2D))
	slot0.iconType = findTF(slot0.content, &quot;info/top/type&quot;):GetComponent(typeof(Image))
	slot0.ringTF = findTF(slot0.content, &quot;front/ring&quot;)
	slot0.ringMetaTF = findTF(slot0.content, &quot;front/ring_meta&quot;)
	slot0.maskTF = findTF(slot0.content, &quot;collection/mask&quot;)
	slot0.heart = findTF(slot0.content, &quot;collection/heart&quot;)
	slot0.labelHeart = findTF(slot0.heart, &quot;heart&quot;):GetComponent(typeof(Text))
	slot0.labelHeartIcon = findTF(slot0.heart, &quot;icon&quot;):GetComponent(typeof(Image))
	slot0.labelHeartPlus = findTF(slot0.heart, &quot;heart+&quot;):GetComponent(typeof(Text))
	slot0.imageUnknown = findTF(slot0.tr, &quot;unknown&quot;):GetComponent(typeof(Image))

	ClearTweenItemAlphaAndWhite(slot0.go)
end

slot0.getIsInited = function(slot0)
	return slot0.shipGroup ~= nil
end

slot0.update = function(slot0, slot1, slot2, slot3, slot4, slot5)
	slot6 = ShipGroup.getState(slot5, slot2, slot3)

	if slot0.code ~= slot1 or slot0.shipGroup ~= slot2 or slot0.showTrans ~= slot3 or slot0.propose ~= slot4 or slot0.state ~= slot6 then
		slot0.code = slot1
		slot0.shipGroup = slot2
		slot0.showTrans = slot3
		slot0.propose = slot4
		slot0.state = slot6
		slot0.config = uv0[slot5]

		slot0:flush()
	end

	TweenItemAlphaAndWhite(slot0.go)
end

slot0.flush = function(slot0)
	slot1 = slot0.shipGroup

	setActive(slot0.heart, slot0.state == ShipGroup.STATE_UNLOCK)

	if slot0.state == ShipGroup.STATE_UNLOCK then
		slot0.labelHeart.text = slot1.hearts &gt; 999 and &quot;999&quot; or tostring(slot1.hearts)

		setActive(slot0.labelHeartPlus, slot1.hearts &gt; 999)

		slot0.labelHeart.color = slot1.iheart and Color.New(1, 0.6, 0.6) or Color.New(1, 1, 1)
		slot0.labelHeartIcon.color = slot1.iheart and Color.New(1, 0.6, 0.6) or Color.New(1, 1, 1)
		slot0.labelHeartPlus.color = slot1.iheart and Color.New(1, 0.6, 0.6) or Color.New(1, 1, 1)

		slot0:loadImage(slot0.shipGroup, true)
	elseif slot0.state == ShipGroup.STATE_NOTGET then
		slot0.shipGroup = ShipGroup.New({
			id = slot0.config.group_type
		})
		slot0.shipGroup.trans = true

		if PLATFORM_CODE == PLATFORM_CH and HXSet.isHx() then
			slot0:loadImage(slot0.shipGroup, false)
		else
			slot0:loadImage(slot0.shipGroup, true)
		end
	elseif slot0.state == ShipGroup.STATE_LOCK then
		-- Nothing
	end

	setActive(slot0.content, slot0.state == ShipGroup.STATE_NOTGET or slot0.state == ShipGroup.STATE_UNLOCK)
	setActive(slot0.imageUnknown, slot0.state == ShipGroup.STATE_LOCK)
	setActive(slot0.maskTF, slot0.state == ShipGroup.STATE_NOTGET)

	if slot1 then
		slot2 = slot1:isMetaGroup()

		setActive(slot0.ringTF, slot0.propose and not slot2)
		setActive(slot0.ringMetaTF, slot0.propose and slot2)
	else
		setActive(slot0.ringTF, false)
		setActive(slot0.ringMetaTF, false)
	end

	if not slot0.mask2D.enabled then
		slot0.mask2D.enabled = true
	end

	setActive(slot0.labelName, false)
	setActive(slot0.labelName, true)
end

slot0.loadImage = function(slot0, slot1, slot2)
	slot3 = slot1:rarity2bgPrint(slot0.showTrans)
	slot4 = slot2 and slot1:getPainting(slot0.showTrans) or &quot;unknown&quot;

	GetImageSpriteFromAtlasAsync(&quot;bg/star_level_card_&quot; .. slot3, &quot;&quot;, slot0.imageBg)

	slot0.loadingPaintingName = slot4

	GetSpriteFromAtlasAsync(&quot;shipYardIcon/&quot; .. slot4, &quot;&quot;, function (slot0)
		if not IsNil(uv0.go) and uv0.loadingPaintingName == uv1 then
			uv0.iconShip.sprite = slot0
		end
	end)

	slot0.iconType.sprite = GetSpriteFromAtlas(&quot;shiptype&quot;, shipType2print(slot1:getShipType(slot0.showTrans)))

	setScrollText(slot0.labelName, slot1:getName(slot0.showTrans))
	setShipCardFrame(slot0.shipFrameImg, slot3)
end

slot0.clear = function(slot0)
	slot0.shipGroup = nil
	slot0.showTrans = nil
	slot0.propose = nil
	slot0.code = nil

	ClearTweenItemAlphaAndWhite(slot0.go)
end

return slot0
</code></pre>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-lua.min.js"></script>
</body>
</html>