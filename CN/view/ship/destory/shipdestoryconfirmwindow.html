<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>shipdestoryconfirmwindow.lua</title>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
</head>
<body>
    <h1>shipdestoryconfirmwindow.lua</h1>
    <a href="index.html">返回主页</a>
    <pre><code class="language-lua">slot0 = class(&quot;ShipDestoryConfirmWindow&quot;, import(&quot;...base.BaseSubView&quot;))

slot0.getUIName = function(slot0)
	return &quot;DestoryConfirmWindow&quot;
end

slot0.OnLoaded = function(slot0)
	slot0.closeBtn = slot0:findTF(&quot;window/top/btnBack&quot;)

	setActive(slot0:findTF(&quot;window/top/bg/infomation/title_en&quot;), PLATFORM_CODE ~= PLATFORM_US)
	setText(slot0:findTF(&quot;window/top/bg/infomation/title&quot;), i18n(&quot;title_info&quot;))

	slot0.cancelBtn = slot0:findTF(&quot;window/cancel_btn&quot;)
	slot0.confirmBtn = slot0:findTF(&quot;window/confirm_btn&quot;)

	setText(findTF(slot0.confirmBtn, &quot;pic&quot;), i18n(&quot;destroy_confirm_access&quot;))
	setText(findTF(slot0.cancelBtn, &quot;pic&quot;), i18n(&quot;destroy_confirm_cancel&quot;))

	slot0.title = slot0:findTF(&quot;window/content/Text&quot;)
	slot0.label = slot0:findTF(&quot;window/content/desc/label&quot;)

	setText(slot0.label, i18n(&quot;destory_ship_before_tip&quot;))

	slot0.urLabel = slot0:findTF(&quot;window/content/desc/label1&quot;)
	slot0.urInput = slot0:findTF(&quot;window/content/desc/InputField&quot;)
	slot0.urOverflowLabel = slot0:findTF(&quot;window/content/desc/label2&quot;)

	setText(slot0.urOverflowLabel, i18n(&quot;destory_ur_pt_overflowa&quot;))
	setText(slot0:findTF(&quot;Placeholder&quot;, slot0.urInput), i18n(&quot;box_ship_del_click&quot;))
end

slot0.OnInit = function(slot0)
	onButton(slot0, slot0.cancelBtn, function ()
		uv0:Hide()
	end, SFX_PANEL)
	onButton(slot0, slot0.confirmBtn, function ()
		uv0:Confirm()
	end, SFX_PANEL)

	slot3 = slot0._tf

	onButton(slot0, slot3:Find(&quot;bg&quot;), function ()
		uv0:Hide()
	end, SFX_PANEL)
	onButton(slot0, slot0.closeBtn, function ()
		uv0:Hide()
	end, SFX_PANEL)
end

slot0.SetCallBack = function(slot0, slot1)
	slot0.callback = slot1
end

slot0.Confirm = function(slot0)
	if slot0.key then
		if slot0.key ~= tonumber(getInputText(slot0.urInput)) then
			pg.TipsMgr:GetInstance():ShowTips(i18n(&quot;destory_ship_input_erro&quot;))

			return
		end

		slot0:Hide()
		existCall(slot0.callback)
	else
		slot0:Hide()
		existCall(slot0.callback)
	end
end

slot0.ShowOneShipProtect = function(slot0, slot1, slot2)
	uv0.super.Show(slot0)

	slot3 = pg.UIMgr.GetInstance()

	slot3:BlurPanel(slot0._tf)

	slot0.key = nil
	slot0.ships = slot1

	slot0:SetCallBack(slot2)
	setText(slot0.title, i18n(&quot;unique_ship_tip1&quot;))

	slot0.key = math.random(100000, 999999)

	setText(slot0.urLabel, i18n(&quot;unique_ship_tip2&quot;, slot0.key))
	setActive(slot0.urLabel, true)
	setActive(slot0.urInput, true)
	setActive(slot0.urOverflowLabel, false)
	mergeSort(slot0.ships, CompareFuncs({
		function (slot0)
			return -slot0.level
		end,
		function (slot0)
			return -slot0:getRarity()
		end
	}, true))

	if #slot0.ships &gt; 5 then
		slot4 = slot0._tf

		setActive(slot4:Find(&quot;window/content/ships&quot;), true)

		slot4 = slot0._tf

		setActive(slot4:Find(&quot;window/content/ships_single&quot;), false)

		slot3 = slot0._tf
		slot3 = slot3:Find(&quot;window/content/ships/content&quot;)

		slot3:GetComponent(&quot;LScrollRect&quot;).onUpdateItem = function (slot0, slot1)
			updateShip(tf(slot1), uv0.ships[slot0 + 1])
		end

		onNextTick(function ()
			uv0:SetTotalCount(#uv1.ships)
		end)

		return
	end

	setActive(slot0._tf:Find(&quot;window/content/ships&quot;), false)
	setActive(slot0._tf:Find(&quot;window/content/ships_single&quot;), true)

	slot3 = slot0._tf:Find(&quot;window/content/ships_single&quot;)
	slot4 = UIItemList.New(slot3, slot3:Find(&quot;IconTpl&quot;))

	slot4:make(function (slot0, slot1, slot2)
		if slot0 == UIItemList.EventUpdate then
			updateShip(slot2, uv0.ships[slot1 + 1])
		end
	end)
	slot4:align(#slot0.ships)
end

slot0.Show = function(slot0, slot1, slot2, slot3, slot4)
	uv0.super.Show(slot0)
	pg.UIMgr.GetInstance():BlurPanel(slot0._tf)

	slot0.key = nil
	slot0.eliteShips = slot1
	slot0.highLevelShips = slot2
	slot0.overflow = slot3

	slot0:SetCallBack(slot4)
	slot0:Updatelayout()
	slot0:UpdateShips()
end

slot0.ShowEliteTag = function(slot0, slot1, slot2)
	uv0.super.Show(slot0)
	pg.UIMgr.GetInstance():BlurPanel(slot0._tf)
	slot0:SetCallBack(slot2)
	setText(slot0.title, i18n(&quot;destroy_eliteship_tip&quot;, i18n(&quot;destroy_inHardFormation_tip&quot;)))
	setActive(slot0.urOverflowLabel, false)
	setActive(slot0.urLabel, false)
	setActive(slot0.urInput, false)

	slot0.ships = slot1

	if #slot0.ships &gt; 5 then
		slot4 = slot0._tf

		setActive(slot4:Find(&quot;window/content/ships&quot;), true)

		slot4 = slot0._tf

		setActive(slot4:Find(&quot;window/content/ships_single&quot;), false)

		slot3 = slot0._tf
		slot3 = slot3:Find(&quot;window/content/ships/content&quot;)

		slot3:GetComponent(&quot;LScrollRect&quot;).onUpdateItem = function (slot0, slot1)
			updateShip(tf(slot1), uv0.ships[slot0 + 1])
		end

		onNextTick(function ()
			uv0:SetTotalCount(#uv1.ships)
		end)

		return
	end

	setActive(slot0._tf:Find(&quot;window/content/ships&quot;), false)
	setActive(slot0._tf:Find(&quot;window/content/ships_single&quot;), true)

	slot3 = slot0._tf:Find(&quot;window/content/ships_single&quot;)
	slot4 = UIItemList.New(slot3, slot3:Find(&quot;IconTpl&quot;))

	slot4:make(function (slot0, slot1, slot2)
		if slot0 == UIItemList.EventUpdate then
			updateShip(slot2, uv0.ships[slot1 + 1])
		end
	end)
	slot4:align(#slot0.ships)
end

slot0.Updatelayout = function(slot0)
	slot2 = slot0.highLevelShips
	slot3 = {}

	if #slot0.eliteShips &gt; 0 then
		table.insert(slot3, i18n(&quot;destroy_high_rarity_tip&quot;))
	end

	if #slot2 &gt; 0 then
		table.insert(slot3, i18n(&quot;destroy_high_level_tip&quot;, &quot;&quot;))
	end

	setText(slot0.title, i18n(&quot;destroy_eliteship_tip&quot;, table.concat(slot3, &quot;、&quot;)))

	if _.any(slot1, function (slot0)
		return ShipRarity.SSR &lt;= slot0:getConfig(&quot;rarity&quot;)
	end) and not slot0.key then
		slot0.key = math.random(100000, 999999)

		setText(slot0.urLabel, i18n(&quot;destroy_ur_rarity_tip&quot;, slot0.key))
	else
		setText(slot0.urLabel, &quot;&quot;)
	end

	setActive(slot0.urOverflowLabel, slot4 and slot0.overflow)
	setActive(slot0.urLabel, slot4)
	setActive(slot0.urInput, slot4)
end

slot0.UpdateShips = function(slot0)
	slot3 = table.mergeArray(slot0.highLevelShips, slot0.eliteShips)

	mergeSort(slot3, CompareFuncs({
		function (slot0)
			return -slot0.level
		end,
		function (slot0)
			return -slot0:getRarity()
		end
	}, true))

	slot0.ships = slot3

	if #slot0.ships &gt; 5 then
		slot5 = slot0._tf

		setActive(slot5:Find(&quot;window/content/ships&quot;), true)

		slot5 = slot0._tf

		setActive(slot5:Find(&quot;window/content/ships_single&quot;), false)

		slot4 = slot0._tf
		slot4 = slot4:Find(&quot;window/content/ships/content&quot;)

		slot4:GetComponent(&quot;LScrollRect&quot;).onUpdateItem = function (slot0, slot1)
			updateShip(tf(slot1), uv0.ships[slot0 + 1])
		end

		onNextTick(function ()
			uv0:SetTotalCount(#uv1.ships)
		end)

		return
	end

	setActive(slot0._tf:Find(&quot;window/content/ships&quot;), false)
	setActive(slot0._tf:Find(&quot;window/content/ships_single&quot;), true)

	slot4 = slot0._tf:Find(&quot;window/content/ships_single&quot;)
	slot5 = UIItemList.New(slot4, slot4:Find(&quot;IconTpl&quot;))

	slot5:make(function (slot0, slot1, slot2)
		if slot0 == UIItemList.EventUpdate then
			updateShip(slot2, uv0.ships[slot1 + 1])
		end
	end)
	slot5:align(#slot0.ships)
end

slot0.Hide = function(slot0)
	uv0.super.Hide(slot0)
	pg.UIMgr.GetInstance():UnblurPanel(slot0._tf, slot0._parentTf)

	slot0.key = nil
	slot0.callback = nil

	setInputText(slot0.urInput, &quot;&quot;)
end

slot0.OnDestroy = function(slot0)
	if slot0:isShowing() then
		slot0:Hide()
	end
end

return slot0
</code></pre>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-lua.min.js"></script>
</body>
</html>