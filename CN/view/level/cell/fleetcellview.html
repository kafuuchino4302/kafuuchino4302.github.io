<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>fleetcellview.lua</title>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
</head>
<body>
    <h1>fleetcellview.lua</h1>
    <a href="index.html">返回主页</a>
    <pre><code class="language-lua">slot2 = class(&quot;FleetCellView&quot;, DecorateClass(import(&quot;.DynamicCellView&quot;), import(&quot;.SpineCellView&quot;)))

slot2.Ctor = function(slot0, slot1)
	uv0.super.Ctor(slot0, slot1)
	uv1.Ctor(slot0)
	uv1.InitCellTransform(slot0)

	slot0.tfArrow = slot0.tf:Find(&quot;arrow&quot;)
	slot0.tfAmmo = slot0.tf:Find(&quot;ammo&quot;)
	slot0.tfAmmoText = slot0.tfAmmo:Find(&quot;text&quot;)
	slot0.tfOp = slot0.tf:Find(&quot;op&quot;)
	slot0.tfIconRecorded = nil
	slot0.RecordedFlag = nil
end

slot2.GetOrder = function(slot0)
	return ChapterConst.CellPriorityFleet
end

slot2.showPoisonDamage = function(slot0, slot1)
	slot2 = &quot;dexiv4_SLG_poison&quot;
	slot3 = slot0.tfShip.localPosition
	slot4 = slot0:GetLoader()

	slot4:GetPrefab(&quot;ui/&quot; .. slot2, slot2, function (slot0)
		setParent(slot0.transform, uv0.tf, false)
		LeanTween.moveY(uv0.tfShip, uv1.y - 10, 0.1):setEase(LeanTweenType.easeInOutSine):setLoopPingPong()

		if not IsNil(slot0:GetComponent(typeof(ParticleSystemEvent))) then
			slot1:AddEndEvent(function ()
				uv0.tfShip.localPosition = uv1

				uv0.loader:ClearRequest(&quot;PoisonDamage&quot;)
				LeanTween.cancel(uv0.tfShip.gameObject)

				if uv2 then
					uv2()
				end
			end)
		end
	end, &quot;PoisonDamage&quot;)
end

slot2.SetActiveNoPassIcon = function(slot0, slot1)
	slot2 = &quot;NoPassIcon&quot;

	if not slot1 then
		if slot0.loader then
			slot0.loader:ClearRequest(slot2)
		end
	else
		if slot0:GetLoader():GetRequestPackage(slot2) then
			return
		end

		slot4 = &quot;event_task_small&quot;
		slot5 = slot0:GetLoader()

		slot5:GetPrefabBYStopLoading(&quot;boxprefab/&quot; .. slot4, slot4, function (slot0)
			setParent(slot0.transform, uv0.tf, false)

			slot1 = 150

			setLocalPosition(slot0, Vector3(0, slot1, 0))
			LeanTween.moveY(rtf(slot0), slot1 - 10, 1):setEase(LeanTweenType.easeInOutSine):setLoopPingPong()
		end, slot2)
	end
end

slot2.UpdateIconRecordedFlag = function(slot0, slot1)
	slot0.RecordedFlag = slot1

	slot0:UpdateIconRecorded()
end

slot2.UpdateIconRecorded = function(slot0)
	if not (slot0.RecordedFlag and slot0.visible) then
		if not IsNil(slot0.tfIconRecorded) then
			setActive(slot0.tfIconRecorded, false)
		end
	else
		if IsNil(slot0.tfIconRecorded) then
			slot2 = pg.PoolMgr.GetInstance()

			slot2:GetPrefab(&quot;effect/fleet_status_recorded&quot;, &quot;&quot;, false, function (slot0)
				uv0.tfIconRecorded = tf(slot0)

				setParent(slot0, uv0.tf, false)
			end)
		end

		setActive(slot0.tfIconRecorded, true)
	end
end

slot2.TweenShining = function(slot0)
	if not slot0:GetSpineRole() then
		return
	end

	slot2 = Color.black
	slot3 = Color.gray
	slot2.a = 0
	slot3.a = 0

	slot1:TweenShining(0.2, 2, 0, 1, slot2, slot3, true, true)
end

slot2.SetSpineVisible = function(slot0, slot1)
	slot0.visible = slot1

	uv0.super.SetSpineVisible(slot0, slot1)
	setActive(slot0.tfShadow, slot1)
	slot0:UpdateIconRecorded()
end

slot2.StopTween = function(slot0)
	if not slot0:GetSpineRole() then
		return
	end

	slot1:StopTweenShining()
end

slot2.unloadSpine = function(slot0)
	uv0.super.UnloadSpine(slot0)
end

slot2.Clear = function(slot0)
	uv0.ClearSpine(slot0)
	uv1.super.Clear(slot0)
end

return slot2
</code></pre>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-lua.min.js"></script>
</body>
</html>