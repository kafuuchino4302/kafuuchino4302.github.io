<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>spweaponhelper.lua</title>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
</head>
<body>
    <h1>spweaponhelper.lua</h1>
    <a href="index.html">返回主页</a>
    <pre><code class="language-lua">slot1, slot2, slot3, slot4, slot5 = nil

slot1 = function(slot0, slot1)
	if IsNil(slot0.Find(slot0, &quot;base&quot;)) then
		return
	end

	slot3 = slot1.name
	slot4 = slot1.value

	setActive(slot2, slot4)

	if not slot4 then
		return
	end

	setText(slot2.Find(slot2, &quot;name&quot;), slot3)
	Canvas.ForceUpdateCanvases()

	if not IsNil(slot2.Find(slot2, &quot;value&quot;)) then
		setActive(slot2:Find(&quot;value&quot;), slot4)
		changeToScrollText(slot2:Find(&quot;value/Text&quot;), slot4)
	end

	if not IsNil(slot2.Find(slot2, &quot;effect&quot;)) then
		setActive(slot2.Find(slot2, &quot;effect&quot;), false)
	end

	setActive(slot2:Find(&quot;value/up&quot;), slot1.compare and slot1.compare &gt; 0)
	setActive(slot2:Find(&quot;value/down&quot;), slot1.compare and slot1.compare &lt; 0)
	triggerToggle(slot2, slot1.lock_open)

	if not slot1.lock_open and slot1.sub and #slot1.sub &gt; 0 then
		GetComponent(slot2, typeof(Toggle)).enabled = true
	else
		setActive(slot2.Find(slot2, &quot;name/close&quot;), false)
		setActive(slot2.Find(slot2, &quot;name/open&quot;), false)

		GetComponent(slot2, typeof(Toggle)).enabled = false
	end
end

slot3 = function(slot0, slot1)
	if IsNil(slot0.Find(slot0, &quot;desc&quot;)) then
		return
	end

	setActive(slot2, slot1.desc)

	if not slot1.desc then
		return
	end

	setText(slot2.Find(slot2, &quot;Text&quot;), slot1.desc)
end

slot2 = function(slot0, slot1)
	uv0(slot0, slot1)
	uv1(slot0, slot1)
end

slot4 = function(slot0, slot1, slot2)
	removeAllChildren(slot0)
	uv0(slot0, slot1, slot2)
end

slot5 = function(slot0, slot1, slot2)
	for slot6, slot7 in ipairs(slot2) do
		uv0(cloneTplTo(slot1, slot0), slot7)
	end
end

updateSpWeaponInfo = function(slot0, slot1, slot2)
	uv0(slot0.Find(slot0, &quot;attrs&quot;), slot0.Find(slot0, &quot;attr_tpl&quot;), slot1.attrs)

	slot4 = {}

	if slot2[1].skillId &gt; 0 then
		slot5 = getSkillDesc(slot2[1].skillId, slot2[1].lv)

		if not slot2[1].unlock then
			slot5 = setColorStr(i18n(&quot;spweapon_tip_skill_locked&quot;) .. slot5, &quot;#a2a2a2&quot;)
		end

		table.insert(slot4, {
			name = i18n(&quot;spweapon_attr_effect&quot;),
			value = setColorStr(getSkillName(slot2[1].skillId), slot2[1].unlock and &quot;#FFDE00FF&quot; or &quot;#A2A2A2&quot;),
			desc = slot5
		})
	end

	for slot8, slot9 in ipairs(slot2[2]) do
		slot10 = getSkillDesc(slot9.skillId, slot9.lv)

		if not slot9.unlock then
			slot10 = setColorStr(i18n(&quot;spweapon_tip_skill_locked&quot;) .. slot10, &quot;#a2a2a2&quot;)
		end

		table.insert(slot4, {
			name = i18n(&quot;spweapon_attr_skillupgrade&quot;),
			value = setColorStr(getSkillName(slot9.skillId), slot9.unlock and &quot;#FFDE00FF&quot; or &quot;#A2A2A2&quot;),
			desc = slot10
		})
	end

	uv1(slot0:Find(&quot;attrs&quot;), slot3, slot4)

	slot5 = cloneTplTo(slot3, slot0:Find(&quot;part&quot;))

	slot5:SetSiblingIndex(0)
	uv2(slot5, {
		value = &quot;&quot;,
		name = i18n(&quot;equip_info_23&quot;)
	})

	slot7 = slot0:Find(&quot;part/value&quot;):Find(&quot;label&quot;)
	slot8 = {}
	slot9 = {}

	if #slot1.part[1] == 0 and #slot1.part[2] == 0 then
		setmetatable(slot8, {
			__index = function (slot0, slot1)
				return true
			end
		})
		setmetatable(slot9, {
			__index = function (slot0, slot1)
				return true
			end
		})
	else
		for slot13, slot14 in ipairs(slot1.part[1]) do
			slot8[slot14] = true
		end

		for slot13, slot14 in ipairs(slot1.part[2]) do
			slot9[slot14] = true
		end
	end

	UIItemList.StaticAlign(slot6, slot7, #ShipType.MergeFengFanType(ShipType.FilterOverQuZhuType(ShipType.AllShipType), slot8, slot9), function (slot0, slot1, slot2)
		slot1 = slot1 + 1

		if slot0 == UIItemList.EventUpdate then
			slot3 = uv0[slot1]

			GetImageSpriteFromAtlasAsync(&quot;shiptype&quot;, ShipType.Type2CNLabel(slot3), slot2)
			setActive(slot2:Find(&quot;main&quot;), uv1[slot3] and not uv2[slot3])
			setActive(slot2:Find(&quot;sub&quot;), uv2[slot3] and not uv1[slot3])
			setImageAlpha(slot2, not uv1[slot3] and not uv2[slot3] and 0.3 or 1)
		end
	end)
	setActive(slot3, false)
end

slot6 = function(slot0)
	slot1 = slot0:GetConfigAttributes()
	slot2 = slot0:GetBaseAttributes()

	return {
		{
			type = slot0:getConfig(&quot;attribute_1&quot;),
			configAttr = slot1[1],
			baseAttr = slot2[1]
		},
		{
			type = slot0:getConfig(&quot;attribute_2&quot;),
			configAttr = slot1[2],
			baseAttr = slot2[2]
		}
	}
end

slot7 = function(slot0, slot1)
	slot2 = {
		attrs = {}
	}

	for slot6 = 1, #slot0 do
		slot7 = slot0[slot6]
		slot8 = AttributeType.Type2Name(slot7.type)
		slot9 = nil

		if not slot7.empty then
			slot9 = slot7.configAttr .. &quot; + &quot; .. slot7.baseAttr

			if not slot1:IsReal() then
				slot9 = slot9 .. &quot;~&quot; .. slot1.GetAttributesRange(slot1)[slot6]
			end
		else
			slot9 = 0
		end

		table.insert(slot2.attrs, {
			name = slot8,
			value = slot9,
			compare = slot7.compare
		})
	end

	slot3 = slot1:GetWearableShipTypes()
	slot2.part = {
		slot3,
		slot3
	}

	return slot2
end

return {
	AlignAttrs = function (slot0, slot1)
		for slot5 = 1, #slot0 do
			if not slot1[slot5] or slot0[slot5].type ~= slot1[slot5].type then
				slot6 = false

				for slot10 = slot5 + 1, #slot1 do
					if slot1[slot5].type == slot1[slot10].type then
						table.insert(slot1, slot5, table.remove(slot1, slot10))

						slot6 = true

						break
					end
				end

				if not slot6 then
					table.insert(slot1, slot5, {
						type = slot0[slot5].type
					})

					slot1[slot5].empty = true
				end
			end
		end

		for slot5 = #slot0 + 1, #slot1 do
			table.insert(slot0, {
				type = slot1[slot5].type
			})

			slot0[slot5].empty = true
		end
	end,
	CompareInfo = function (slot0, slot1)
		slot1.compare = (slot1.empty and 0 or slot1.configAttr + slot1.baseAttr) - (slot0.empty and 0 or slot0.configAttr + slot0.baseAttr)
	end,
	InsertAttrsCompare = function (slot0, slot1)
		uv0.AlignAttrs(slot0, slot1)

		for slot5 = 1, #slot0 do
			uv0.CompareInfo(slot0[slot5], slot1[slot5])
		end
	end,
	TransformNormalInfo = function (slot0)
		return uv1(uv0(slot0), slot0)
	end,
	CompareNormalInfo = function (slot0, slot1)
		slot2 = uv0(slot0)
		slot3 = uv0(slot1)

		uv1.InsertAttrsCompare(slot2, slot3)

		return uv2(slot2, slot0), uv2(slot3, slot1)
	end,
	TransformCompositeInfo = function (slot0)
		slot1 = {}
		slot2 = {
			slot0.getConfig(slot0, &quot;attribute_1&quot;),
			slot0.getConfig(slot0, &quot;attribute_2&quot;)
		}
		slot3 = slot0.GetConfigAttributes(slot0)
		slot4 = slot0.GetAttributesRange(slot0)

		for slot8 = 1, 2 do
			table.insert(slot1, {
				name = AttributeType.Type2Name(slot2[slot8]),
				value = slot3[slot8] .. &quot; + 0~&quot; .. slot4[slot8]
			})
		end

		return slot1
	end,
	TransformUpgradeInfo = function (slot0, slot1)
		slot2 = {}
		slot3 = {
			slot0.getConfig(slot0, &quot;attribute_1&quot;),
			slot0.getConfig(slot0, &quot;attribute_2&quot;)
		}
		slot4 = slot0.GetConfigAttributes(slot0)
		slot5 = slot1.GetConfigAttributes(slot1)
		slot6 = slot0.GetBaseAttributes(slot0)

		for slot10 = 1, 2 do
			slot11 = AttributeType.Type2Name(slot3[slot10])
			slot12 = slot5[slot10] .. &quot; + &quot; .. slot6[slot10]

			if slot4[slot10] ~= slot5[slot10] then
				slot12 = slot4[slot10] .. &quot;   &gt;   &quot; .. slot12
			end

			table.insert(slot2, {
				name = slot11,
				value = slot12
			})
		end

		return slot2
	end
}
</code></pre>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-lua.min.js"></script>
</body>
</html>