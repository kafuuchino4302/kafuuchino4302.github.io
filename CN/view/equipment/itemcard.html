<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>itemcard.lua</title>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
</head>
<body>
    <h1>itemcard.lua</h1>
    <a href="index.html">返回主页</a>
    <pre><code class="language-lua">slot0 = class(&quot;ItemCard&quot;)

slot0.Ctor = function(slot0, slot1)
	slot0.go = slot1
	slot0.bg = findTF(slot1, &quot;bg&quot;)
	slot0.countTF = findTF(slot1, &quot;bg/icon_bg/count&quot;):GetComponent(typeof(Text))
	slot0.nameTF = findTF(slot1, &quot;bg/name&quot;):GetComponent(typeof(Text))
	slot0.timeLimitTag = findTF(slot1, &quot;bg/timeline&quot;)

	ClearTweenItemAlphaAndWhite(slot0.go)
end

slot0.update = function(slot0, slot1)
	slot0.itemVO = slot1

	if not IsNil(slot0.timeLimitTag) then
		setActive(slot0.timeLimitTag, slot1:getConfig(&quot;time_limit&quot;) == 1 or Item.InTimeLimitSkinAssigned(slot1.id))
	end

	updateItem(rtf(slot0.bg), slot1)
	TweenItemAlphaAndWhite(slot0.go)

	slot0.countTF.text = slot1.count &gt; 0 and slot1.count or &quot;&quot;
	slot0.nameTF.text = slot0:ShortenString(slot1:getConfig(&quot;name&quot;), 6)
end

slot0.ShortenString = function(slot0, slot1, slot2)
	slot3 = 1
	slot4 = 0
	slot5 = 0
	slot6 = #slot1
	slot7 = false

	while slot3 &lt;= slot6 do
		slot9, slot10 = GetPerceptualSize(string.byte(slot1, slot3))
		slot3 = slot3 + slot9

		if math.ceil(slot4 + slot10) == slot2 - 1 then
			slot5 = slot3
		elseif slot2 &lt; slot11 then
			slot7 = true

			break
		end
	end

	if slot5 == 0 or slot6 &lt; slot5 or not slot7 then
		return slot1
	end

	return string.sub(slot1, 1, slot5 - 1) .. &quot;..&quot;
end

slot0.clear = function(slot0)
	ClearTweenItemAlphaAndWhite(slot0.go)
end

slot0.dispose = function(slot0)
end

return slot0
</code></pre>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-lua.min.js"></script>
</body>
</html>