<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>trophydetailpanel.lua</title>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
</head>
<body>
    <h1>trophydetailpanel.lua</h1>
    <a href="index.html">返回主页</a>
    <pre><code class="language-lua">slot0 = class(&quot;TrophyDetailPanel&quot;)

slot0.Ctor = function(slot0, slot1, slot2)
	slot0._go = slot1
	slot0._tf = slot1.transform
	slot0._parent = slot2
	slot0.UIMgr = pg.UIMgr.GetInstance()

	pg.DelegateInfo.New(slot0)

	slot0._medalIcon = findTF(slot0._tf, &quot;center/medalBG/icon&quot;)
	slot0._nameLabel = findTF(slot0._tf, &quot;center/name&quot;)
	slot3 = findTF(slot0._tf, &quot;center/timeStamp/Text&quot;)
	slot0._timeStamp = slot3:GetComponent(typeof(Text))
	slot3 = findTF(slot0._tf, &quot;center/desc/Text&quot;)
	slot0._desc = slot3:GetComponent(typeof(Text))
	slot0._progressBar = findTF(slot0._tf, &quot;center/progress_bar/progress&quot;)
	slot3 = findTF(slot0._tf, &quot;center/rank/Text&quot;)
	slot0._rank = slot3:GetComponent(typeof(Text))
	slot0._lock = findTF(slot0._tf, &quot;center/medalBG/lock&quot;)
	slot0._conditionList = findTF(slot0._tf, &quot;center/conditions/container&quot;)
	slot0._conditionTpl = findTF(slot0._tf, &quot;center/conditions/condition_tpl&quot;)

	onButton(slot0, slot0._go, function ()
		uv0:SetActive(false)
	end, SFX_CANCEL)

	slot0._stepper = findTF(slot0._tf, &quot;center/stepper&quot;)
	slot0._preTrophyBtn = findTF(slot0._stepper, &quot;pre&quot;)
	slot0._postTrophyBtn = findTF(slot0._stepper, &quot;post&quot;)
	slot0._pageText = findTF(slot0._stepper, &quot;page&quot;)
	slot0._backTipsText = findTF(slot0._tf, &quot;center/backTips/GameObject (1)&quot;)

	setText(slot0._backTipsText, i18n(&quot;world_collection_back&quot;))
	onButton(slot0, slot0._postTrophyBtn, function ()
		uv0:UpdateTrophy(uv0._trophyGroup:getPostTrophy(uv0._trophy))
	end)
	onButton(slot0, slot0._preTrophyBtn, function ()
		uv0:UpdateTrophy(uv0._trophyGroup:getPreTrophy(uv0._trophy))
	end)

	slot0._active = false
end

slot0.SetTrophyGroup = function(slot0, slot1)
	slot0._trophyGroup = slot1
end

slot0.UpdateTrophy = function(slot0, slot1)
	if slot1 == nil then
		return
	end

	slot0._trophy = slot1
	slot0._rank.text = slot1:getConfig(&quot;rank&quot;)
	slot0._desc.text = slot1:getConfig(&quot;desc&quot;)

	if slot1:isClaimed() then
		slot2 = pg.TimeMgr.GetInstance():STimeDescS(slot1.timestamp, &quot;*t&quot;)
		slot0._timeStamp.text = slot2.year .. &quot;/&quot; .. slot2.month .. &quot;/&quot; .. slot2.day
	else
		slot0._timeStamp.text = &quot;-&quot;
	end

	removeAllChildren(slot0._conditionList)
	LoadImageSpriteAsync(&quot;medal/&quot; .. slot1:getConfig(&quot;icon&quot;), slot0._medalIcon, true)
	SetActive(slot0._lock, not slot1:isClaimed())
	LoadImageSpriteAsync(&quot;medal/&quot; .. slot1:getConfig(&quot;label&quot;), slot0._nameLabel, true)

	slot2 = function(slot0, slot1)
		setText(findTF(slot0, &quot;desc&quot;), slot1:getConfig(&quot;condition&quot;))

		slot2, slot3 = slot1:getProgress()

		if slot1:getTargetType() == Trophy.INTAMACT_TYPE then
			setText(findTF(slot0, &quot;progress&quot;), slot1:isDummy() and &quot;&quot; or &quot;[&quot; .. math.modf(slot2 / 100) .. &quot;/&quot; .. math.modf(slot3 / 100) .. &quot;]&quot;)
		else
			setText(findTF(slot0, &quot;progress&quot;), slot1:isDummy() and &quot;&quot; or &quot;[&quot; .. slot2 .. &quot;/&quot; .. slot3 .. &quot;]&quot;)
		end
	end

	if not slot1:isComplexTrophy() then
		slot2(cloneTplTo(slot0._conditionTpl, slot0._conditionList), slot1)
	else
		for slot6, slot7 in pairs(slot1:getSubTrophy()) do
			slot2(cloneTplTo(slot0._conditionTpl, slot0._conditionList), slot7)
		end
	end

	slot0._progressBar:GetComponent(typeof(Image)).fillAmount = slot1:getProgressRate()

	slot0:updateStepper(slot1)
end

slot0.updateStepper = function(slot0, slot1)
	setText(slot0._pageText, slot0._trophyGroup:getTrophyIndex(slot0._trophy) .. &quot;/&quot; .. slot0._trophyGroup:getTrophyCount())
end

slot0.SetActive = function(slot0, slot1)
	SetActive(slot0._go, slot1)

	slot0._active = slot1

	if slot1 then
		pg.UIMgr.GetInstance():BlurPanel(slot0._go, false, {
			weight = LayerWeightConst.SECOND_LAYER
		})
	else
		pg.UIMgr.GetInstance():UnblurPanel(slot0._go, slot0._parent)
	end
end

slot0.IsActive = function(slot0)
	return slot0._active
end

slot0.Dispose = function(slot0)
	pg.DelegateInfo.Dispose(slot0)
end

return slot0
</code></pre>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-lua.min.js"></script>
</body>
</html>