<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>skinatlascard.lua</title>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
</head>
<body>
    <h1>skinatlascard.lua</h1>
    <a href="index.html">返回主页</a>
    <pre><code class="language-lua">slot0 = class(&quot;SkinAtlasCard&quot;)

slot0.Ctor = function(slot0, slot1)
	slot0._go = slot1
	slot0._tf = slot1.transform
	slot0.usingTr = findTF(slot0._tf, &quot;using&quot;)
	slot0.unavailableTr = findTF(slot0._tf, &quot;unavailable&quot;)
	slot0.icon = findTF(slot0._tf, &quot;mask/icon&quot;)
	slot0.name = findTF(slot0._tf, &quot;name/Text&quot;):GetComponent(typeof(Text))
	slot0.enName = findTF(slot0._tf, &quot;name/en&quot;):GetComponent(typeof(Text))
	slot0.tags = findTF(slot0._tf, &quot;tags&quot;)
	slot0.changeSkinUI = findTF(slot0._tf, &quot;changeSkin&quot;)
	slot0.changeSkinToggle = nil

	setText(slot0.usingTr:Find(&quot;Text&quot;), i18n(&quot;shop_new_in_use&quot;))
	setText(slot0.unavailableTr:Find(&quot;Text&quot;), i18n(&quot;shop_new_unable_to_use&quot;))
end

slot0.Update = function(slot0, slot1, slot2)
	slot0.index = slot2
	slot0.skin = slot1

	GetImageSpriteFromAtlasAsync(&quot;shipYardIcon/&quot; .. slot1:getConfig(&quot;painting&quot;), &quot;&quot;, slot0.icon)

	slot4 = false
	slot5 = false

	if pg.ship_skin_template[slot0.skin.id].skin_type ~= ShipSkin.SKIN_TYPE_TB then
		slot8 = not slot1:WithoutUse()
		slot9 = #getProxy(BayProxy):findShipsByGroup(slot1:getConfig(&quot;ship_group&quot;)) == 0 or getProxy(CollectionProxy).shipGroups[slot6] == nil
	end

	setActive(slot0.usingTr, slot4)
	setActive(slot0.unavailableTr, slot5)

	slot0.name.text = shortenString(slot1:getConfig(&quot;name&quot;), 7)

	if slot3.skin_type == ShipSkin.SKIN_TYPE_TB then
		slot0.enName.text = NewEducateHelper.GetShipNameBySecId(NewEducateHelper.GetSecIdBySkinId(slot0.skinId))
	else
		slot0.enName.text = ShipGroup.getDefaultShipConfig(slot3.ship_group).english_name
	end

	setActive(slot0.changeSkinUI, ShipSkin.GetChangeSkinData(slot0.skin.id) and true or false)

	if slot7 then
		if not slot0.changeSkinToggle then
			slot0.changeSkinToggle = ChangeSkinToggle.New(findTF(slot0.changeSkinUI, &quot;ChangeSkinToggleUI&quot;))
		end

		slot0.changeSkinToggle:setSkinData(slot0.skin.id)
	end

	slot0:FlushTags(slot1:getConfig(&quot;tag&quot;))
end

slot0.changeSkinNext = function(slot0)
	if ShipSkin.GetChangeSkinData(slot0.skin.id) then
		slot0:Update(ShipSkin.New({
			id = ShipSkin.GetChangeSkinNextId(slot0.skin.id)
		}), slot0.index)
	end
end

slot0.FlushTags = function(slot0, slot1)
	slot2 = -10
	slot3 = findTF(slot0._tf, &quot;tags/icon&quot;)

	if slot0.tags.childCount &lt; #slot1 then
		for slot7 = slot0.tags.childCount + 1, #slot1 do
			slot8 = Object.Instantiate(slot3, slot3.parent)
		end
	end

	for slot7 = 1, #slot1 do
		slot8 = slot0.tags
		slot8 = slot8:GetChild(slot7 - 1)

		setActive(slot8, true)
		LoadSpriteAtlasAsync(&quot;SkinIcon&quot;, &quot;type_&quot; .. ShipSkin.Tag2Name(slot1[slot7]) .. &quot;_own&quot;, function (slot0)
			if uv0.exited then
				return
			end

			slot1 = uv1:GetComponent(typeof(Image))
			slot1.sprite = slot0

			slot1:SetNativeSize()
		end)

		slot8.localPosition = Vector3(slot8.localPosition.x, slot3.localPosition.y - (slot7 - 1) * (slot3.sizeDelta.y + slot2), 0)
	end

	if slot0.tags.childCount &gt; #slot1 then
		for slot7 = #slot1 + 1, slot0.tags.childCount do
			setActive(slot0.tags:GetChild(slot7 - 1), false)
		end
	end
end

slot0.Dispose = function(slot0)
	slot0.exited = true
end

return slot0
</code></pre>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-lua.min.js"></script>
</body>
</html>