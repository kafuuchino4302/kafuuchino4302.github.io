<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>mailconfirmationwindow.lua</title>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
</head>
<body>
    <h1>mailconfirmationwindow.lua</h1>
    <a href="index.html">返回主页</a>
    <pre><code class="language-lua">slot0 = class(&quot;MailConfirmationWindow&quot;, import(&quot;view.base.BaseSubView&quot;))

slot0.getUIName = function(slot0)
	return &quot;MailConfirmationMsgboxUI&quot;
end

slot0.OnInit = function(slot0)
	onButton(slot0, slot0._tf:Find(&quot;bg&quot;), function ()
		uv0:Hide()
	end, SFX_PANEL)

	slot0.closeBtn = slot0:findTF(&quot;adapt/window/top/btnBack&quot;)

	onButton(slot0, slot0.closeBtn, function ()
		uv0:Hide()
	end, SFX_PANEL)

	slot0.cancelButton = slot0:findTF(&quot;adapt/window/button_container/btn_not&quot;)
	slot0.confirmButton = slot0:findTF(&quot;adapt/window/button_container/btn_ok&quot;)
	slot0._window = slot0._tf:Find(&quot;adapt/window&quot;)
	slot0._window_details = slot0._tf:Find(&quot;adapt/window_details&quot;)
	slot0.titleTips = slot0._window:Find(&quot;top/bg/infomation/title&quot;)
	slot0._msgPanel = slot0._window:Find(&quot;msg_panel&quot;)
	slot0.contentText = slot0._window:Find(&quot;msg_panel/content&quot;)
	slot0._itemPanel = slot0._window:Find(&quot;item_panel&quot;)
	slot0._itemText = slot0._itemPanel:Find(&quot;tip/confire_text&quot;):GetComponent(typeof(Text))
	slot0._itemListItemContainer = slot0._itemPanel:Find(&quot;scrollview/list&quot;)
	slot0._itemListItemTpl = slot0._itemListItemContainer:Find(&quot;item&quot;)
	slot0._deltailBtn = slot0._itemPanel:Find(&quot;tip/more_btn&quot;)
	slot0.rewardList = slot0._itemPanel:Find(&quot;scrollview/list&quot;):GetComponent(&quot;LScrollRect&quot;)

	slot0.rewardList.onUpdateItem = function(slot0, slot1)
		updateDrop(tf(slot1):Find(&quot;IconTpl&quot;), uv0.items[slot0 + 1])

		slot3 = tf(slot1):Find(&quot;IconTpl/name&quot;)

		setText(slot3, shortenString(getText(slot3), 4))
	end

	slot0._deltailBtnSelectBg = slot0._deltailBtn:Find(&quot;selectBg&quot;)
	slot0._deltailBtnUnSelectBg = slot0._deltailBtn:Find(&quot;unselectBg&quot;)
	slot0._totolmailCountText = slot0._window_details:Find(&quot;top/mail/Text&quot;)
	slot0._mailGettitle = slot0._window_details:Find(&quot;top/bg/infomation/title&quot;)
	slot0.lsrMailList = slot0._window_details:Find(&quot;item_panel/scrollview/list&quot;):GetComponent(&quot;LScrollRect&quot;)

	slot0.lsrMailList.onUpdateItem = function(slot0, slot1)
		setText(tf(slot1):Find(&quot;Text&quot;), shortenString(HXSet.hxLan(uv0.filterMails[slot0 + 1].title), 10))
	end

	slot0.mailids = {}

	onButton(slot0, slot0._deltailBtn, function ()
		if uv0.require then
			return
		end

		uv0.require = true

		uv0:emit(MailMediator.ON_GET_MAIL_TITLE, uv0.mailids, function (slot0)
			SetActive(uv0._deltailBtnUnSelectBg, false)
			SetActive(uv0._deltailBtnSelectBg, true)
			setActive(uv0._window_details, true)
			setText(uv0._mailGettitle, i18n(&quot;mail_getbox_title&quot;))

			uv0.filterMails = slot0

			table.sort(uv0.filterMails, CompareFuncs({
				function (slot0)
					return -slot0.id
				end
			}))
			setText(uv0._totolmailCountText, #uv0.filterMails)
			uv0.lsrMailList:SetTotalCount(#uv0.filterMails, 0)
		end)
	end, SFX_PANEL)
	slot0:commonSettings()
	setText(slot0.cancelButton:Find(&quot;Text&quot;), i18n(&quot;mail_box_cancel&quot;))
	setText(slot0.confirmButton:Find(&quot;Text&quot;), i18n(&quot;mail_box_confirm&quot;))
	setText(slot0.titleTips, i18n(&quot;mail_boxtitle_information&quot;))
end

slot0.showTipsBox = function(slot0, slot1)
	SetActive(slot0._msgPanel, true)
	setText(slot0.contentText, slot1.content)
end

slot0.showItemBox = function(slot0, slot1)
	SetActive(slot0._itemPanel, true)
	SetActive(slot0._deltailBtnUnSelectBg, true)
	SetActive(slot0._deltailBtnSelectBg, false)

	slot0.mailids = slot1.mailids
	slot0._itemText.text = slot1.content or &quot;&quot;

	setText(slot0._deltailBtn:Find(&quot;Text&quot;), i18n(&quot;mail_take_maildetail_msgbox&quot;))

	slot0.items = slot1.items

	slot0.rewardList:SetTotalCount(#slot0.items, 0)
end

slot0.commonSettings = function(slot0)
	setActive(slot0._msgPanel, false)
	setActive(slot0._itemPanel, false)
	setActive(slot0._window_details, false)

	slot0.require = false
end

slot0.Show = function(slot0, slot1)
	uv0.super.Show(slot0)

	slot2 = pg.UIMgr.GetInstance()

	slot2:BlurPanel(slot0._tf)
	slot0:commonSettings()
	switch(slot1.type, {
		[MailProxy.MailMessageBoxType.ReceiveAward] = function ()
			uv0:showItemBox(uv1)
		end,
		[MailProxy.MailMessageBoxType.ShowTips] = function ()
			uv0:showTipsBox(uv1)
		end
	})
	onButton(slot0, slot0.cancelButton, function ()
		uv0:Hide()
	end, SFX_PANEL)
	onButton(slot0, slot0.confirmButton, function ()
		uv0:Hide()

		if uv1.onYes then
			uv1.onYes()
		end
	end, SFX_PANEL)
end

slot0.Hide = function(slot0)
	pg.UIMgr.GetInstance():UnblurPanel(slot0._tf, slot0._parentTf)
	uv0.super.Hide(slot0)
end

slot0.OnDestroy = function(slot0)
	if slot0:isShowing() then
		slot0:Hide()
	end
end

return slot0
</code></pre>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-lua.min.js"></script>
</body>
</html>