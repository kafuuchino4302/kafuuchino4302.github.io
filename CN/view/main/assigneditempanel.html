<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>assigneditempanel.lua</title>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
</head>
<body>
    <h1>assigneditempanel.lua</h1>
    <a href="index.html">返回主页</a>
    <pre><code class="language-lua">slot0 = class(&quot;AssignedItemPanel&quot;)

slot0.Ctor = function(slot0, slot1, slot2)
	pg.DelegateInfo.New(slot0)

	slot0._go = slot1
	slot0._tf = tf(slot1)
	slot0.isInited = false
	slot0.selectedVO = nil
	slot0.count = 1
	slot0.view = slot2
end

slot0.findTF = function(slot0, slot1)
	return findTF(slot0._tf, slot1)
end

slot0.show = function(slot0)
	setActive(slot0._tf, true)
	pg.UIMgr.GetInstance():BlurPanel(slot0._tf)
end

slot0.hide = function(slot0)
	setActive(slot0._tf, false)

	slot0.selectedVO = nil
	slot0.itemVO = nil
	slot0.count = 1

	pg.UIMgr.GetInstance():UnblurPanel(slot0._tf, slot0.view._tf)

	if slot0.selectedItem then
		triggerToggle(slot0.selectedItem, false)
	end

	slot0.selectedItem = nil
end

slot0.init = function(slot0)
	slot0.isInited = true
	slot0.ulist = UIItemList.New(slot0:findTF(&quot;got/bottom/scroll/list&quot;), slot0:findTF(&quot;got/bottom/scroll/list/tpl&quot;))
	slot0.confirmBtn = slot0:findTF(&quot;calc/confirm&quot;)
	slot0.rightArr = slot0:findTF(&quot;calc/value_bg/add&quot;)
	slot0.leftArr = slot0:findTF(&quot;calc/value_bg/mius&quot;)
	slot0.maxBtn = slot0:findTF(&quot;calc/max&quot;)
	slot0.valueText = slot0:findTF(&quot;calc/value_bg/Text&quot;)
	slot0.itemTF = slot0:findTF(&quot;item/bottom/item&quot;)
	slot0.nameTF = slot0:findTF(&quot;item/bottom/name_bg/name&quot;)
	slot0.descTF = slot0:findTF(&quot;item/bottom/desc&quot;)

	onButton(slot0, slot0._tf, function ()
		uv0:hide()
	end, SFX_PANEL)
	onButton(slot0, slot0.rightArr, function ()
		if not uv0.itemVO then
			return
		end

		uv0.count = math.min(uv0.count + 1, uv0.itemVO.count)

		uv0:updateValue()
	end, SFX_PANEL)
	onButton(slot0, slot0.leftArr, function ()
		if not uv0.itemVO then
			return
		end

		uv0.count = math.max(uv0.count - 1, 1)

		uv0:updateValue()
	end, SFX_PANEL)
	onButton(slot0, slot0.maxBtn, function ()
		if not uv0.itemVO then
			return
		end

		uv0.count = uv0.itemVO.count

		uv0:updateValue()
	end, SFX_PANEL)
	onButton(slot0, slot0.confirmBtn, function ()
		if not uv0.selectedVO or not uv0.itemVO or uv0.count &lt;= 0 then
			return
		end

		uv0.view:emit(EquipmentMediator.ON_USE_ITEM, uv0.itemVO.id, uv0.count, uv0.selectedVO)
		uv0:hide()
	end, SFX_PANEL)
end

slot0.updateValue = function(slot0)
	setText(slot0.valueText, slot0.count)

	slot1 = slot0.ulist

	slot1:each(function (slot0, slot1)
		setText(slot1:Find(&quot;item/bg/icon_bg/count&quot;), uv0.count)
	end)
end

slot0.update = function(slot0, slot1)
	slot0.itemVO = slot1

	if not slot0.isInited then
		slot0:init()
	end

	slot0.selectedItem = nil

	slot0.ulist:make(function (slot0, slot1, slot2)
		if slot0 == UIItemList.EventUpdate then
			slot3 = uv0[slot1 + 1]
			slot4 = {
				type = slot3[1],
				id = slot3[2],
				count = slot3[3]
			}

			updateDrop(slot2:Find(&quot;item/bg&quot;), slot4)

			slot5 = slot2:Find(&quot;item/bg/icon_bg/count&quot;)

			onToggle(uv1, slot2, function (slot0)
				if slot0 then
					uv0.selectedVO = uv1:getConfig(&quot;usage_arg&quot;)[uv2 + 1]

					setText(uv3, uv0.count * uv4[3])

					uv0.selectedItem = uv5
				end
			end, SFX_PANEL)
			setScrollText(slot2:Find(&quot;name_bg/Text&quot;), slot4:getConfig(&quot;name&quot;))
		end
	end)
	slot0.ulist:align(#slot1:getConfig(&quot;display_icon&quot;))
	slot0:updateValue()
	updateDrop(slot0.itemTF:Find(&quot;bg&quot;), {
		type = DROP_TYPE_ITEM,
		id = slot1.id,
		count = slot1.count
	})
	setText(slot0.nameTF, slot1:getConfig(&quot;name&quot;))
	setText(slot0.descTF, slot1:getConfig(&quot;display&quot;))
end

slot0.dispose = function(slot0)
	pg.DelegateInfo.Dispose(slot0)
end

return slot0
</code></pre>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-lua.min.js"></script>
</body>
</html>