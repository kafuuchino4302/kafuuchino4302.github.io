<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>worldbosshelppage.lua</title>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
</head>
<body>
    <h1>worldbosshelppage.lua</h1>
    <a href="index.html">返回主页</a>
    <pre><code class="language-lua">slot0 = class(&quot;WorldBossHelpPage&quot;, import(&quot;....base.BaseSubView&quot;))

slot0.getUIName = function(slot0)
	return &quot;WorldBossHelpUI&quot;
end

slot0.OnLoaded = function(slot0)
	slot0.friendBtn = slot0:findTF(&quot;window/sliders/content/friend&quot;)
	slot0.friendRequested = slot0.friendBtn:Find(&quot;requested&quot;)
	slot0.friendMark = slot0.friendBtn:Find(&quot;mark&quot;)
	slot0.friendSupportTimeTxt = slot0.friendBtn:Find(&quot;requested/Text&quot;):GetComponent(typeof(Text))
	slot0.guildBtn = slot0:findTF(&quot;window/sliders/content/guild&quot;)
	slot0.guildRequested = slot0.guildBtn:Find(&quot;requested&quot;)
	slot0.guildMark = slot0.guildBtn:Find(&quot;mark&quot;)
	slot0.guildSupportTimeTxt = slot0.guildBtn:Find(&quot;requested/Text&quot;):GetComponent(typeof(Text))
	slot0.worldBtn = slot0:findTF(&quot;window/sliders/content/world&quot;)
	slot0.worldRequested = slot0.worldBtn:Find(&quot;requested&quot;)
	slot0.worldMark = slot0.worldBtn:Find(&quot;mark&quot;)
	slot0.worldSupportTimeTxt = slot0.worldBtn:Find(&quot;requested/Text&quot;):GetComponent(typeof(Text))
	slot0.timers = {}
end

slot0.OnInit = function(slot0)
	onButton(slot0, slot0._tf, function ()
		uv0:Hide()
	end, SFX_PANEL)
	onButton(slot0, slot0:findTF(&quot;cancel_btn&quot;), function ()
		uv0:Hide()
	end, SFX_PANEL)
	onButton(slot0, slot0:findTF(&quot;window/top/btnBack&quot;), function ()
		uv0:Hide()
	end, SFX_PANEL)
	onButton(slot0, slot0.friendBtn, function ()
		uv0.friendFlag = not uv0.friendFlag

		setActive(uv0.friendMark, uv0.friendFlag)
	end, SFX_PANEL)
	onButton(slot0, slot0.guildBtn, function ()
		uv0.guildFlag = not uv0.guildFlag

		setActive(uv0.guildMark, uv0.guildFlag)
	end, SFX_PANEL)
	onButton(slot0, slot0.worldBtn, function ()
		if nowWorld():GetBossProxy():WorldSupported() then
			pg.TipsMgr:GetInstance():ShowTips(i18n(&quot;world_boss_ask_help&quot;))

			return
		end

		uv0.worldFlag = not uv0.worldFlag

		setActive(uv0.worldMark, uv0.worldFlag)
	end, SFX_PANEL)
	onButton(slot0, slot0:findTF(&quot;confirm_btn&quot;), function ()
		uv0:emit(WorldBossMediator.ON_SURPPORT, {
			uv0.friendFlag,
			uv0.guildFlag,
			uv0.worldFlag
		})
		uv0:Hide()
	end, SFX_PANEL)
end

slot0.Reset = function(slot0)
	slot0.friendFlag = false
	slot0.guildFlag = false
	slot0.worldFlag = false
end

slot0.Update = function(slot0, slot1)
	slot0.boss = slot1

	slot0:Reset()
	slot0:UpdateFriendRequestItem()
	slot0:UpdateGuildRequetItem()
	slot0:UpdateWorldRequetItem()
	slot0:Show()
end

slot0.UpdateFriendRequestItem = function(slot0)
	slot1 = slot0.boss
	slot3 = nowWorld():GetBossProxy():FriendSupported()

	setButtonEnabled(slot0.friendBtn, not slot3)
	setActive(slot0.friendRequested, slot3)
	setActive(slot0.friendMark, false)
	slot0:RemoveRequestTimer(slot0.friendSupportTimeTxt)

	if slot3 then
		slot0:AddRequestTimer(slot2:GetNextFriendSupportTime(), slot0.friendSupportTimeTxt, function ()
			uv0:UpdateFriendRequestItem()
		end)
	end
end

slot0.UpdateGuildRequetItem = function(slot0)
	slot1 = slot0.boss
	slot3 = nowWorld():GetBossProxy():GuildSupported()

	setButtonEnabled(slot0.guildBtn, not slot3)
	setActive(slot0.guildRequested, slot3)
	setActive(slot0.guildMark, false)
	slot0:RemoveRequestTimer(slot0.guildSupportTimeTxt)

	if slot3 then
		slot0:AddRequestTimer(slot2:GetNextGuildSupportTime(), slot0.guildSupportTimeTxt, function ()
			uv0:UpdateGuildRequetItem()
		end)
	end
end

slot0.UpdateWorldRequetItem = function(slot0)
	slot2 = nowWorld():GetBossProxy():WorldSupported()

	setActive(slot0.worldRequested, slot2)
	setActive(slot0.worldMark, false)
	slot0:RemoveRequestTimer(slot0.worldSupportTimeTxt)

	if slot2 then
		slot0:AddRequestTimer(slot1:GetNextWorldSupportTime(), slot0.worldSupportTimeTxt, function ()
			uv0:UpdateWorldRequetItem()
		end)
	end
end

slot0.AddRequestTimer = function(slot0, slot1, slot2, slot3)
	slot4 = nowWorld():GetBossProxy()
	slot0.timers[slot2] = Timer.New(function ()
		if uv0 - pg.TimeMgr.GetInstance():GetServerTime() &gt; 0 then
			uv1.text = pg.TimeMgr.GetInstance():DescCDTime(slot1)
		else
			uv1.text = &quot;&quot;

			uv2:RemoveRequestTimer(uv1)
			uv3()
		end
	end, 1, -1)

	slot0.timers[slot2]:Start()
	slot0.timers[slot2].func()
end

slot0.RemoveRequestTimer = function(slot0, slot1)
	if slot0.timers[slot1] then
		slot0.timers[slot1]:Stop()

		slot0.timers[slot1] = nil
	end
end

slot0.RemoveRequestTimers = function(slot0)
	for slot4, slot5 in pairs(slot0.timers) do
		slot5:Stop()
	end

	slot0.timers = {}
end

slot0.Show = function(slot0)
	uv0.super.Show(slot0)
	pg.UIMgr.GetInstance():BlurPanel(slot0._tf)
end

slot0.Hide = function(slot0)
	uv0.super.Hide(slot0)
	pg.UIMgr.GetInstance():UnblurPanel(slot0._tf, slot0._parentTf)
end

slot0.OnDestroy = function(slot0)
	slot0:Hide()
	slot0:RemoveRequestTimers()
end

return slot0
</code></pre>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-lua.min.js"></script>
</body>
</html>