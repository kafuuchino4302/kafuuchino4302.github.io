<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>backyarddecorationmsgbox.lua</title>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
</head>
<body>
    <h1>backyarddecorationmsgbox.lua</h1>
    <a href="index.html">返回主页</a>
    <pre><code class="language-lua">slot0 = class(&quot;BackYardDecorationMsgBox&quot;, import(&quot;....base.BaseSubView&quot;))

slot0.getUIName = function(slot0)
	return &quot;BackYardDecorationMsgBox&quot;
end

slot0.OnLoaded = function(slot0)
	slot0.frame = slot0:findTF(&quot;frame&quot;)
	slot0.cancelBtn = slot0:findTF(&quot;frame/control/cancel_btn&quot;)
	slot0.deleteBtn = slot0:findTF(&quot;frame/control/delete_btn&quot;)
	slot0.saveBtn = slot0:findTF(&quot;frame/control/save_btn&quot;)
	slot0.applyBtn = slot0:findTF(&quot;frame/control/set_btn&quot;)
	slot0.input = slot0:findTF(&quot;frame/bound/input&quot;)
	slot0.inputField = slot0:findTF(&quot;frame/bound/input/InputField&quot;)
	slot0.desc = slot0:findTF(&quot;frame/bound/desc&quot;):GetComponent(typeof(Text))
	slot0.icon = slot0:findTF(&quot;frame/bound/mask/Icon&quot;):GetComponent(typeof(Image))
	slot0.iconRaw = slot0:findTF(&quot;frame/bound/mask/Icon_raw&quot;):GetComponent(typeof(RawImage))
	slot0.title = slot0:findTF(&quot;frame/title&quot;):GetComponent(typeof(Text))
	slot0.closeBtn = slot0:findTF(&quot;frame/close&quot;)
	slot0.innerMsgbox = slot0:findTF(&quot;msg&quot;)
	slot0.innerMsgboxContent = slot0.innerMsgbox:Find(&quot;bound/Text&quot;):GetComponent(typeof(Text))
	slot0.innerMsgboxComfirmBtn = slot0.innerMsgbox:Find(&quot;btns/btn1&quot;)
	slot0.innerMsgboxCancelBtn = slot0.innerMsgbox:Find(&quot;btns/btn2&quot;)
	slot0.innerCloseBtn = slot0:findTF(&quot;msg/close&quot;)
	slot0.scrollTitleText = slot0.innerMsgbox:Find(&quot;bound/title&quot;):GetComponent(typeof(Text))
	slot0.scrollText = slot0.innerMsgbox:Find(&quot;bound/scrollrect/Text&quot;):GetComponent(typeof(Text))

	setText(slot0.cancelBtn:Find(&quot;Text&quot;), i18n(&quot;word_cancel&quot;))
	setText(slot0.deleteBtn:Find(&quot;Text&quot;), i18n(&quot;word_delete&quot;))
	setText(slot0.saveBtn:Find(&quot;Text&quot;), i18n(&quot;word_save&quot;))
	setText(slot0.applyBtn:Find(&quot;Text&quot;), i18n(&quot;backyard_theme_word_apply&quot;))
	setText(slot0.innerMsgboxComfirmBtn:Find(&quot;Text&quot;), i18n(&quot;word_ok&quot;))
	setText(slot0.innerMsgboxCancelBtn:Find(&quot;Text&quot;), i18n(&quot;word_cancel&quot;))
	setText(slot0.inputField:Find(&quot;Placeholder&quot;), i18n(&quot;enter_theme_name&quot;))
end

slot0.OnInit = function(slot0)
	onButton(slot0, slot0._tf, function ()
		if uv0.showInnerMsg then
			uv0:HideInnerMsgBox()
		else
			uv0:Hide()
		end
	end, SFX_PANEL)
	onButton(slot0, slot0.closeBtn, function ()
		uv0:Hide()
	end, SFX_PANEL)
	onButton(slot0, slot0.innerCloseBtn, function ()
		uv0:HideInnerMsgBox()
	end, SFX_PANEL)
	onButton(slot0, slot0.cancelBtn, function ()
		uv0:Hide()
	end, SFX_PANEL)
	onButton(slot0, slot0.deleteBtn, function ()
		if uv0.theme:IsPushed() then
			slot0 = uv0

			slot0:ShowInnerMsgBox(i18n(&quot;backyard_decoration_theme_template_delete_tip&quot;), function ()
				uv0:emit(BackYardDecorationMediator.DELETE_THEME, uv0.theme.id)
				uv0:Hide()
			end, true)
		else
			uv0:emit(BackYardDecorationMediator.DELETE_THEME, uv0.theme.id)
			uv0:Hide()
		end
	end, SFX_PANEL)
	onButton(slot0, slot0.saveBtn, function ()
		if wordVer(getInputText(uv0.inputField)) &gt; 0 then
			pg.TipsMgr.GetInstance():ShowTips(i18n(&quot;backyard_theme_name_forbid&quot;))

			return
		end

		uv0:emit(BackYardDecorationMediator.SAVE_THEME, uv0.theme.id, slot0)
		uv0:Hide()
	end, SFX_PANEL)
	onButton(slot0, slot0.applyBtn, function ()
		slot0 = function(slot0)
		end

		slot1 = uv0

		slot1:emit(BackYardDecorationMediator.APPLY_THEME, uv0.theme, function (slot0, slot1)
			gcAll(false)

			if slot0 then
				uv0:emit(BackYardDecorationMediator.ADD_FURNITURES, uv0.theme.id, slot1, uv1)
				uv0:Hide()
			else
				slot2 = uv0
				slot6 = uv0.theme

				slot2:ShowInnerMsgBox(i18n(&quot;backyarad_theme_replace&quot;, slot6:getName()), function ()
					uv0:emit(BackYardDecorationMediator.ADD_FURNITURES, uv0.theme.id, uv1, uv2)
					uv0:HideInnerMsgBox()
					uv0:Hide()
				end)
			end
		end)
	end, SFX_PANEL)
	onInputChanged(slot0, slot0.inputField, function ()
		if not uv0.unEmpty then
			setText(uv0.desc, i18n(&quot;backyard_theme_save_tip&quot;))
		end
	end)
end

slot0.Show = function(slot0, slot1, slot2)
	uv0.super.Show(slot0)

	slot0.theme = slot1
	slot0.unEmpty = slot2

	if slot2 then
		slot0:ApplyTheme()
	else
		slot0:NewTheme()
	end

	slot0.title.text = slot2 and slot1:IsSystem() and i18n(&quot;courtyard_label_system_theme&quot;) or i18n(&quot;courtyard_label_custom_theme&quot;)

	setActive(slot0.frame, true)
	setActive(slot0._tf, true)
	setActive(slot0.innerMsgbox, false)
	setActive(slot0.input, not slot2)
	setActive(slot0.cancelBtn, not slot2)
	setActive(slot0.deleteBtn, slot2 and not slot1:IsSystem())
	setActive(slot0.applyBtn, slot2)
	setActive(slot0.saveBtn, not slot2)
	slot0._tf:SetAsLastSibling()
end

slot0.RemoveSizeTag = function(slot0, slot1)
	return string.gsub(string.gsub(slot1, &quot;&lt;/size&gt;&quot;, &quot;&quot;), &quot;&lt;size=%d+&gt;&quot;, &quot;&quot;)
end

slot0.ApplyTheme = function(slot0)
	slot1 = slot0.theme
	slot0.desc.text = i18n(&quot;backyard_theme_set_tip&quot;, slot1:getName())

	if not slot1:IsSystem() and (BackYardThemeTempalteUtil.FileExists(slot1:GetTextureIconName()) or slot1:IsPushed()) then
		setActive(slot0.iconRaw.gameObject, false)
		setActive(slot0.icon.gameObject, false)
		BackYardThemeTempalteUtil.GetTexture(slot1:GetTextureIconName(), slot1:GetIconMd5(), function (slot0)
			if not IsNil(uv0.iconRaw) and slot0 then
				setActive(uv0.iconRaw.gameObject, true)

				uv0.iconRaw.texture = slot0
			end
		end)
	else
		setActive(slot0.iconRaw.gameObject, false)
		setActive(slot0.icon.gameObject, true)

		slot0.icon.sprite = LoadSprite(&quot;furnitureicon/&quot; .. slot1:getIcon())
	end
end

slot0.NewTheme = function(slot0)
	slot2 = slot0.theme.id

	setInputText(slot0.inputField, i18n(&quot;backyard_theme_defaultname&quot;) .. slot2)

	slot0.desc.text = i18n(&quot;backyard_theme_save_tip&quot;, i18n(&quot;backyard_theme_defaultname&quot;) .. slot2)
	slot0.icon.sprite = LoadSprite(&quot;furnitureicon/default_theme&quot;)

	setActive(slot0.iconRaw.gameObject, false)
	setActive(slot0.icon.gameObject, true)
end

slot0.ShowInnerMsgBox = function(slot0, slot1, slot2, slot3, slot4)
	setActive(slot0.frame, false)
	setActive(slot0.innerMsgbox, true)
	setActive(slot0.innerMsgboxCancelBtn, slot3)

	if slot4 then
		slot0.innerMsgboxContent.text = &quot;&quot;
		slot0.scrollTitleText.text = slot4
		slot0.scrollText.text = slot1
	else
		slot0.scrollTitleText.text = &quot;&quot;
		slot0.scrollText.text = &quot;&quot;
		slot0.innerMsgboxContent.text = slot1
	end

	onButton(slot0, slot0.innerMsgboxComfirmBtn, function ()
		if uv0 then
			uv0()
		end
	end, SFX_PANEL)

	if slot3 then
		onButton(slot0, slot0.innerMsgboxCancelBtn, function ()
			setActive(uv0.innerMsgbox, false)
			setActive(uv0.frame, true)
		end, SFX_PANEL)
	end

	slot0.showInnerMsg = true
end

slot0.HideInnerMsgBox = function(slot0)
	setActive(slot0.frame, true)
	setActive(slot0.innerMsgbox, false)

	slot0.showInnerMsg = false
end

slot0.OnDestroy = function(slot0)
	if not IsNil(slot0.iconRaw.texture) then
		Object.Destroy(slot0.iconRaw.texture)

		slot0.iconRaw.texture = nil
	end
end

return slot0
</code></pre>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-lua.min.js"></script>
</body>
</html>