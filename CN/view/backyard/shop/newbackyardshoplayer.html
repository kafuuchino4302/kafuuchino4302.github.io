<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>newbackyardshoplayer.lua</title>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
</head>
<body>
    <h1>newbackyardshoplayer.lua</h1>
    <a href="index.html">返回主页</a>
    <pre><code class="language-lua">slot0 = class(&quot;NewBackYardShopLayer&quot;, import(&quot;...base.BaseUI&quot;))
slot1 = 1
slot2 = 2
slot3 = 3
slot4 = 4
slot5 = 5
slot6 = 6
slot7 = 7
slot8 = {
	&quot;word_theme&quot;,
	&quot;word_wallpaper&quot;,
	&quot;word_floorpaper&quot;,
	&quot;word_furniture&quot;,
	&quot;word_shipskin&quot;,
	&quot;word_decorate&quot;,
	&quot;word_wall&quot;
}

slot9 = function(slot0)
	return i18n(uv0[slot0])
end

slot10 = function(slot0, slot1, slot2)
	onButton(slot0, slot1, function ()
		if not uv0() then
			return
		end

		if uv1.btn then
			uv2(uv1.btn, false)
		end

		uv2(uv3, true)

		uv1.btn = uv3
	end, SFX_PANEL)
	(function (slot0, slot1)
		setActive(slot0:Find(&quot;sel&quot;), slot1)
		setActive(slot0:Find(&quot;unsel&quot;), not slot1)
	end)(slot1, false)
end

slot0.forceGC = function(slot0)
	return true
end

slot0.getUIName = function(slot0)
	return &quot;NewBackYardShopUI&quot;
end

slot0.SetDorm = function(slot0, slot1)
	slot0.dorm = slot1
end

slot0.SetPlayer = function(slot0, slot1)
	slot0.player = slot1
end

slot0.PlayerUpdated = function(slot0, slot1)
	slot0:SetPlayer(slot1)
	slot0:UpdateRes()

	if slot0.pageType then
		slot0.pages[slot0.pageType]:ExecuteAction(&quot;PlayerUpdated&quot;, slot1)
	end
end

slot0.DormUpdated = function(slot0, slot1)
	slot0:SetDorm(slot1)

	if slot0.pageType then
		slot0.pages[slot0.pageType]:ExecuteAction(&quot;DormUpdated&quot;, slot1)
	end
end

slot0.FurnituresUpdated = function(slot0, slot1)
	if slot0.pageType then
		slot0.pages[slot0.pageType]:ExecuteAction(&quot;FurnituresUpdated&quot;, slot1)
	end
end

slot0.init = function(slot0)
	slot0.pageContainer = slot0:findTF(&quot;pages&quot;)
	slot0.adpter = slot0:findTF(&quot;adpter&quot;)
	slot0.btnTpl = slot0:findTF(&quot;adpter/tag/list/tpl&quot;)
	slot0.btnContainer = slot0:findTF(&quot;adpter/tag/list&quot;)
	slot0.backBtn = slot0:findTF(&quot;adpter/top/fanhui&quot;)
	slot0.goldTxt = slot0:findTF(&quot;adpter/top/res_gold/Text&quot;):GetComponent(typeof(Text))
	slot1 = slot0:findTF(&quot;adpter/top/res_gem/Text&quot;)
	slot0.gemTxt = slot1:GetComponent(typeof(Text))
	slot0.goldAddBtn = slot0:findTF(&quot;adpter/top/res_gold/jiahao&quot;)
	slot0.gemAddBtn = slot0:findTF(&quot;adpter/top/res_gem/jiahao&quot;)
	slot0.help = slot0:findTF(&quot;adpter/top/help&quot;)
	slot0.themePage = BackYardThemePage.New(slot0.pageContainer, slot0.event, slot0.contextData)
	slot0.furniturePage = BackYardFurniturePage.New(slot0.pageContainer, slot0.event, slot0.contextData)
	slot0.contextData.filterPanel = BackYardShopFilterPanel.New(slot0._tf, slot0.event, slot0.contextData)
	slot0.pages = {
		[uv0] = slot0.themePage,
		[uv1] = slot0.furniturePage,
		[uv2] = slot0.furniturePage,
		[uv3] = slot0.furniturePage,
		[uv4] = slot0.furniturePage,
		[uv5] = slot0.furniturePage,
		[uv6] = slot0.furniturePage
	}
	slot0.contextData.furnitureMsgBox = BackYardFurnitureMsgBoxPage.New(slot0._tf, slot0.event)
	slot0.contextData.themeMsgBox = BackYardThemeMsgBoxPage.New(slot0._tf, slot0.event)
	slot0.contextData.themeAllMsgBox = BackYardThemeMsgBoxForAllPage.New(slot0._tf, slot0.event)
end

slot0.didEnter = function(slot0)
	onButton(slot0, slot0.backBtn, function ()
		if uv0.contextData.onDeattch then
			uv0.contextData.onDeattch()
		end

		uv0:emit(uv1.ON_CLOSE)
	end, SFX_CANCEL)
	onButton(slot0, slot0.help, function ()
		uv0:emit(uv1.ON_HOME)
	end, SFX_PANEL)
	onButton(slot0, slot0.goldAddBtn, function ()
		uv0:emit(NewBackYardShopMediator.ON_CHARGE, PlayerConst.ResDormMoney)
	end, SFX_PANEL)
	onButton(slot0, slot0.gemAddBtn, function ()
		uv0:emit(NewBackYardShopMediator.ON_CHARGE, PlayerConst.ResDiamond)
	end, SFX_PANEL)
	slot0:InitPageFooter()
	slot0:UpdateRes()
	triggerButton(slot0.btns[slot0.contextData.page or uv1])

	if slot0.contextData.topLayer then
		slot2 = GetOrAddComponent(slot0._tf, typeof(Canvas))
		slot2.overrideSorting = true
		slot2.sortingOrder = 900

		GetOrAddComponent(slot0._tf, typeof(GraphicRaycaster))
	end

	getProxy(SettingsProxy):UpdateNewThemeValue()
end

slot0.UpdateRes = function(slot0)
	slot0.goldTxt.text = slot0.player:getResource(PlayerConst.ResDormMoney)
	slot0.gemTxt.text = slot0.player:getTotalGem()
end

slot11 = {
	&quot;0&quot;,
	&quot;1&quot;,
	&quot;4&quot;,
	&quot;2&quot;,
	&quot;8&quot;,
	&quot;3&quot;,
	&quot;6&quot;,
	&quot;7&quot;
}

slot0.InitPageFooter = function(slot0)
	slot0.btns = {}

	for slot4, slot5 in ipairs(slot0.pages) do
		slot6 = cloneTplTo(slot0.btnTpl, slot0.btnContainer)
		slot7 = slot6:Find(&quot;unsel&quot;)
		slot7 = slot7:GetComponent(typeof(Image))
		slot7.sprite = GetSpriteFromAtlas(&quot;ui/NewBackYardShopUI_atlas&quot;, &quot;text_tag&quot; .. slot4 - 1)

		slot7:SetNativeSize()

		slot8 = slot6:Find(&quot;sel/Text&quot;)
		slot8 = slot8:GetComponent(typeof(Image))
		slot8.sprite = GetSpriteFromAtlas(&quot;ui/NewBackYardShopUI_atlas&quot;, &quot;text_tag&quot; .. slot4 - 1)

		slot8:SetNativeSize()

		slot10 = slot6:Find(&quot;sel/icon&quot;)
		slot10 = slot10:GetComponent(typeof(Image))

		LoadSpriteAtlasAsync(&quot;ui/CourtyardUI_atlas&quot;, &quot;icon_&quot; .. uv0[slot4], function (slot0)
			if uv0.exited then
				return
			end

			uv1.sprite = slot0
		end)
		uv1(slot0, slot6, function ()
			if uv0.pageType == uv1 then
				return
			end

			if uv0.pageType and not uv0.pages[uv0.pageType]:GetLoaded() then
				return
			end

			if uv0.pageType and uv0.pages[uv0.pageType] ~= uv2 then
				uv0.pages[uv0.pageType]:Hide()
			end

			slot0 = uv2

			slot0:ExecuteAction(&quot;SetUp&quot;, uv1, uv0.dorm, uv0.player, function ()
			end)

			uv0.pageType = uv1

			if uv1 == 5 then
				getProxy(SettingsProxy):UpdateNewGemFurnitureValue()
				uv0:UpdateSpecialPageFooter()
			end

			return true
		end)

		slot0.btns[slot4] = slot6
	end

	slot0:UpdateSpecialPageFooter()
	setActive(slot0.btnTpl, false)
end

slot0.UpdateSpecialPageFooter = function(slot0)
	setActive(slot0.btns[5]:Find(&quot;new&quot;), getProxy(SettingsProxy):IsTipNewGemFurniture())
end

slot0.willExit = function(slot0)
	slot0.isOverlay = false

	slot0.contextData.filterPanel:Destroy()
	slot0.themePage:Destroy()
	slot0.furniturePage:Destroy()
	slot0.contextData.furnitureMsgBox:Destroy()

	slot0.contextData.furnitureMsgBox = nil

	slot0.contextData.themeMsgBox:Destroy()

	slot0.contextData.themeMsgBox = nil
end

return slot0
</code></pre>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-lua.min.js"></script>
</body>
</html>