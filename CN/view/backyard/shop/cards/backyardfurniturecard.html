<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>backyardfurniturecard.lua</title>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
</head>
<body>
    <h1>backyardfurniturecard.lua</h1>
    <a href="index.html">返回主页</a>
    <pre><code class="language-lua">slot0 = class(&quot;BackYardFurnitureCard&quot;)

slot0.Ctor = function(slot0, slot1)
	slot0._go = slot1
	slot0._tf = slot1.transform
	slot0.group = slot0._tf:GetComponent(typeof(CanvasGroup))
	slot0.icon = findTF(slot0._tf, &quot;icon&quot;):GetComponent(typeof(Image))
	slot0.comfortableTF = findTF(slot0._tf, &quot;comfortable&quot;)
	slot0.comfortable = findTF(slot0._tf, &quot;comfortable&quot;):GetComponent(typeof(Text))
	slot0.name = findTF(slot0._tf, &quot;name&quot;):GetComponent(typeof(Text))
	slot0.themeName = findTF(slot0._tf, &quot;theme&quot;):GetComponent(typeof(Text))
	slot0.desc = findTF(slot0._tf, &quot;desc&quot;):GetComponent(typeof(Text))
	slot0.resGold = findTF(slot0._tf, &quot;res/gold&quot;)
	slot0.resGoldTxt = findTF(slot0._tf, &quot;res/gold/Text&quot;):GetComponent(typeof(Text))
	slot0.resGemTxt = findTF(slot0._tf, &quot;res/gem/Text&quot;):GetComponent(typeof(Text))
	slot0.resGem = findTF(slot0._tf, &quot;res/gem&quot;)
	slot0.cantPurchase = findTF(slot0._tf, &quot;res/unopen&quot;)
	slot0.countTxt = findTF(slot0._tf, &quot;count&quot;):GetComponent(typeof(Text))
	slot0.maskTF = findTF(slot0._tf, &quot;mask&quot;)
	slot0.hotTF = findTF(slot0._tf, &quot;hot&quot;)
	slot0.newTF = findTF(slot0._tf, &quot;new&quot;)
	slot0.skinMark = findTF(slot0._tf, &quot;skin_mark&quot;)
	slot0.maskUnOpen = findTF(slot0._tf, &quot;mask1&quot;)
	slot0.countDownTm = findTF(slot0._tf, &quot;time/Text&quot;):GetComponent(typeof(Text))
	slot0.timerTr = findTF(slot0._tf, &quot;time&quot;)

	setActive(slot0.timerTr, false)
end

slot0.Update = function(slot0, slot1)
	if slot0.group then
		slot0.group.alpha = 1
	end

	slot0.furniture = slot1
	slot0.name.text = shortenString(HXSet.hxLan(slot1:getConfig(&quot;name&quot;)), 9)
	slot0.themeName.text = shortenString(slot1:GetThemeName(), 7)
	slot0.desc.text = HXSet.hxLan(slot1:getConfig(&quot;describe&quot;))
	slot0.comfortable.text = &quot;+&quot; .. slot1:getConfig(&quot;comfortable&quot;)

	GetSpriteFromAtlasAsync(&quot;furnitureicon/&quot; .. slot1:getConfig(&quot;icon&quot;), &quot;&quot;, function (slot0)
		if IsNil(uv0.icon) then
			return
		end

		uv0.icon.sprite = slot0
	end)

	slot0.countTxt.text = slot1:getConfig(&quot;count&quot;) &gt; 1 and slot1.count .. &quot;/&quot; .. slot3 or &quot;&quot;

	setActive(slot0.resGem, slot1:canPurchaseByGem())
	setActive(slot0.resGold, slot1:canPurchaseByDormMoeny())

	slot7 = slot1:canPurchase()

	if slot0.maskUnOpen then
		setActive(slot0.maskUnOpen, slot7 and (not slot5 and not slot6 or not slot1:inTime()))
	end

	slot0.resGoldTxt.text = slot1:getPrice(PlayerConst.ResDormMoney)
	slot0.resGemTxt.text = slot1:getPrice(PlayerConst.ResDiamond)

	setActive(slot0.maskTF, not slot7)
	setActive(slot0.hotTF, false)
	setActive(slot0.newTF, slot1:IsNew() and slot7)

	slot10, slot11 = slot1:inTime()

	if slot1:isTimeLimit() and slot10 then
		slot0:UpdateCountdown(slot11)
	else
		slot0:DestoryTimer()

		slot0.countDownTm.text = &quot;&quot;
	end

	setActive(slot0.timerTr, slot13)
	slot0:UpdateSkinType()
end

slot0.UpdateSkinType = function(slot0)
	if IsNil(slot0.skinMark) then
		return
	end

	setActive(slot0.skinMark, Goods.ExistFurniture(Goods.FurnitureId2Id(slot0.furniture.id)))
end

slot0.UpdateCountdown = function(slot0, slot1)
	slot0:DestoryTimer()

	slot3 = pg.TimeMgr.GetInstance():Table2ServerTime(slot1)
	slot0.prevStr = &quot;&quot;
	slot0.updateTimer = Timer.New(function ()
		slot0 = &quot;&quot;

		if uv1 &lt; uv0:GetServerTime() then
			uv2.countDownTm.text = &quot;&quot;

			setActive(uv2.timerTr, false)
			uv2:DestoryTimer()

			return
		end

		if uv1 - slot1 &lt; 0 then
			slot2 = 0
		end

		if (math.floor(slot2 / 86400) &gt; 0 and slot3 .. i18n(&quot;word_date&quot;) or math.floor(slot2 / 3600) &gt; 0 and slot4 .. i18n(&quot;word_hour&quot;) or math.floor(slot2 / 60) &gt; 0 and slot5 .. i18n(&quot;word_minute&quot;) or slot2 .. i18n(&quot;word_second&quot;)) ~= uv2.prevStr then
			uv2.prevStr = slot0
			uv2.countDownTm.text = slot0
		end
	end, 1, -1)

	slot0.updateTimer:Start()
	slot0.updateTimer.func()
end

slot0.DestoryTimer = function(slot0)
	if slot0.updateTimer then
		slot0.updateTimer:Stop()

		slot0.updateTimer = nil
	end
end

slot0.Clear = function(slot0)
	slot0:DestoryTimer()
end

return slot0
</code></pre>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-lua.min.js"></script>
</body>
</html>