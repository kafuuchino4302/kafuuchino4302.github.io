<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>medaldetailpanel.lua</title>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
</head>
<body>
    <h1>medaldetailpanel.lua</h1>
    <a href="index.html">返回主页</a>
    <pre><code class="language-lua">slot0 = class(&quot;MedalDetailPanel&quot;)

slot0.SetIconScale = function(slot0, slot1)
	slot0._iconScale = Vector2.New(slot1, slot1)
end

slot0.Ctor = function(slot0, slot1, slot2)
	slot0._go = slot1
	slot0._tf = slot1.transform
	slot0._parent = slot2
	slot0.UIMgr = pg.UIMgr.GetInstance()

	pg.DelegateInfo.New(slot0)

	slot0._mask = findTF(slot0._tf, &quot;mask&quot;)
	slot0._medalIcon = findTF(slot0._tf, &quot;icon&quot;)
	slot0._medalLock = findTF(slot0._tf, &quot;lock&quot;)
	slot0._nameText = findTF(slot0._tf, &quot;name&quot;)
	slot0._descText = findTF(slot0._tf, &quot;desc&quot;)
	slot0._progressBG = findTF(slot0._tf, &quot;progress&quot;)
	slot0._progressText = findTF(slot0._tf, &quot;progress/label&quot;)
	slot0._conditionText = findTF(slot0._tf, &quot;condition&quot;)
	slot0._stateText = findTF(slot0._tf, &quot;state&quot;)
	slot0._prevBtn = findTF(slot0._tf, &quot;prevBtn&quot;)
	slot0._nextBtn = findTF(slot0._tf, &quot;nextBtn&quot;)
	slot0._closeBtn = findTF(slot0._tf, &quot;backbtn&quot;)

	onButton(slot0, slot0._mask, function ()
		if uv0._parent.DETAIL_CLOSE_ANIM and uv0._parent.DETAIL_CLOSE_ANIM_Time then
			quickPlayAnimation(uv0._go, uv0._parent.DETAIL_CLOSE_ANIM)
			onDelayTick(function ()
				uv0:SetActive(false)
			end, uv0._parent.DETAIL_CLOSE_ANIM_Time)
		else
			uv0:SetActive(false)
		end
	end, SFX_CANCEL)

	if slot0._closeBtn then
		onButton(slot0, slot0._closeBtn, function ()
			if uv0._parent.DETAIL_CLOSE_ANIM and uv0._parent.DETAIL_CLOSE_ANIM_Time then
				quickPlayAnimation(uv0._go, uv0._parent.DETAIL_CLOSE_ANIM)
				onDelayTick(function ()
					uv0:SetActive(false)
				end, uv0._parent.DETAIL_CLOSE_ANIM_Time)
			else
				uv0:SetActive(false)
			end
		end, SFX_CANCEL)
	end

	onButton(slot0, slot0._prevBtn, function ()
		uv0._currentIndex = math.max(uv0._currentIndex - 1, 1)

		uv0:UpdateMedal()
	end)
	onButton(slot0, slot0._nextBtn, function ()
		uv0._currentIndex = math.min(uv0._currentIndex + 1, #uv0._medalGroup:GetMedalIds())

		uv0:UpdateMedal()
	end)
end

slot0.SetMedalGroup = function(slot0, slot1)
	slot0._medalGroup = slot1
end

slot0.SetCurrentIndex = function(slot0, slot1)
	slot0._currentIndex = slot1
end

slot0.UpdateMedal = function(slot0)
	slot1 = slot0._medalGroup:GetMedalIds()[slot0._currentIndex]
	slot0._medal = slot0._medalGroup:GetMedalList()[slot1]
	slot2 = pg.activity_medal_template[slot1]

	setText(slot0._nameText, slot2.activity_medal_name)
	setText(slot0._descText, slot2.activity_medal_desc)

	if slot0._medal.timeStamp then
		LoadImageSpriteAsync(&quot;activitymedal/&quot; .. slot1, slot0._medalIcon, true)
	else
		LoadImageSpriteAsync(&quot;activitymedal/&quot; .. slot1 .. &quot;_l&quot;, slot0._medalIcon, true)
	end

	slot0._medalIcon.transform.localScale = slot0._iconScale

	SetActive(slot0._medalLock, not slot0._medal.timeStamp)

	if slot0._medal.timeStamp then
		setText(slot0._conditionText, i18n(&quot;word_gain_date&quot;) .. pg.TimeMgr.GetInstance():CTimeDescC(slot0._medal.timeStamp, &quot;%Y/%m/%d&quot;))
		setText(slot0._progressText, i18n(&quot;word_unlock&quot;))
	else
		setText(slot0._conditionText, pg.task_data_template[slot2.task_id].desc)
		setText(slot0._progressText, i18n(&quot;word_lock&quot;))
	end

	if findTF(slot0._tf, &quot;progress/lock&quot;) then
		SetActive(slot3, not slot0._medal.timeStamp)
	end

	if slot0._medalGroup:GetMedalGroupState() == ActivityMedalGroup.STATE_EXPIRE then
		setText(slot0._stateText, setColorStr(i18n(&quot;word_cant_gain_anymore&quot;), &quot;#73757f&quot;))
	elseif slot4 == ActivityMedalGroup.STATE_CLOSE then
		setText(slot0._stateText, setColorStr(i18n(&quot;word_activity_not_open&quot;), &quot;#ed4646&quot;))
	end

	SetActive(slot0._stateText, slot4 ~= ActivityMedalGroup.STATE_ACTIVE)
	SetActive(slot0._prevBtn, slot0._currentIndex ~= 1)
	SetActive(slot0._nextBtn, slot0._currentIndex ~= #slot0._medalGroup:GetMedalIds())
end

slot0.SetActive = function(slot0, slot1)
	SetActive(slot0._go, slot1)

	slot0._active = slot1

	if slot1 then
		pg.UIMgr.GetInstance():BlurPanel(slot0._go, false, {
			weight = LayerWeightConst.SECOND_LAYER
		})
	else
		pg.UIMgr.GetInstance():UnblurPanel(slot0._go, slot0._parent._tf)
	end
end

slot0.IsActive = function(slot0)
	return slot0._active
end

slot0.Dispose = function(slot0)
	pg.DelegateInfo.Dispose(slot0)
end

return slot0
</code></pre>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-lua.min.js"></script>
</body>
</html>