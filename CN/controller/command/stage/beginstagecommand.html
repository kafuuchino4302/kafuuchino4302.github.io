<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>beginstagecommand.lua</title>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
</head>
<body>
    <h1>beginstagecommand.lua</h1>
    <a href="index.html">返回主页</a>
    <pre><code class="language-lua">slot0 = class(&quot;BeginStageCommand&quot;, pm.SimpleCommand)

slot0.execute = function(slot0, slot1)
	slot2 = slot1:getBody()

	ys.Battle.BattleGate.Gates[slot2.system].Entrance(slot2, slot0)
end

slot0.RequestFailStandardProcess = function(slot0, slot1)
	if slot1.result == 10 then
		pg.TipsMgr.GetInstance():ShowTips(ERROR_MESSAGE[10])
	else
		pg.TipsMgr.GetInstance():ShowTips(errorTip(&quot;stage_beginStage&quot;, slot1.result))
		slot0:sendNotification(GAME.BEGIN_STAGE_ERRO, slot1.result)
	end
end

slot0.SendRequest = function(slot0, slot1, slot2, slot3, slot4, slot5)
	pg.ConnectionMgr.GetInstance():Send(40001, {
		system = slot0,
		ship_id_list = slot1,
		data = slot2[1],
		data2 = slot2[2],
		other_ship_id_list = slot5 or {}
	}, 40002, function (slot0)
		if slot0.result == 0 then
			uv0(slot0)
		else
			uv1(slot0)
		end
	end)
end

slot0.DockOverload = function()
	if getProxy(PlayerProxy):getData():getMaxShipBag() &lt;= getProxy(BayProxy):getShipCount() then
		NoPosMsgBox(i18n(&quot;switch_to_shop_tip_noDockyard&quot;), openDockyardClear, gotoChargeScene, openDockyardIntensify)

		return true
	end

	return false
end

slot0.LegalFleet = function(slot0)
	if getProxy(FleetProxy):getFleetById(slot0) == nil or slot2:isEmpty() then
		pg.TipsMgr.GetInstance():ShowTips(i18n(&quot;stage_beginStage_error_fleetEmpty&quot;))

		return false
	end

	slot3, slot4 = slot2:isLegalToFight()

	if slot3 ~= true then
		pg.TipsMgr.GetInstance():ShowTips(i18n(&quot;stage_beginStage_error_teamEmpty&quot;, Fleet.C_TEAM_NAME[slot3], slot4))

		return false
	end

	return true
end

slot0.ShipVertify = function()
	for slot5, slot6 in pairs(getProxy(BayProxy):getRawData()) do
		if not slot6:attrVertify() then
			BattleVertify.playerShipVertifyFail = true

			break
		end
	end
end

return slot0
</code></pre>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-lua.min.js"></script>
</body>
</html>