<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>selectfleetcommandercommand.lua</title>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
</head>
<body>
    <h1>selectfleetcommandercommand.lua</h1>
    <a href="index.html">返回主页</a>
    <pre><code class="language-lua">slot0 = class(&quot;SelectFleetCommanderCommand&quot;, pm.SimpleCommand)

slot0.execute = function(slot0, slot1)
	slot2 = slot1:getBody()
	slot5 = slot2.commanderId
	slot6 = slot2.callback
	slot7 = getProxy(FleetProxy):getFleetById(slot2.fleetId)
	slot9 = slot7:getCommanders()

	if not slot7:getCommanderByPos(slot2.pos) or slot8.id ~= slot5 then
		slot10 = getProxy(CommanderProxy):getCommanderById(slot5)

		for slot14, slot15 in pairs(slot9) do
			if slot15.groupId == slot10.groupId and slot14 ~= slot4 and slot5 ~= slot15.id then
				pg.TipsMgr.GetInstance():ShowTips(i18n(&quot;commander_can_not_select_same_group&quot;))

				return
			end
		end
	end

	slot11 = function(slot0)
		if uv1[uv0 == 2 and 1 or 2] and slot2.id == slot0 then
			return true, slot1
		end

		return false
	end

	slot12 = {}
	slot13 = true
	slot14, slot15 = (function (slot0)
		for slot5, slot6 in ipairs(getProxy(FleetProxy):getCommanders()) do
			if slot6.fleetId ~= uv0 and slot6.commanderId == slot0 then
				return true, slot6
			end
		end

		return false
	end)(slot5)

	if slot14 then
		table.insert(slot12, function (slot0)
			pg.MsgboxMgr.GetInstance():ShowMsgBox({
				content = i18n(&quot;comander_repalce_tip&quot;, Fleet.DEFAULT_NAME[uv0.fleetId], uv0.pos == 1 and i18n(&quot;commander_main_pos&quot;) or i18n(&quot;commander_assistant_pos&quot;)),
				onYes = function ()
					pg.m02:sendNotification(GAME.COOMMANDER_EQUIP_TO_FLEET, {
						commanderId = 0,
						fleetId = uv0.fleetId,
						pos = uv0.pos,
						callback = uv1
					})
				end,
				onNo = function ()
					uv0 = false

					uv1()
				end
			})
		end)
	end

	slot16, slot17 = slot11(slot5)

	if slot16 then
		table.insert(slot12, function (slot0)
			pg.m02:sendNotification(GAME.COOMMANDER_EQUIP_TO_FLEET, {
				commanderId = 0,
				fleetId = uv0,
				pos = uv1,
				callback = slot0
			})
		end)
	end

	table.insert(slot12, function (slot0)
		if uv0 then
			pg.m02:sendNotification(GAME.COOMMANDER_EQUIP_TO_FLEET, {
				fleetId = uv1,
				pos = uv2,
				commanderId = uv3,
				callback = function (slot0)
					uv0()
				end
			})
		else
			slot0()
		end
	end)
	seriesAsync(slot12, slot6)
end

return slot0
</code></pre>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-lua.min.js"></script>
</body>
</html>