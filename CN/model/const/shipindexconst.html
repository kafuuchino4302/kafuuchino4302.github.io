<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>shipindexconst.lua</title>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
</head>
<body>
    <h1>shipindexconst.lua</h1>
    <a href="index.html">返回主页</a>
    <pre><code class="language-lua">slot0 = class(&quot;ShipIndexConst&quot;)
slot0.SortRarity = bit.lshift(1, 0)
slot0.SortLevel = bit.lshift(1, 1)
slot0.SortPower = bit.lshift(1, 2)
slot0.SortAchivedTime = bit.lshift(1, 3)
slot0.SortIntimacy = bit.lshift(1, 4)
slot0.SortEnergy = bit.lshift(1, 13)
slot0.SortProperty_Cannon = bit.lshift(1, 5)
slot0.SortProperty_Air = bit.lshift(1, 6)
slot0.SortProperty_Dodge = bit.lshift(1, 7)
slot0.SortProperty_AntiAircraft = bit.lshift(1, 8)
slot0.SortProperty_Torpedo = bit.lshift(1, 9)
slot0.SortProperty_Reload = bit.lshift(1, 10)
slot0.SortProperty_Durability = bit.lshift(1, 11)
slot0.SortProperty_Antisub = bit.lshift(1, 12)
slot0.SortPropertyIndexs = {
	slot0.SortProperty_Cannon,
	slot0.SortProperty_Air,
	slot0.SortProperty_Dodge,
	slot0.SortProperty_AntiAircraft,
	slot0.SortProperty_Torpedo,
	slot0.SortProperty_Reload,
	slot0.SortProperty_Durability,
	slot0.SortProperty_Antisub
}
slot0.SortPropertyAll = IndexConst.BitAll(slot0.SortPropertyIndexs)

table.insert(slot0.SortPropertyIndexs, 1, slot0.SortPropertyAll)

slot0.SortIndexs = {
	slot0.SortRarity,
	slot0.SortLevel,
	slot0.SortPower,
	slot0.SortAchivedTime,
	slot0.SortIntimacy,
	slot0.SortEnergy
}

slot0.getSortFuncAndName = function(slot0, slot1)
	for slot5 = 1, #ShipIndexCfg.sort do
		if bit.band(bit.lshift(1, slot5 - 1), slot0) &gt; 0 then
			return underscore.map(ShipIndexCfg.sort[slot5].sortFuncs, function (slot0)
				return function (slot0)
					return (uv0 and -1 or 1) * uv1(slot0)
				end
			end), ShipIndexCfg.sort[slot5].name
		end
	end
end

slot0.SortNames = {
	&quot;word_rarity&quot;,
	&quot;word_lv&quot;,
	&quot;word_synthesize_power&quot;,
	&quot;word_achieved_item&quot;,
	&quot;attribute_intimacy&quot;,
	&quot;sort_energy&quot;
}
slot0.SortPropertyNames = {
	&quot;sort_attribute&quot;,
	&quot;word_attr_cannon&quot;,
	&quot;word_attr_air&quot;,
	&quot;word_attr_dodge&quot;,
	&quot;word_attr_antiaircraft&quot;,
	&quot;word_attr_torpedo&quot;,
	&quot;word_attr_reload&quot;,
	&quot;word_attr_durability&quot;,
	&quot;word_attr_antisub&quot;
}

slot0.sortByCombatPower = function()
	return {
		function (slot0)
			return -slot0:getShipCombatPower()
		end,
		function (slot0)
			return slot0.configId
		end
	}
end

slot0.sortByField = function(slot0)
	return {
		function (slot0)
			return -slot0[uv0]
		end,
		function (slot0)
			return -slot0:getRarity()
		end,
		function (slot0)
			return slot0.configId
		end
	}
end

slot0.sortByProperty = function(slot0)
	return {
		function (slot0)
			return -slot0:getShipProperties()[uv0]
		end,
		function (slot0)
			return slot0.configId
		end
	}
end

slot0.sortByCfg = function(slot0)
	return {
		function (slot0)
			return -(uv0 == &quot;rarity&quot; and slot0:getRarity() or slot0:getConfig(uv0))
		end,
		function (slot0)
			return slot0.configId
		end
	}
end

slot0.sortByIntimacy = function()
	return {
		function (slot0)
			return -slot0.intimacy
		end,
		function (slot0)
			return slot0.propose and 0 or 1
		end,
		function (slot0)
			return slot0.configId
		end,
		function (slot0)
			return -slot0.level
		end
	}
end

slot0.sortByEnergy = function()
	return {
		function (slot0)
			return -slot0:getEnergy()
		end,
		function (slot0)
			return slot0.configId
		end
	}
end

slot0.TypeFront = bit.lshift(1, 0)
slot0.TypeBack = bit.lshift(1, 1)
slot0.TypeQuZhu = bit.lshift(1, 2)
slot0.TypeQingXun = bit.lshift(1, 3)
slot0.TypeZhongXun = bit.lshift(1, 4)
slot0.TypeZhanLie = bit.lshift(1, 5)
slot0.TypeHangMu = bit.lshift(1, 6)
slot0.TypeWeiXiu = bit.lshift(1, 7)
slot0.TypeQianTing = bit.lshift(1, 8)
slot0.TypeOther = bit.lshift(1, 9)
slot0.TypeIndexs = {
	slot0.TypeFront,
	slot0.TypeBack,
	slot0.TypeQuZhu,
	slot0.TypeQingXun,
	slot0.TypeZhongXun,
	slot0.TypeZhanLie,
	slot0.TypeHangMu,
	slot0.TypeWeiXiu,
	slot0.TypeQianTing,
	slot0.TypeOther
}
slot0.TypeAll = IndexConst.BitAll(slot0.TypeIndexs)

table.insert(slot0.TypeIndexs, 1, slot0.TypeAll)

slot0.TypeNames = {
	&quot;index_all&quot;,
	&quot;index_fleetfront&quot;,
	&quot;index_fleetrear&quot;,
	&quot;index_shipType_quZhu&quot;,
	&quot;index_shipType_qinXun&quot;,
	&quot;index_shipType_zhongXun&quot;,
	&quot;index_shipType_zhanLie&quot;,
	&quot;index_shipType_hangMu&quot;,
	&quot;index_shipType_weiXiu&quot;,
	&quot;index_shipType_qianTing&quot;,
	&quot;index_other&quot;
}

slot0.filterByType = function(slot0, slot1)
	if not slot1 or slot1 == uv0.TypeAll then
		return true
	end

	for slot5 = 2, #ShipIndexCfg.type do
		if bit.band(bit.lshift(1, slot5 - 2), slot1) &gt; 0 then
			slot7 = ShipIndexCfg.type[slot5].types

			if slot5 &lt; 4 then
				slot8 = ShipIndexCfg.type[slot5].shipTypes

				if table.contains(slot7, slot0:getShipType()) then
					return true
				end

				if table.contains(slot7, slot0:getTeamType()) then
					return true
				end
			elseif table.contains(slot7, slot0:getShipType()) then
				return true
			end
		end
	end

	return false
end

slot1 = {
	&quot;CampUS&quot;,
	&quot;CampEN&quot;,
	&quot;CampJP&quot;,
	&quot;CampDE&quot;,
	&quot;CampCN&quot;,
	&quot;CampITA&quot;,
	&quot;CampSN&quot;,
	&quot;CampFF&quot;,
	&quot;CampMNF&quot;,
	&quot;CampNL&quot;,
	&quot;CampMETA&quot;,
	&quot;CampMot&quot;,
	&quot;CampOther&quot;
}

if LOCK_NATION_HNLMS then
	table.removebyvalue(slot1, &quot;CampNL&quot;)
end

slot0.CampIndexs = {}

for slot5, slot6 in ipairs(slot1) do
	slot0[slot6] = bit.lshift(1, slot5 - 1)

	table.insert(slot0.CampIndexs, slot0[slot6])
end

slot0.CampAll = IndexConst.BitAll(slot0.CampIndexs)

table.insert(slot0.CampIndexs, 1, slot0.CampAll)

slot0.CampNames = {
	&quot;word_shipNation_all&quot;,
	&quot;word_shipNation_baiYing&quot;,
	&quot;word_shipNation_huangJia&quot;,
	&quot;word_shipNation_chongYing&quot;,
	&quot;word_shipNation_tieXue&quot;,
	&quot;word_shipNation_dongHuang&quot;,
	&quot;word_shipNation_saDing&quot;,
	&quot;word_shipNation_beiLian&quot;,
	&quot;word_shipNation_ziyou&quot;,
	&quot;word_shipNation_weixi&quot;,
	&quot;word_shipNation_yujinwangguo&quot;,
	&quot;word_shipNation_meta_index&quot;,
	&quot;word_shipNation_mot&quot;,
	&quot;word_shipNation_other&quot;
}

if LOCK_NATION_HNLMS then
	table.removebyvalue(slot0.CampNames, &quot;word_shipNation_yujinwangguo&quot;)
end

slot0.filterByCamp = function(slot0, slot1)
	if not slot1 or slot1 == uv0.CampAll then
		return true
	end

	slot2 = underscore.to_array(ShipIndexCfg.camp)

	if LOCK_NATION_HNLMS then
		slot2 = underscore.filter(slot2, function (slot0)
			return #slot0.types ~= 1 or slot0.types[1] ~= Nation.NL
		end)
	end

	for slot6 = 2, #slot2 do
		if bit.band(bit.lshift(1, slot6 - 2), slot1) &gt; 0 then
			for slot12, slot13 in ipairs(slot2[slot6].types) do
				if slot13 == Nation.LINK then
					if Nation.LINK &lt;= slot0:getNation() then
						return true
					end
				elseif slot13 == slot0:getNation() then
					return true
				end
			end
		end
	end

	return false
end

slot0.Rarity1 = bit.lshift(1, 0)
slot0.Rarity2 = bit.lshift(1, 1)
slot0.Rarity3 = bit.lshift(1, 2)
slot0.Rarity4 = bit.lshift(1, 3)
slot0.Rarity5 = bit.lshift(1, 4)
slot0.RarityIndexs = {
	slot0.Rarity1,
	slot0.Rarity2,
	slot0.Rarity3,
	slot0.Rarity4,
	slot0.Rarity5
}
slot0.RarityAll = IndexConst.BitAll(slot0.RarityIndexs)

table.insert(slot0.RarityIndexs, 1, slot0.RarityAll)

slot0.RarityNames = {
	&quot;index_all&quot;,
	&quot;index_rare2&quot;,
	&quot;index_rare3&quot;,
	&quot;index_rare4&quot;,
	&quot;index_rare5&quot;,
	&quot;index_rare6&quot;
}

slot0.filterByRarity = function(slot0, slot1)
	if not slot1 or slot1 == uv0.RarityAll then
		return true
	end

	for slot5 = 2, #ShipIndexCfg.rarity do
		if bit.band(bit.lshift(1, slot5 - 2), slot1) &gt; 0 and table.contains(ShipIndexCfg.rarity[slot5].types, slot0:getRarity()) then
			return true
		end
	end

	return false
end

slot0.MetaRarityIndexs = {
	slot0.RarityAll,
	slot0.Rarity3,
	slot0.Rarity4
}
slot0.MetaRarityNames = {
	&quot;index_all&quot;,
	&quot;index_rare4&quot;,
	&quot;index_rare5&quot;
}
slot0.MetaExtraRepair = bit.lshift(1, 0)
slot0.MetaExtraTactics = bit.lshift(1, 1)
slot0.MetaExtraEnergy = bit.lshift(1, 2)
slot0.MetaExtraIndexs = {
	slot0.MetaExtraRepair,
	slot0.MetaExtraTactics,
	slot0.MetaExtraEnergy
}
slot0.MetaExtraAll = IndexConst.BitAll(slot0.MetaExtraIndexs)

table.insert(slot0.MetaExtraIndexs, 1, slot0.MetaExtraAll)

slot0.MetaExtraNames = {
	&quot;index_no_limit&quot;,
	&quot;index_meta_repair&quot;,
	&quot;index_meta_tactics&quot;,
	&quot;index_meta_energy&quot;
}
slot0.ExtraSkin = bit.lshift(1, 0)
slot0.ExtraRemould = bit.lshift(1, 1)
slot0.Extrastrengthen = bit.lshift(1, 2)
slot0.ExtraUpgrade = bit.lshift(1, 3)
slot0.ExtraNotMaxLv = bit.lshift(1, 4)
slot0.ExtraAwakening = bit.lshift(1, 5)
slot0.ExtraAwakening2 = bit.lshift(1, 6)
slot0.ExtraSpecial = bit.lshift(1, 7)
slot0.ExtraProposeSkin = bit.lshift(1, 8)

if not LOCK_SP_WEAPON then
	slot0.ExtraUniqueSpWeapon = bit.lshift(1, 9)
	slot0.DRESSED = bit.lshift(1, 10)
	slot0.ExtraMarry = bit.lshift(1, 11)
else
	slot0.DRESSED = bit.lshift(1, 9)
	slot0.ExtraMarry = bit.lshift(1, 10)
end

slot0.ExtraIndexs = {
	slot0.ExtraSkin,
	slot0.ExtraRemould,
	slot0.Extrastrengthen,
	slot0.ExtraUpgrade,
	slot0.ExtraNotMaxLv,
	slot0.ExtraAwakening,
	slot0.ExtraAwakening2,
	slot0.ExtraSpecial,
	slot0.ExtraProposeSkin
}

if not LOCK_SP_WEAPON then
	table.insert(slot0.ExtraIndexs, slot0.ExtraUniqueSpWeapon)
end

table.insert(slot0.ExtraIndexs, slot0.DRESSED)
table.insert(slot0.ExtraIndexs, slot0.ExtraMarry)

slot0.ExtraAll = IndexConst.BitAll(slot0.ExtraIndexs)

table.insert(slot0.ExtraIndexs, 1, slot0.ExtraAll)

slot0.ExtraNames = {
	&quot;index_no_limit&quot;,
	&quot;index_skin&quot;,
	&quot;index_reform_cw&quot;,
	&quot;index_strengthen&quot;,
	&quot;index_upgrade&quot;,
	&quot;index_not_lvmax&quot;,
	&quot;index_awakening&quot;,
	&quot;index_awakening2&quot;,
	&quot;index_special&quot;,
	&quot;index_propose_skin&quot;
}

if not LOCK_SP_WEAPON then
	slot0.ExtraNames[11] = &quot;index_spweapon&quot;
end

table.insert(slot0.ExtraNames, &quot;index_dressed&quot;)
table.insert(slot0.ExtraNames, &quot;index_marry&quot;)

slot0.filterByExtra = function(slot0, slot1)
	if not slot1 or slot1 == uv0.ExtraAll then
		return true
	end

	if slot1 == uv0.ExtraSkin then
		return slot0:hasAvailiableSkin()
	elseif slot1 == uv0.ExtraRemould then
		return slot0:isRemouldable() and not slot0:isAllRemouldFinish()
	elseif slot1 == uv0.Extrastrengthen then
		return not slot0:isMetaShip() and not slot0:isIntensifyMax()
	elseif slot1 == uv0.ExtraUpgrade then
		return slot0:canUpgrade()
	elseif slot1 == uv0.ExtraNotMaxLv then
		return slot0:notMaxLevelForFilter()
	elseif slot1 == uv0.ExtraAwakening then
		return slot0:isAwakening()
	elseif slot1 == uv0.ExtraAwakening2 then
		return slot0:isAwakening2()
	elseif slot1 == uv0.ExtraSpecial then
		return slot0:isSpecialFilter()
	elseif slot1 == uv0.ExtraProposeSkin then
		return slot0:hasProposeSkin()
	elseif slot1 == uv0.ExtraUniqueSpWeapon then
		return slot0:HasUniqueSpWeapon()
	elseif slot1 == uv0.DRESSED then
		return not slot0:IsDefaultSkin() and slot0:getRemouldSkinId() ~= slot0:getSkinId()
	elseif slot1 == uv0.ExtraMarry then
		return slot0.propose
	end

	return false
end

slot0.CollExtraSpecial = bit.lshift(1, 0)
slot0.CollExtraNotObtained = bit.lshift(1, 1)
slot0.CollExtraIndexs = {
	slot0.CollExtraSpecial,
	slot0.CollExtraNotObtained
}
slot0.CollExtraAll = IndexConst.BitAll(slot0.CollExtraIndexs)

table.insert(slot0.CollExtraIndexs, 1, slot0.CollExtraAll)

slot0.CollExtraNames = {
	&quot;index_no_limit&quot;,
	&quot;index_special&quot;,
	&quot;index_not_obtained&quot;
}

slot0.filterByCollExtra = function(slot0, slot1)
	if not slot1 or slot1 == uv0.CollExtraAll then
		return true
	end

	if slot1 == uv0.CollExtraSpecial then
		return slot0:isSpecialFilter()
	end

	if slot1 == uv0.CollExtraNotObtained then
		slot2 = slot0:getGroupId()

		if ShipGroup.getState(slot2, getProxy(CollectionProxy):getShipGroup(slot2), slot0:isRemoulded()) ~= ShipGroup.STATE_UNLOCK then
			return true
		end
	end

	return false
end

return slot0
</code></pre>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-lua.min.js"></script>
</body>
</html>