<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>instagramtopic.lua</title>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
</head>
<body>
    <h1>instagramtopic.lua</h1>
    <a href="index.html">返回主页</a>
    <pre><code class="language-lua">slot0 = class(&quot;InstagramTopic&quot;, import(&quot;..BaseVO&quot;))
slot1 = pg.activity_ins_chat_language

slot0.Ctor = function(slot0, slot1, slot2)
	slot0.topicConfig = slot1
	slot0.topicId = slot1.id
	slot0.characterId = slot1.ship_group
	slot0.name = slot1.name
	slot0.unlockDesc = slot1.unlock_desc
	slot0.triggerType = slot1.trigger_type
	slot0.triggerParam = slot1.trigger_param
	slot0.content = slot1.content

	slot0:SetWordList()

	slot0.operationTime = nil
	slot0.readFlag = 1
	slot0.replyList = nil

	if slot2 then
		slot0.active = true
		slot0.operationTime = slot2.op_time
		slot0.readFlag = slot2.read_flag
		slot0.replyList = slot2.reply_list

		slot0:SetDisplayWordList()
	else
		slot0.active = false
	end
end

slot0.SetWordList = function(slot0)
	slot0.wordList = {}

	for slot4, slot5 in ipairs(slot0.content) do
		table.insert(slot0.wordList, uv0[slot5])
	end
end

slot0.SetDisplayWordList = function(slot0)
	slot0.displayWordList = {}
	slot0.replyValues = {}

	if slot0.replyList ~= nil and #slot0.replyList &gt; 0 then
		slot2 = slot0.replyList[#slot0.replyList].key

		for slot6, slot7 in ipairs(slot0.replyList) do
			table.insert(slot0.replyValues, slot7.value)
		end

		slot3 = 999

		for slot7, slot8 in ipairs(slot0.wordList) do
			if slot8.flag == 0 or _.contains(slot0.replyValues, slot8.flag) then
				table.insert(slot0.displayWordList, slot8)
			end

			if slot8.id == slot2 then
				slot3 = slot7
			end

			if (slot8.flag == 0 or _.contains(slot0.replyValues, slot8.flag)) and slot8.option ~= &quot;&quot; and slot3 &lt; slot7 then
				break
			end
		end
	else
		for slot4, slot5 in ipairs(slot0.wordList) do
			table.insert(slot0.displayWordList, slot5)

			if slot5.option ~= &quot;&quot; then
				break
			end
		end
	end
end

slot0.GetDisplayWordList = function(slot0)
	return slot0.displayWordList
end

slot0.GetLatestCharacterWord = function(slot0)
	slot1 = nil
	slot2 = &quot;&quot;

	for slot6 = #slot0.displayWordList, 1, -1 do
		if slot0.displayWordList[slot6].ship_group ~= 0 or slot0:IsCompleted() then
			slot1 = slot0.displayWordList[slot6]

			break
		end
	end

	if slot1.type == 1 then
		slot2 = slot1.param
	elseif slot1.type == 2 then
		slot2 = &quot;&lt;color=#ff6666&gt;&quot; .. i18n(&quot;juuschat_chattip1&quot;) .. &quot;&lt;/color&gt;&quot;
	elseif slot1.type == 3 then
		slot2 = &quot;&lt;color=#ff6666&gt;&quot; .. i18n(&quot;juuschat_chattip2&quot;) .. &quot;&lt;/color&gt;&quot; .. pg.activity_ins_redpackage[tonumber(slot1.param)].desc
	elseif slot1.type == 4 then
		slot2 = string.gsub(pg.emoji_template[tonumber(slot1.param)].desc, &quot;#%w+&gt;&quot;, &quot;#28af6e&gt;&quot;)
	elseif slot1.type == 5 then
		slot3 = slot1.param

		for slot7 in string.gmatch(slot1.param, &quot;&#x27;%d+&#x27;&quot;) do
			slot3 = string.gsub(slot3, slot7, &quot;&lt;color=#46d6ff&gt;&quot; .. pg.activity_ins_ship_group_template[tonumber(string.sub(slot7, 2, #slot7 - 1))].name .. &quot;&lt;/color&gt;&quot;)
		end

		slot2 = slot3
	end

	if slot0:isWaiting() and slot1.type ~= 2 and slot1.type ~= 3 then
		slot2 = &quot;&lt;color=#ff6666&gt;&quot; .. i18n(&quot;juuschat_chattip3&quot;) .. &quot;&lt;/color&gt;&quot; .. slot2
	end

	return slot2
end

slot0.Activate = function(slot0, slot1)
	slot0.active = true
	slot0.operationTime = slot1
	slot0.readFlag = 0

	slot0:SetDisplayWordList()

	slot0.replyList = {}
end

slot0.RedPacketGotFlag = function(slot0, slot1)
	if #slot0.replyValues &gt; 0 and _.contains(slot0.replyValues, slot1) then
		return true
	end

	return false
end

slot0.isWaiting = function(slot0)
	return slot0.displayWordList[#slot0.displayWordList].option ~= &quot;&quot;
end

slot0.IsCompleted = function(slot0)
	if not slot0:isWaiting() and slot0.readFlag == 1 then
		return true
	end

	return false
end

return slot0
</code></pre>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-lua.min.js"></script>
</body>
</html>