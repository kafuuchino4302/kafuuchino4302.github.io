<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>linertime.lua</title>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
</head>
<body>
    <h1>linertime.lua</h1>
    <a href="index.html">返回主页</a>
    <pre><code class="language-lua">slot0 = class(&quot;LinerTime&quot;, import(&quot;model.vo.BaseVO&quot;))
slot0.TYPE = {
	EVENT = 3,
	STORY = 4,
	TARGET = 1,
	EXPLORE = 2
}
slot0.EVENT_SUB_TYPE = {
	STORY = 2,
	CLUE = 1
}
slot0.BG_TYPE = {
	DAY = &quot;day&quot;,
	NIGTH = &quot;night&quot;,
	AURORA = &quot;aurora&quot;,
	DUSK = &quot;dusk&quot;
}

slot0.Ctor = function(slot0, slot1)
	slot0.id = slot1
	slot0.configId = slot0.id
end

slot0.bindConfigTable = function(slot0)
	return pg.activity_liner_time
end

slot0.GetTime = function(slot0)
	return slot0:getConfig(&quot;time&quot;)
end

slot0.GetStartTimeDesc = function(slot0)
	slot3 = slot0:GetTime()[1] &lt; 12 and &quot;AM&quot; or &quot;PM&quot;

	if slot1 &gt; 12 then
		slot1 = slot1 - 12
	end

	return slot1 .. &quot;:00 &quot; .. slot3
end

slot0.GetEndTimeDesc = function(slot0)
	slot3 = slot0:GetTime()[2] &lt; 12 and &quot;AM&quot; or &quot;PM&quot;

	if slot1 &gt; 12 then
		slot1 = slot1 - 12
	end

	return slot1 .. &quot;:00 &quot; .. slot3
end

slot0.GetLogDesc = function(slot0)
	slot2 = slot0:GetTime()[2] - 1
	slot3 = slot0:GetTime()[1] &lt; 12 and &quot;AM&quot; or &quot;PM&quot;
	slot4 = slot2 &lt; 12 and &quot;AM&quot; or &quot;PM&quot;
	slot5 = slot1 &gt; 12 and slot1 - 12 or slot1

	if slot2 &gt; 12 then
		slot2 = slot2 - 12
	end

	return string.format(&quot;%d:00 %s~%d:59 %s&quot;, slot5, slot3, slot2, slot4)
end

slot0.GetType = function(slot0)
	return slot0:getConfig(&quot;type&quot;)
end

slot0.GetEventSubType = function(slot0, slot1)
	assert(slot0:GetType() == uv0.TYPE.EVENT, &quot;error type&quot;)

	slot2 = underscore.detect(slot0:GetParamInfo(), function (slot0)
		return slot0[1] == uv0
	end)

	assert(slot2, &quot;error roomId&quot;)

	return slot2[2]
end

slot0.GetParamInfo = function(slot0)
	return slot0:getConfig(&quot;param&quot;)
end

slot0.GetTargetRoomIds = function(slot0)
	switch(slot0:GetType(), {
		[uv0.TYPE.TARGET] = function ()
			table.insert(uv0, tonumber(uv1:GetParamInfo()[1]))
		end,
		[uv0.TYPE.EXPLORE] = function ()
		end,
		[uv0.TYPE.EVENT] = function ()
			for slot3, slot4 in ipairs(uv0:GetParamInfo()) do
				table.insert(uv1, slot4[1])
			end
		end,
		[uv0.TYPE.STORY] = function ()
			table.insert(uv0, tonumber(uv1:GetParamInfo()[1]))
		end
	})

	return {}
end

slot0.GetExploreCnt = function(slot0)
	if slot0:GetType() ~= uv0.TYPE.EXPLORE then
		return 0
	end

	return tonumber(slot0:GetParamInfo())
end

slot0.GetEventIds = function(slot0)
	if slot0:GetType() ~= uv0.TYPE.EVENT then
		return {}
	end

	slot1 = {}

	for slot5, slot6 in ipairs(slot0:GetParamInfo()) do
		slot1 = table.mergeArray(slot1, slot6[4], true)
	end

	return slot1
end

slot0.GetStory = function(slot0, slot1)
	switch(slot0:GetType(), {
		[uv0.TYPE.TARGET] = function ()
			uv0 = uv1:GetParamInfo()[2]
		end,
		[uv0.TYPE.EXPLORE] = function ()
		end,
		[uv0.TYPE.EVENT] = function ()
			slot1 = uv0

			if underscore.detect(slot1:GetParamInfo(), function (slot0)
				return slot0[1] == uv0
			end) and slot0[2] == uv2.EVENT_SUB_TYPE.STORY then
				uv3 = slot0[3]
			end
		end,
		[uv0.TYPE.STORY] = function ()
			uv0 = uv1:GetParamInfo()[2]
		end
	})

	return &quot;&quot;
end

slot0.GetBeforDesc = function(slot0, slot1)
	if type(slot0:getConfig(&quot;desc_before&quot;)) == &quot;table&quot; then
		return HXSet.hxLan(slot2[slot1][1])
	else
		return HXSet.hxLan(slot2)
	end
end

slot0.GetAfterDesc = function(slot0, slot1)
	if type(slot0:getConfig(&quot;desc_after&quot;)) == &quot;table&quot; then
		return HXSet.hxLan(slot2[slot1][1])
	else
		return HXSet.hxLan(slot2)
	end
end

slot0.GetBgType = function(slot0)
	return slot0:getConfig(&quot;bg_name&quot;)
end

slot0.GetBgm = function(slot0, slot1)
	switch(slot1 or slot0:GetBgType(), {
		[uv0.BG_TYPE.DAY] = function ()
			uv0 = &quot;story-niceship-soft&quot;
		end,
		[uv0.BG_TYPE.DUSK] = function ()
			uv0 = &quot;story-richang-5&quot;
		end,
		[uv0.BG_TYPE.NIGTH] = function ()
			uv0 = &quot;story-richang-10&quot;
		end,
		[uv0.BG_TYPE.AURORA] = function ()
			uv0 = &quot;story-richang-quiet&quot;
		end
	})

	return &quot;story-niceship-soft&quot;
end

return slot0
</code></pre>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-lua.min.js"></script>
</body>
</html>