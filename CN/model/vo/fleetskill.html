<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>fleetskill.lua</title>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
</head>
<body>
    <h1>fleetskill.lua</h1>
    <a href="index.html">返回主页</a>
    <pre><code class="language-lua">slot0 = class(&quot;FleetSkill&quot;, import(&quot;.BaseVO&quot;))
slot0.SystemCommanderNeko = 1
slot0.TypeMoveSpeed = &quot;move_speed&quot;
slot0.TypeHuntingLv = &quot;hunt_lv&quot;
slot0.TypeAmbushDodge = &quot;ambush_dodge&quot;
slot0.TypeAirStrikeDodge = &quot;airfight_doge&quot;
slot0.TypeStrategy = &quot;strategy&quot;
slot0.TypeBattleBuff = &quot;battle_buff&quot;
slot0.TypeAttack = &quot;attack&quot;
slot0.TypeTorpedoPowerUp = &quot;torpedo_power_up&quot;
slot0.TriggerDDHead = &quot;dd_head&quot;
slot0.TriggerAroundEnemy = &quot;around_enemy&quot;
slot0.TriggerVanCount = &quot;vang_count&quot;
slot0.TriggerNekoPos = &quot;pos&quot;
slot0.TriggerAroundLand = &quot;around_land&quot;
slot0.TriggerAroundCombatAlly = &quot;around_combat_ally&quot;
slot0.TriggerShipCount = &quot;count&quot;
slot0.TriggerInSubTeam = &quot;insubteam&quot;

slot0.Ctor = function(slot0, slot1, slot2)
	slot0.system = slot1
	slot0.id = slot2
	slot0.configId = slot0.id
end

slot0.GetSystem = function(slot0)
	return slot0.system
end

slot0.bindConfigTable = function(slot0)
	if slot0:GetSystem() == uv0.SystemCommanderNeko then
		return pg.commander_skill_effect_template
	end

	assert(false, &quot;Do not support exception.&quot;)
end

slot0.GetType = function(slot0)
	if slot0:GetSystem() == uv0.SystemCommanderNeko then
		return slot0:getConfig(&quot;effect_type&quot;)
	end

	assert(false, &quot;Do not support exception.&quot;)
end

slot0.GetArgs = function(slot0)
	if slot0:GetSystem() == uv0.SystemCommanderNeko then
		return slot0:getConfig(&quot;args&quot;)
	end

	assert(false, &quot;Do not support exception.&quot;)
end

slot0.GetTriggers = function(slot0)
	if slot0:GetSystem() == uv0.SystemCommanderNeko then
		return slot0:getConfig(&quot;condition&quot;)
	end

	assert(false, &quot;Do not support exception.&quot;)
end

slot0.triggerSkill = function(slot0, slot1)
	slot2 = _.filter(slot0:findSkills(slot1), function (slot0)
		return _.any(slot0:GetTriggers(), function (slot0)
			return slot0[1] == FleetSkill.TriggerInSubTeam and slot0[2] == 1
		end) == (uv0:getFleetType() == FleetType.Submarine) and _.all(slot0:GetTriggers(), function (slot0)
			return uv0.NoneChapterFleetCheck(uv1, uv2, slot0)
		end)
	end)

	return _.reduce(slot2, nil, function (slot0, slot1)
		slot3 = slot1:GetArgs()

		if slot1:GetType() == FleetSkill.TypeBattleBuff then
			slot0 = slot0 or {}

			table.insert(slot0, slot3[1])

			return slot0
		end
	end), slot2
end

slot0.NoneChapterFleetCheck = function(slot0, slot1, slot2)
	slot4 = getProxy(BayProxy)

	if slot2[1] == FleetSkill.TriggerDDHead then
		return #slot4:getShipByTeam(slot0, TeamType.Vanguard) &gt; 0 and ShipType.IsTypeQuZhu(slot5[1]:getShipType())
	elseif slot3 == FleetSkill.TriggerVanCount then
		return slot2[2] &lt;= #slot4:getShipByTeam(slot0, TeamType.Vanguard) and #slot5 &lt;= slot2[3]
	elseif slot3 == FleetSkill.TriggerShipCount then
		return slot2[3] &lt;= #_.filter(slot4:getShipsByFleet(slot0), function (slot0)
			return table.contains(uv0[2], slot0:getShipType())
		end) and #slot5 &lt;= slot2[4]
	elseif slot3 == FleetSkill.TriggerNekoPos then
		slot5 = slot0:findCommanderBySkillId(slot1.id)

		for slot9, slot10 in pairs(slot0:getCommanders()) do
			if slot5.id == slot10.id and slot9 == slot2[2] then
				return true
			end
		end
	elseif slot3 == FleetSkill.TriggerInSubTeam then
		return true
	else
		return false
	end
end

slot0.triggerMirrorSkill = function(slot0, slot1)
	slot2 = _.filter(slot0:findSkills(slot1), function (slot0)
		return _.any(slot0:GetTriggers(), function (slot0)
			return slot0[1] == FleetSkill.TriggerInSubTeam and slot0[2] == 1
		end) == (uv0:getFleetType() == FleetType.Submarine) and _.all(slot0:GetTriggers(), function (slot0)
			return uv0.MirrorFleetCheck(uv1, uv2, slot0)
		end)
	end)

	return _.reduce(slot2, nil, function (slot0, slot1)
		slot3 = slot1:GetArgs()

		if slot1:GetType() == FleetSkill.TypeBattleBuff then
			slot0 = slot0 or {}

			table.insert(slot0, slot3[1])

			return slot0
		end
	end), slot2
end

slot0.MirrorFleetCheck = function(slot0, slot1, slot2)
	slot4 = getProxy(BayProxy)

	if slot2[1] == FleetSkill.TriggerDDHead then
		return #slot0:getShipsByTeam(TeamType.Vanguard, false) &gt; 0 and ShipType.IsTypeQuZhu(slot5[1]:getShipType())
	elseif slot3 == FleetSkill.TriggerVanCount then
		return slot2[2] &lt;= #slot0:getShipsByTeam(TeamType.Vanguard, false) and #slot5 &lt;= slot2[3]
	elseif slot3 == FleetSkill.TriggerShipCount then
		return slot2[3] &lt;= #_.filter(slot0:getShips(false), function (slot0)
			return table.contains(uv0[2], slot0:getShipType())
		end) and #slot5 &lt;= slot2[4]
	elseif slot3 == FleetSkill.TriggerNekoPos then
		slot5 = slot0:findCommanderBySkillId(slot1.id)

		for slot9, slot10 in pairs(slot0:getCommanders()) do
			if slot5.id == slot10.id and slot9 == slot2[2] then
				return true
			end
		end
	elseif slot3 == FleetSkill.TriggerInSubTeam then
		return true
	else
		return false
	end
end

slot0.GuildBossTriggerSkill = function(slot0, slot1)
	slot2 = _.filter(slot0:findSkills(slot1), function (slot0)
		return _.any(slot0:GetTriggers(), function (slot0)
			return slot0[1] == FleetSkill.TriggerInSubTeam and slot0[2] == 1
		end) == (uv0:getFleetType() == FleetType.Submarine) and _.all(slot0:GetTriggers(), function (slot0)
			return uv0.GuildBossFleetCheck(uv1, uv2, slot0)
		end)
	end)

	return _.reduce(slot2, nil, function (slot0, slot1)
		slot3 = slot1:GetArgs()

		if slot1:GetType() == FleetSkill.TypeBattleBuff then
			slot0 = slot0 or {}

			table.insert(slot0, slot3[1])

			return slot0
		end
	end), slot2
end

slot0.GuildBossFleetCheck = function(slot0, slot1, slot2)
	if slot2[1] == FleetSkill.TriggerDDHead then
		return #slot0:GetTeamTypeShips(TeamType.Vanguard) &gt; 0 and ShipType.IsTypeQuZhu(slot4[1]:getShipType())
	elseif slot3 == FleetSkill.TriggerVanCount then
		return slot2[2] &lt;= #slot0:GetTeamTypeShips(TeamType.Vanguard) and #slot4 &lt;= slot2[3]
	elseif slot3 == FleetSkill.TriggerShipCount then
		return slot2[3] &lt;= #_.filter(slot0:GetShips(), function (slot0)
			return table.contains(uv0[2], slot0.ship:getShipType())
		end) and #slot4 &lt;= slot2[4]
	elseif slot3 == FleetSkill.TriggerNekoPos then
		slot4 = slot0:findCommanderBySkillId(slot1.id)

		for slot8, slot9 in pairs(slot0:getCommanders()) do
			if slot4.id == slot9.id and slot8 == slot2[2] then
				return true
			end
		end
	elseif slot3 == FleetSkill.TriggerInSubTeam then
		return true
	else
		return false
	end
end

return slot0
</code></pre>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-lua.min.js"></script>
</body>
</html>