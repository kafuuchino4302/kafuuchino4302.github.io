<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>dorm3dinscharroom.lua</title>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
</head>
<body>
    <h1>dorm3dinscharroom.lua</h1>
    <a href="index.html">返回主页</a>
    <pre><code class="language-lua">slot0 = class(&quot;Dorm3dInsCharRoom&quot;, import(&quot;.Dorm3dInsRoom&quot;))

slot0.Ctor = function(slot0, slot1)
	uv0.super.Ctor(slot0, slot1)

	slot0.groupId = slot0:GetConfig(&quot;character&quot;)[1]
	slot0.isCare = getProxy(Dorm3dChatProxy):GetChatCare(slot0.groupId) == 1
end

slot0.GetName = function(slot0)
	return ShipGroup.getDefaultShipNameByGroupID(slot0.groupId)
end

slot0.GetFurnitureNum = function(slot0)
	if not getProxy(ApartmentProxy):getRoom(slot0.id) then
		return 0
	end

	return #_.keys(slot1:GetFurnitures())
end

slot0.GetGiftNum = function(slot0)
	slot2 = getProxy(ApartmentProxy)

	return _.reduce(pg.dorm3d_gift.get_id_list_by_ship_group_id[slot0.groupId], 0, function (slot0, slot1)
		return slot0 + uv0:GetGiftShopCount(slot1)
	end)
end

slot0.GetLastVisit = function(slot0)
	if (getProxy(ApartmentProxy):getApartment(slot0.groupId) and slot1.visitTime or 0) == 0 then
		return i18n(&quot;dorm3d_privatechat_no_visit_time&quot;)
	end

	return math.floor((pg.TimeMgr.GetInstance():GetServerTime() - slot2) / 86400) == 0 and i18n(&quot;dorm3d_privatechat_visit_time_now&quot;) or i18n(&quot;dorm3d_privatechat_visit_time&quot;, slot3)
end

slot0.GetFavorLevel = function(slot0)
	return getProxy(ApartmentProxy):getApartment(slot0.groupId) and slot1.level or 0
end

slot0.GetCard = function(slot0)
	return string.format(&quot;dorm3dselect/apartment_skin_%d&quot;, Apartment.New({
		ship_group = slot0.groupId
	}):GetSkinModelID(slot0:GetConfig(&quot;tag&quot;)))
end

slot0.IsCare = function(slot0)
	return slot0.isCare
end

slot0.SetCare = function(slot0, slot1)
	slot0.isCare = slot1 == 1

	getProxy(Dorm3dChatProxy):SetChatCare(slot0.groupId, slot1)
end

slot0.ShouldTip = function(slot0)
	return slot0:GetInsContent() or slot0:GetChatContent() or slot0:GetChatContent()
end

slot0.GetInsContent = function(slot0)
	if slot0:IsDownloaded() and getProxy(Dorm3dInsProxy):AnyInstagramShouldTip(slot0.groupId) then
		return true, i18n(&quot;dorm3d_privatechat_new_topics&quot;, slot0:GetConfig(&quot;room&quot;))
	else
		return false, i18n(&quot;dorm3d_privatechat_nonew_topics&quot;)
	end
end

slot0.GetPhoneContent = function(slot0)
	if slot0:IsDownloaded() and getProxy(Dorm3dInsProxy):ShoudTipPhoneById(slot0.groupId) then
		return true, i18n(&quot;dorm3d_privatechat_new_calls&quot;)
	else
		return false, i18n(&quot;dorm3d_privatechat_nonew_calls&quot;)
	end
end

slot0.GetChatContent = function(slot0)
	if slot0:IsDownloaded() and getProxy(Dorm3dChatProxy):ShouldShowShipTip(slot0.groupId) then
		return true, i18n(&quot;dorm3d_privatechat_nonew_messages&quot;)
	else
		return false, i18n(&quot;dorm3d_privatechat_new_messages&quot;)
	end
end

return slot0
</code></pre>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-lua.min.js"></script>
</body>
</html>