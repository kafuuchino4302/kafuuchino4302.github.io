<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>dorm3dfurniture.lua</title>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
</head>
<body>
    <h1>dorm3dfurniture.lua</h1>
    <a href="index.html">返回主页</a>
    <pre><code class="language-lua">slot0 = class(&quot;Dorm3dFurniture&quot;, import(&quot;model.vo.BaseVO&quot;))
slot0.TYPE = {
	COUCH = 5,
	FLOOR = 2,
	DECORATION = 3,
	BED = 4,
	TABLE = 6,
	WALLPAPER = 1
}
slot0.TYPE2NAME = {
	&quot;dorm3d_furnitrue_type_wallpaper&quot;,
	&quot;dorm3d_furnitrue_type_floor&quot;,
	&quot;dorm3d_furnitrue_type_decoration&quot;,
	&quot;dorm3d_furnitrue_type_bed&quot;,
	&quot;dorm3d_furnitrue_type_couch&quot;,
	&quot;dorm3d_furnitrue_type_table&quot;
}

slot0.bindConfigTable = function(slot0)
	return pg.dorm3d_furniture_template
end

slot0.Ctor = function(slot0, slot1)
	uv0.super.Ctor(slot0, slot1)

	slot0.slotId = slot0.slotId or 0
end

slot0.GetSlotID = function(slot0)
	return slot0.slotId
end

slot0.SetSlotID = function(slot0, slot1)
	slot0.slotId = slot1
end

slot0.GetName = function(slot0)
	return slot0:getConfig(&quot;name&quot;)
end

slot0.GetType = function(slot0)
	return slot0:getConfig(&quot;type&quot;)
end

slot0.GetRarity = function(slot0)
	return slot0:getConfig(&quot;rarity&quot;)
end

slot0.GetTargetSlots = function(slot0)
	return slot0:getConfig(&quot;target_slots&quot;)
end

slot0.GetTargetSlotID = function(slot0)
	slot1 = slot0:GetTargetSlots()[1]

	assert(slot1, &quot;Missing Target Slot Dorm3dFurniture ID: &quot; .. slot0:GetConfigID())

	return slot1
end

slot0.GetIcon = function(slot0)
	return slot0:getConfig(&quot;icon&quot;)
end

slot0.GetModel = function(slot0)
	return slot0:getConfig(&quot;model&quot;)
end

slot0.GetAcesses = function(slot0)
	if slot0:getConfig(&quot;acesses&quot;) == nil or slot1 == &quot;&quot; then
		return {}
	end

	return slot1
end

slot0.GetShopID = function(slot0)
	return slot0:getConfig(&quot;shop_id&quot;)[1] or 0
end

slot0.IsValuable = function(slot0)
	return slot0:getConfig(&quot;is_exclusive&quot;) == 1
end

slot0.IsSpecial = function(slot0)
	return slot0:getConfig(&quot;is_special&quot;) == 1
end

slot0.InShopTime = function(slot0)
	if slot0:GetShopID() == 0 then
		return true
	end

	return pg.TimeMgr.GetInstance():inTime(pg.shop_template[slot1].time)
end

slot0.GetEndTime = function(slot0)
	if slot0:GetShopID() == 0 then
		return 0
	end

	assert(pg.shop_template[slot1], &quot;Missing shopCfg &quot; .. (slot1 or &quot;NIL&quot;))

	if slot2.time == &quot;always&quot; or slot3 == &quot;stop&quot; then
		return 0
	end

	return pg.TimeMgr.GetInstance():parseTimeFromConfig(slot3[2])
end

slot0.NeedViewTip = function(slot0)
	return underscore.any(slot0 and {
		getProxy(ApartmentProxy):getRoom(slot0)
	} or underscore.values(getProxy(ApartmentProxy).roomData), function (slot0)
		return underscore.any(slot0:GetFurnitures(), function (slot0)
			return Dorm3dFurniture.GetViewedFlag(slot0:GetConfigID()) == 0
		end)
	end)
end

slot0.GetViewedFlag = function(slot0)
	return PlayerPrefs.GetInt(getProxy(PlayerProxy):getRawData().id .. &quot;_dorm3dFurnitureViewed_&quot; .. slot0, 0)
end

slot0.SetViewedFlag = function(slot0)
	if uv0.GetViewedFlag(slot0) &gt; 0 then
		return
	end

	PlayerPrefs.SetInt(getProxy(PlayerProxy):getRawData().id .. &quot;_dorm3dFurnitureViewed_&quot; .. slot0, 1)
	PlayerPrefs.Save()

	return true
end

slot0.IsTimelimitShopTip = function(slot0)
	return underscore.any(slot0 and {
		getProxy(ApartmentProxy):getRoom(slot0)
	} or underscore.values(getProxy(ApartmentProxy).roomData), function (slot0)
		slot1 = slot0:GetFurnitures()

		return _.any(pg.dorm3d_furniture_template.get_id_list_by_room_id[slot0:GetConfigID()] or {}, function (slot0)
			return Dorm3dFurniture.New({
				configId = slot0
			}):GetEndTime() &gt; 0 and slot1:InShopTime() and not _.detect(uv0, function (slot0)
				return slot0:GetConfigID() == uv0
			end)
		end)
	end)
end

slot0.RecordLastTimelimitShopFurniture = function()
	slot0 = getProxy(PlayerProxy)
	slot1 = PlayerPrefs.GetInt(slot0:getRawData().id .. &quot;_dorm3dTimelimitFurniture&quot;, 0)

	underscore.each(underscore.values(getProxy(ApartmentProxy).roomData), function (slot0)
		_.each(pg.dorm3d_furniture_template.get_id_list_by_room_id[slot0:GetConfigID()] or {}, function (slot0)
			if Dorm3dFurniture.New({
				configId = slot0
			}):GetEndTime() &gt; 0 and slot1:InShopTime() then
				uv0 = math.max(uv0, slot0)
			end
		end)
	end)

	if slot1 &lt;= slot1 then
		return
	end

	PlayerPrefs.SetInt(slot0 .. &quot;_dorm3dTimelimitFurniture&quot;, slot2)
	PlayerPrefs.Save()
end

slot0.IsOnceTimelimitShopTip = function()
	slot0 = getProxy(PlayerProxy)
	slot1 = PlayerPrefs.GetInt(slot0:getRawData().id .. &quot;_dorm3dTimelimitFurniture&quot;, 0)

	return underscore.any(underscore.values(getProxy(ApartmentProxy).roomData), function (slot0)
		slot1 = slot0:GetFurnitures()

		return _.any(pg.dorm3d_furniture_template.get_id_list_by_room_id[slot0:GetConfigID()] or {}, function (slot0)
			if slot0 &lt;= uv0 then
				return
			end

			return Dorm3dFurniture.New({
				configId = slot0
			}):GetEndTime() &gt; 0 and slot1:InShopTime() and not _.detect(uv1, function (slot0)
				return slot0:GetConfigID() == uv0
			end)
		end)
	end)
end

return slot0
</code></pre>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-lua.min.js"></script>
</body>
</html>