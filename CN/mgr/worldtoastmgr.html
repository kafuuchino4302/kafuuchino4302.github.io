<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>worldtoastmgr.lua</title>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
</head>
<body>
    <h1>worldtoastmgr.lua</h1>
    <a href="index.html">返回主页</a>
    <pre><code class="language-lua">pg = pg or {}
pg.WorldToastMgr = singletonClass(&quot;WorldToastMgr&quot;)
slot0 = pg.WorldToastMgr
slot0.Type2PictrueName = {
	[0] = &quot;type_operation&quot;,
	&quot;type_fight&quot;,
	&quot;type_search&quot;,
	&quot;type_build&quot;,
	&quot;type_defience&quot;,
	&quot;type_special&quot;,
	&quot;type_collection&quot;,
	&quot;type_boss&quot;
}

slot0.Init = function(slot0, slot1)
	LoadAndInstantiateAsync(&quot;ui&quot;, &quot;WorldTaskFloatUI&quot;, function (slot0)
		uv0._go = slot0

		uv0._go:SetActive(false)

		uv0._tf = uv0._go.transform

		uv0._tf:SetParent(pg.UIMgr.GetInstance().OverlayToast, false)

		uv0.displayList = {}

		if uv1 then
			uv1()
		end
	end, true, true)
end

slot0.ShowToast = function(slot0, slot1, slot2)
	table.insert(slot0.displayList, {
		taskVO = slot1,
		isSubmitDone = slot2
	})

	if #slot0.displayList == 1 then
		slot0:StartToast()
	end
end

slot0.StartToast = function(slot0)
	setAnchoredPosition(slot0._tf, {
		y = slot0._tf.rect.height
	})
	setActive(slot0._tf, true)

	slot1 = slot0.displayList[1]

	setActive(slot0._tf:Find(&quot;accept_info&quot;), not slot1.isSubmitDone)
	setActive(slot0._tf:Find(&quot;submit_info&quot;), slot1.isSubmitDone)

	slot2 = slot1.taskVO

	GetImageSpriteFromAtlasAsync(&quot;ui/worldtaskfloatui_atlas&quot;, uv0.Type2PictrueName[slot2.config.type], slot0._tf:Find(&quot;type_icon&quot;), true)
	setText(slot0._tf:Find(&quot;desc&quot;), setColorStr(shortenString(slot2.config.name, 12), slot1.isSubmitDone and COLOR_GREEN or COLOR_WHITE))

	slot3 = {}

	table.insert(slot3, function (slot0)
		uv0.twId = LeanTween.moveY(uv0._tf, 0, 0.5):setOnComplete(System.Action(slot0))
	end)
	table.insert(slot3, function (slot0)
		uv0.twId = LeanTween.moveY(uv0._tf, uv0._tf.rect.height, 0.5):setDelay(3):setOnComplete(System.Action(slot0))
	end)
	seriesAsync(slot3, function ()
		table.remove(uv0.displayList, 1)

		if #uv0.displayList &gt; 0 then
			uv0:StartToast()
		else
			setActive(uv0._tf, false)
		end
	end)
end

slot0.Dispose = function(slot0)
	LeanTween.cancel(slot0.twId)

	slot0.displayList = nil
end
</code></pre>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-lua.min.js"></script>
</body>
</html>