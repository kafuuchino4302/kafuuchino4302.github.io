<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>trackermgr.lua</title>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
</head>
<body>
    <h1>trackermgr.lua</h1>
    <a href="index.html">返回主页</a>
    <pre><code class="language-lua">pg = pg or {}
pg.TrackerMgr = singletonClass(&quot;TrackerMgr&quot;)
slot0 = pg.TrackerMgr
TRACKING_ROLE_CREATE = &quot;role_create&quot;
TRACKING_ROLE_LOGIN = &quot;role_login&quot;
TRACKING_TUTORIAL_COMPLETE_1 = &quot;tutorial_complete_1&quot;
TRACKING_TUTORIAL_COMPLETE_2 = &quot;tutorial_complete_2&quot;
TRACKING_TUTORIAL_COMPLETE_3 = &quot;tutorial_complete_3&quot;
TRACKING_TUTORIAL_COMPLETE_4 = &quot;tutorial_complete_4&quot;
TRACKING_USER_LEVELUP = &quot;user_levelup&quot;
TRACKING_ROLE_LOGOUT = &quot;role_logout&quot;
TRACKING_PURCHASE_FIRST = &quot;purchase_first&quot;
TRACKING_PURCHASE_CLICK = &quot;purchase_click&quot;
TRACKING_PURCHASE_CLICK_MONTHLYCARD = &quot;purchase_click_monthlycard&quot;
TRACKING_PURCHASE_CLICK_GIFTBAG = &quot;purchase_click_giftbag&quot;
TRACKING_PURCHASE_CLICK_DIAMOND = &quot;purchase_click_diamond&quot;
TRACKING_PURCHASE = &quot;purchase&quot;
TRACKING_2D_RETENTION = &quot;2d_retention&quot;
TRACKING_7D_RETENTION = &quot;7d_retention&quot;
TRACKING_BUILD_SHIP = &quot;build_ship&quot;
TRACKING_SHIP_INTENSIFY = &quot;ship_intensify&quot;
TRACKING_SHIP_LEVEL_UP = &quot;ship_level_up&quot;
TRACKING_SHIP_HIGHEST_LEVEL = &quot;ship_highest_level&quot;
TRACKING_CUBE_ADD = &quot;cube_add&quot;
TRACKING_CUBE_CONSUME = &quot;cube_consume&quot;
TRACKING_USER_LEVEL_THIRTY = &quot;user_level_thirty&quot;
TRACKING_USER_LEVEL_FORTY = &quot;user_level_forty&quot;
TRACKING_PROPOSE_SHIP = &quot;propose_ship&quot;
TRACKING_REMOULD_SHIP = &quot;remould_ship&quot;
TRACKING_HARD_CHAPTER = &quot;hard_chapter&quot;
TRACKING_KILL_BOSS = &quot;kill_boss&quot;
TRACKING_HIGHEST_CHAPTER = &quot;highest_chapter&quot;
TRACKING_SHIPWORKS_COMPLETE = &quot;shipworks_complete&quot;
TRACKING_FIRST_PASS_3_4 = &quot;first_pass_3-4&quot;
TRACKING_FIRST_PASS_4_4 = &quot;first_pass_4-4&quot;
TRACKING_FIRST_PASS_5_4 = &quot;first_pass_5-4&quot;
TRACKING_FIRST_PASS_6_4 = &quot;first_pass_6-4&quot;
TRACKING_FIRST_PASS_12_4 = &quot;first_pass_12_4&quot;
TRACKING_FIRST_PASS_13_1 = &quot;first_pass_13_1&quot;
TRACKING_FIRST_PASS_13_2 = &quot;first_pass_13_2&quot;
TRACKING_FIRST_PASS_13_3 = &quot;first_pass_13_3&quot;
TRACKING_FIRST_PASS_13_4 = &quot;first_pass_13_4&quot;
TRACKING_CLASS_LEVEL_UP_8 = &quot;class_level_up_8&quot;
TRACKING_CLASS_LEVEL_UP_9 = &quot;class_level_up_9&quot;
TRACKING_CLASS_LEVEL_UP_10 = &quot;class_level_up_10&quot;
TRACKING_GUIDE_COMPLETE = &quot;stdhour1&quot;
TRACKING_EXP_LV_10 = &quot;stdlevel10&quot;
TRACKING_EXP_LV_20 = &quot;stdlevel20&quot;
TRACKING_EXP_LV_30 = &quot;stdlevel30&quot;
TRACKING_STRIKE_FAILD = &quot;stdexhausted&quot;
TRACKING_PAY_OIL = &quot;stdstaminapurchase&quot;
TRACKING_PAY_FAILD = &quot;stdrechargeprompt&quot;
TRACKING_PAY_SUCCESS = &quot;stdrecharge&quot;
TRACKING_BUILD_OR_SKIN_FAILD = &quot;stdlackofdiamonds&quot;
TRACKING_COST_300_D = &quot;stdspend300&quot;

slot0.Ctor = function(slot0)
	slot1 = nil

	if PLATFORM_CODE == PLATFORM_CH then
		slot1 = require(&quot;Mgr.Tracker.BiliTracker&quot;)
	elseif PLATFORM_CODE == PLATFORM_JP then
		slot1 = require(&quot;Mgr.Tracker.YoStarJPTracker&quot;)
	elseif PLATFORM_CODE == PLATFORM_US then
		slot1 = require(&quot;Mgr.Tracker.AiriUSTracker&quot;)
	elseif PLATFORM_CODE == PLATFORM_KR then
		slot1 = require(&quot;Mgr.Tracker.KwxyKrTracker&quot;)
	elseif PLATFORM_CODE == PLATFORM_CHT then
		slot1 = require(&quot;Mgr.Tracker.YongshiTracker&quot;)
	end

	if slot1 then
		slot0.instance = slot1.New()
	end
end

slot0.Call = function(slot0, slot1, ...)
	if slot0.instance and slot0.instance[slot1] then
		slot0.instance[slot1](slot0.instance, ...)
	end
end

slot0.Tracking = function(slot0, slot1, slot2, slot3)
	slot5 = getProxy(UserProxy) ~= nil and slot4:getData() or nil

	if (slot5 ~= nil and slot5.uid or nil) == nil then
		return
	end

	slot8 = getProxy(PlayerProxy) ~= nil and slot7:getData() or nil
	slot9 = slot8 ~= nil and slot8.id or nil

	if (slot9 ~= nil and slot9 or slot3) == nil then
		return
	end

	slot12 = getProxy(ServerProxy):getLastServer(slot6).id

	if slot1 == TRACKING_2D_RETENTION or slot1 == TRACKING_7D_RETENTION then
		if PlayerPrefs.GetInt(&quot;tracking_&quot; .. slot1, 0) &lt;= 0 then
			originalPrint(&quot;tracking type : &quot; .. slot1 .. &quot;   user_id:&quot; .. slot9)
			PlayerPrefs.SetInt(slot13, 1)
			PlayerPrefs.Save()
			slot0:Call(&quot;Tracking&quot;, slot1, slot9, slot2)
		end
	else
		originalPrint(&quot;tracking type : &quot; .. slot1 .. &quot;,   user_id:&quot; .. slot9 .. &quot;,   data:&quot; .. (slot2 or &quot;nil&quot;))
		slot0:Call(&quot;Tracking&quot;, slot1, slot9, slot2, slot12)
	end

	if slot1 == TRACKING_PURCHASE_CLICK then
		if slot2 == 1 then
			originalPrint(&quot;tracking type : &quot; .. TRACKING_PURCHASE_CLICK_MONTHLYCARD .. &quot;   user_id:&quot; .. slot9)
			slot0:Call(&quot;Tracking&quot;, TRACKING_PURCHASE_CLICK_MONTHLYCARD, slot9, slot2)
		elseif slot2 == 2 then
			originalPrint(&quot;tracking type : &quot; .. TRACKING_PURCHASE_CLICK_GIFTBAG .. &quot;   user_id:&quot; .. slot9)
			slot0:Call(&quot;Tracking&quot;, TRACKING_PURCHASE_CLICK_GIFTBAG, slot9, slot2)
		else
			originalPrint(&quot;tracking type : &quot; .. TRACKING_PURCHASE_CLICK_DIAMOND .. &quot;   user_id:&quot; .. slot9)
			slot0:Call(&quot;Tracking&quot;, TRACKING_PURCHASE_CLICK_DIAMOND, slot9, slot2)
		end
	end
end
</code></pre>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-lua.min.js"></script>
</body>
</html>