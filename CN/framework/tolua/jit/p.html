<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>p.lua</title>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
</head>
<body>
    <h1>p.lua</h1>
    <a href="index.html">返回主页</a>
    <pre><code class="language-lua">assert(require(&quot;jit&quot;).version_num == 20100, &quot;LuaJIT core/library version mismatch&quot;)

slot1 = require(&quot;jit.profile&quot;)
slot2 = require(&quot;jit.vmdef&quot;)
slot4 = pairs
slot5 = ipairs
slot6 = tonumber
slot7 = math.floor
slot8 = table.sort
slot9 = string.format
slot10 = io.stdout
slot11, slot12, slot13, slot14, slot15, slot16, slot17, slot18, slot19, slot20, slot21, slot22, slot23 = nil
slot24 = {
	G = &quot;Garbage Collector&quot;,
	C = &quot;C code&quot;,
	N = &quot;Compiled&quot;,
	J = &quot;JIT Compiler&quot;,
	I = &quot;Interpreted&quot;
}

slot25 = function(slot0, slot1, slot2)
	uv0 = uv0 + slot1
	slot3, slot4, slot5 = nil

	if uv1 then
		slot5 = uv1 == &quot;v&quot; and (uv2[slot2] or slot2) or uv3:get() or &quot;(none)&quot;
	end

	if uv4 then
		slot3 = uv5.dumpstack(slot0, uv4, uv6):gsub(&quot;%[builtin#(%d+)%]&quot;, function (slot0)
			return uv0.ffnames[uv1(slot0)]
		end)

		if uv9 == 2 then
			slot6, slot7 = slot3:match(&quot;(.-) [&lt;&gt;] (.*)&quot;)

			if slot7 then
				slot4 = slot7
				slot3 = slot6
			end
		elseif uv9 == 3 then
			slot4 = uv5.dumpstack(slot0, &quot;l&quot;, 1)
		end
	end

	slot6, slot7 = nil

	if uv9 == 1 then
		if slot5 then
			slot6 = slot5

			if slot3 then
				slot7 = slot3
			end
		end
	elseif slot3 then
		slot6 = slot3

		if slot4 then
			slot7 = slot4
		elseif slot5 then
			slot7 = slot5
		end
	end

	if slot6 then
		slot8[slot6] = (uv10[slot6] or 0) + slot1

		if slot7 then
			if not uv11[slot6] then
				slot9[slot6] = {}
			end

			if not slot10[slot7] then
				slot11 = 0
			end

			slot10[slot7] = slot11 + slot1
		end
	end
end

slot26 = function(slot0, slot1, slot2, slot3)
	slot4 = {}
	slot5 = 0

	for slot9 in uv0(slot0) do
		slot4[slot5 + 1] = slot9
	end

	uv1(slot4, function (slot0, slot1)
		return uv0[slot1] &lt; uv0[slot0]
	end)

	for slot9 = 1, slot5 do
		if uv2(slot0[slot4[slot9]] * 100 / slot2 + 0.5) &lt; uv3 then
			break
		end

		if not uv4 then
			uv5:write(uv6(&quot;%s%2d%%  %s\n&quot;, slot3, slot12, slot10))
		elseif uv4 == &quot;r&quot; then
			uv5:write(uv6(&quot;%s%5d  %s\n&quot;, slot3, slot11, slot10))
		else
			uv5:write(uv6(&quot;%s %d\n&quot;, slot10, slot11))
		end

		if slot1 and slot1[slot10] then
			uv7(slot13, nil, slot11, (uv8 == 3 or uv8 == 1) and &quot;  -- &quot; or uv9 &lt; 0 and &quot;  -&gt; &quot; or &quot;  &lt;- &quot;)
		end
	end
end

slot27 = function(slot0, slot1)
	slot2 = {}
	slot3 = 0

	for slot7, slot8 in uv0(slot0) do
		slot3 = uv2.max(slot3, slot8)

		if uv3 &lt;= uv1(slot8 * 100 / slot1 + 0.5) then
			slot10, slot11 = slot7:match(&quot;^(.*):(%d+)$&quot;)

			if not slot10 then
				slot10 = slot7
				slot11 = 0
			end

			if not slot2[slot10] then
				slot2[slot10] = {}
				slot2[#slot2 + 1] = slot10
			end

			slot12[uv4(slot11)] = uv5 and slot8 or slot9
		end
	end

	uv6(slot2)

	slot4 = &quot; %3d%% | %s\n&quot;
	slot5 = &quot;      | %s\n&quot;

	if uv5 then
		slot6 = uv2.max(5, uv2.ceil(uv2.log10(slot3)))
		slot4 = &quot;%&quot; .. slot6 .. &quot;d | %s\n&quot;
		slot5 = (&quot; &quot;):rep(slot6) .. &quot; | %s\n&quot;
	end

	slot6 = uv7

	for slot10, slot11 in uv8(slot2) do
		if slot11:byte() == 40 or slot12 == 91 then
			uv9:write(uv10([[

====== %s ======
[Cannot annotate non-file]
]], slot11))

			break
		end

		slot13, slot14 = io.open(slot11)

		if not slot13 then
			uv9:write(uv10(&quot;====== ERROR: %s: %s\n&quot;, slot11, slot14))

			break
		end

		uv9:write(uv10(&quot;\n====== %s ======\n&quot;, slot11))

		slot15 = slot2[slot11]
		slot16 = 1
		slot17 = false

		if slot6 ~= 0 then
			for slot21 = 1, slot6 do
				if slot15[slot21] then
					slot17 = true

					uv9:write(&quot;@@ 1 @@\n&quot;)

					break
				end
			end
		end

		for slot21 in slot13:lines() do
			if slot21:byte() == 27 then
				uv9:write(&quot;[Cannot annotate bytecode file]\n&quot;)

				break
			end

			slot22 = slot15[slot16]

			if slot6 ~= 0 then
				slot23 = slot15[slot16 + slot6]

				if slot17 then
					if slot23 then
						slot17 = slot16 + slot6
					elseif slot22 then
						slot17 = slot16
					elseif slot16 &gt; slot17 + slot6 then
						slot17 = false
					end
				elseif slot23 then
					slot17 = slot16 + slot6

					uv9:write(uv10(&quot;@@ %d @@\n&quot;, slot16))
				end

				if not slot17 then
					-- Nothing
				end
			elseif slot22 then
				uv9:write(uv10(slot4, slot22, slot21))
			else
				uv9:write(uv10(slot5, slot21))
			end

			slot16 = slot16 + 1
		end

		slot13:close()
	end
end

slot29 = function(slot0)
	slot1 = &quot;&quot;
	uv0 = 3
	uv2 = 1
	slot2 = {}

	for slot6 in slot0:gsub(&quot;i%d*&quot;, function (slot0)
		uv0 = slot0

		return &quot;&quot;
	end):gsub(&quot;m(%d+)&quot;, function (slot0)
		uv0 = uv1(slot0)

		return &quot;&quot;
	end):gsub(&quot;%-?%d+&quot;, function (slot0)
		uv0 = uv1(slot0)

		return &quot;&quot;
	end):gmatch(&quot;.&quot;) do
		slot2[slot6] = slot6
	end

	uv3 = slot2.z or slot2.v

	if uv3 == &quot;z&quot; then
		uv4 = require(&quot;jit.zone&quot;)
	end

	slot3 = slot2.l or slot2.f or slot2.F or uv3 and &quot;&quot; or &quot;f&quot;
	slot4 = slot2.p or &quot;&quot;
	uv5 = slot2.r

	if slot2.s then
		uv6 = 2

		if uv2 == -1 or slot2[&quot;-&quot;] then
			uv2 = -2
		elseif uv2 == 1 then
			uv2 = 2
		end
	elseif slot0:find(&quot;[fF].*l&quot;) then
		slot3 = &quot;l&quot;
		uv6 = 3
	else
		slot5 = (slot3 == &quot;&quot; or slot0:find(&quot;[zv].*[lfF]&quot;)) and 1 or 0
		uv6 = slot5
	end

	uv7 = slot2.A and 0 or slot2.a and 3

	if uv7 then
		slot3 = &quot;l&quot;
		uv8 = &quot;pl&quot;
		uv6 = 0
		uv2 = 1
	elseif slot2.G and slot3 ~= &quot;&quot; then
		uv8 = slot4 .. slot3 .. &quot;Z;&quot;
		uv2 = -100
		uv5 = true
		uv0 = 0
	elseif slot3 == &quot;&quot; then
		uv8 = false
	else
		slot5 = uv6 == 3 and slot2.f or slot2.F or slot3
		uv8 = slot4 .. slot5 .. (uv2 &gt;= 0 and &quot;Z &lt; &quot; or &quot;Z &gt; &quot;)
	end

	uv9 = {}
	uv10 = {}
	uv11 = 0

	uv12.start(slot3:lower() .. slot1, uv13)

	uv14 = newproxy(true)
	getmetatable(uv14).__gc = uv15
end

return {
	start = function (slot0, slot1)
		if slot1 or os.getenv(&quot;LUAJIT_PROFILEFILE&quot;) then
			uv0 = slot1 == &quot;-&quot; and uv1 or assert(io.open(slot1, &quot;w&quot;))
		else
			uv0 = uv1
		end

		uv2(slot0 or &quot;f&quot;)
	end,
	stop = function ()
		if uv0 then
			uv1.stop()

			if uv2 == 0 then
				if uv3 ~= true then
					uv4:write(&quot;[No samples collected]\n&quot;)
				end

				return
			end

			if uv5 then
				uv6(uv7, slot0)
			else
				uv8(uv7, uv9, slot0, &quot;&quot;)
			end

			uv7 = nil
			uv9 = nil
			uv0 = nil
		end
	end
}
</code></pre>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-lua.min.js"></script>
</body>
</html>